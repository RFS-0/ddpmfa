(function(t){var e=function(t){return{width:t.width(),height:t.height()}};var n=function(t,e){return{x:t,y:e}};var i=function(t,e){return t.x==e.x&&t.y==e.y};t.fn.pan=function(a){var r=this;var s=this.children(":first");var o=n(Number(s.css("left").replace("px",""))|0,Number(s.css("top").replace("px",""))|0);var l=e(r);var u=e(s);var c=n(-u.width+l.width,-u.height+l.height);var h=n(0,0);var f=.25*Math.min(l.width,l.height);var d=t.extend({autoSpeedX:0,autoSpeedY:0,mouseControl:"kinetic",kineticDamping:.8,mouseEdgeSpeed:5,mouseEdgeWidth:f,proportionalSmoothing:.5,updateInterval:50,mousePan:null},a);var p=false;var _=n(0,0);var v=n(0,0);var g=false;var m=null;var b=n(0,0);var y=d.updateInterval;var P=function(){var t={edge:x,proportional:j,kinetic:C};var e=d.mouseControl;if(!t[e]()){o.x+=d.autoSpeedX;o.y+=d.autoSpeedY}E();if(o.x==c.x)d.autoSpeedX=Math.abs(d.autoSpeedX);if(o.x==h.x)d.autoSpeedX=-Math.abs(d.autoSpeedX);if(o.y==c.y)d.autoSpeedY=Math.abs(d.autoSpeedY);if(o.y==h.y)d.autoSpeedY=-Math.abs(d.autoSpeedY);s.css("left",o.x+"px");s.css("top",o.y+"px")};var x=function(){if(!p)return false;if(typeof d["beforeEdgeMove"]=="function"){var t=d.beforeEdgeMove.apply(r,[g])!==false;if(!t){return false}}var e=n(0,0);if(v.x<d.mouseEdgeWidth){o.x+=d.mouseEdgeSpeed;e.x=-1}if(v.x>l.width-d.mouseEdgeWidth){o.x-=d.mouseEdgeSpeed;e.x=1}if(v.y<d.mouseEdgeWidth){o.y+=d.mouseEdgeSpeed;e.y=-1}if(v.y>l.height-d.mouseEdgeWidth){o.y-=d.mouseEdgeSpeed;e.y=1}w(e);return true};var j=function(){if(!p)return false;var t=v.x/l.width;var e=v.y/l.height;targetOffset=n((c.x-h.x)*t+h.x,(c.y-h.y)*e+h.y);var i=1-d.proportionalSmoothing;o=n((targetOffset.x-o.x)*i+o.x,(targetOffset.y-o.y)*i+o.y);return true};var C=function(){if(g){if(m==null){m=n(v.x,v.y)}b=n(v.x-m.x,v.y-m.y);m=n(v.x,v.y)}o.x+=b.x;o.y+=b.y;b=n(b.x*d.kineticDamping,b.y*d.kineticDamping);var t=Math.pow(b.x,2)+Math.pow(b.y,2);return t>.01};var E=function(){if(o.x<c.x)o.x=c.x;if(o.x>h.x)o.x=h.x;if(o.y<c.y)o.y=c.y;if(o.y>h.y)o.y=h.y};var w=function(t){if(!i(t,_)){_=t;if(d.mousePan){d.mousePan(_)}}};this.bind("mousemove",function(t){v.x=t.pageX-r.offset().left;v.y=t.pageY-r.offset().top;p=true});this.bind("mouseleave",function(t){p=false;g=false;m=null;w(n(0,0))});this.bind("mousedown",function(t){g=true;return false});this.bind("mouseup",function(t){g=false;m=null});setInterval(P,y);return this}})(jQuery);(function(t,e){if(typeof define==="function"&&define.amd){define(["jquery"],function(n){return e(t,n)})}else if(typeof exports==="object"){e(t,require("jquery"))}else{e(t,t.jQuery)}})(typeof window!=="undefined"?window:this,function(t,e){"use strict";var n=t.document;var i="__pz__";var a=Array.prototype.slice;var r=/trident\/7./i;var s=function(){if(r.test(navigator.userAgent)){return false}var t=n.createElement("input");t.setAttribute("oninput","return");return typeof t.oninput==="function"}();var o=/([A-Z])/g;var l=/^http:[\w\.\/]+svg$/;var u="(\\-?\\d[\\d\\.e-]*)";var c="\\,?\\s*";var h=new RegExp("^matrix\\("+u+c+u+c+u+c+u+c+u+c+u+"\\)$");function f(t,e){var n=t.length;while(--n){if(Math.round(+t[n])!==Math.round(+e[n])){return false}}return true}function d(t){var n={range:true,animate:true};if(typeof t==="boolean"){n.animate=t}else{e.extend(n,t)}return n}function p(t,n,i,a,r,s,o,l,u){if(e.type(t)==="array"){this.elements=[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]}else{this.elements=[t,n,i,a,r,s,o||0,l||0,u||1]}}p.prototype={x:function(t){var e=t instanceof _;var n=this.elements,i=t.elements;if(e&&i.length===3){return new _(n[0]*i[0]+n[1]*i[1]+n[2]*i[2],n[3]*i[0]+n[4]*i[1]+n[5]*i[2],n[6]*i[0]+n[7]*i[1]+n[8]*i[2])}else if(i.length===n.length){return new p(n[0]*i[0]+n[1]*i[3]+n[2]*i[6],n[0]*i[1]+n[1]*i[4]+n[2]*i[7],n[0]*i[2]+n[1]*i[5]+n[2]*i[8],n[3]*i[0]+n[4]*i[3]+n[5]*i[6],n[3]*i[1]+n[4]*i[4]+n[5]*i[7],n[3]*i[2]+n[4]*i[5]+n[5]*i[8],n[6]*i[0]+n[7]*i[3]+n[8]*i[6],n[6]*i[1]+n[7]*i[4]+n[8]*i[7],n[6]*i[2]+n[7]*i[5]+n[8]*i[8])}return false},inverse:function(){var t=1/this.determinant(),e=this.elements;return new p(t*(e[8]*e[4]-e[7]*e[5]),t*-(e[8]*e[1]-e[7]*e[2]),t*(e[5]*e[1]-e[4]*e[2]),t*-(e[8]*e[3]-e[6]*e[5]),t*(e[8]*e[0]-e[6]*e[2]),t*-(e[5]*e[0]-e[3]*e[2]),t*(e[7]*e[3]-e[6]*e[4]),t*-(e[7]*e[0]-e[6]*e[1]),t*(e[4]*e[0]-e[3]*e[1]))},determinant:function(){var t=this.elements;return t[0]*(t[8]*t[4]-t[7]*t[5])-t[3]*(t[8]*t[1]-t[7]*t[2])+t[6]*(t[5]*t[1]-t[4]*t[2])}};function _(t,e,n){this.elements=[t,e,n]}_.prototype.e=p.prototype.e=function(t){return this.elements[t]};function v(t,a){if(!(this instanceof v)){return new v(t,a)}if(t.nodeType!==1){e.error("Panzoom called on non-Element node")}if(!e.contains(n,t)){e.error("Panzoom element must be attached to the document")}var r=e.data(t,i);if(r){return r}this.options=a=e.extend({},v.defaults,a);this.elem=t;var s=this.$elem=e(t);this.$set=a.$set&&a.$set.length?a.$set:s;this.$doc=e(t.ownerDocument||n);this.$parent=s.parent();this.parent=this.$parent[0];this.isSVG=l.test(t.namespaceURI)&&t.nodeName.toLowerCase()!=="svg";this.panning=false;this._buildTransform();this._transform=e.cssProps.transform.replace(o,"-$1").toLowerCase();this._buildTransition();this.resetDimensions();var u=e();var c=this;e.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,e){c[e]=a[e]||u});this.enable();this.scale=this.getMatrix()[0];this._checkPanWhenZoomed();e.data(t,i,this)}v.rmatrix=h;v.defaults={eventNamespace:".panzoom",transition:true,cursor:"move",disablePan:false,disableZoom:false,disableXAxis:false,disableYAxis:false,which:1,increment:.3,linearZoom:false,panOnlyWhenZoomed:false,minScale:.3,maxScale:6,rangeStep:.05,duration:200,easing:"ease-in-out",contain:false};v.prototype={constructor:v,instance:function(){return this},enable:function(){this._initStyle();this._bind();this.disabled=false},disable:function(){this.disabled=true;this._resetStyle();this._unbind()},isDisabled:function(){return this.disabled},destroy:function(){this.disable();e.removeData(this.elem,i)},resetDimensions:function(){this.container=this.parent.getBoundingClientRect();var t=this.elem;var n=t.getBoundingClientRect();var i=Math.abs(this.scale);this.dimensions={width:n.width,height:n.height,left:e.css(t,"left",true)||0,top:e.css(t,"top",true)||0,border:{top:e.css(t,"borderTopWidth",true)*i||0,bottom:e.css(t,"borderBottomWidth",true)*i||0,left:e.css(t,"borderLeftWidth",true)*i||0,right:e.css(t,"borderRightWidth",true)*i||0},margin:{top:e.css(t,"marginTop",true)*i||0,left:e.css(t,"marginLeft",true)*i||0}}},reset:function(t){t=d(t);var e=this.setMatrix(this._origTransform,t);if(!t.silent){this._trigger("reset",e)}},resetZoom:function(t){t=d(t);var e=this.getMatrix(this._origTransform);t.dValue=e[3];this.zoom(e[0],t)},resetPan:function(t){var e=this.getMatrix(this._origTransform);this.pan(e[4],e[5],d(t))},setTransform:function(t){var n=this.$set;var i=n.length;while(i--){e.style(n[i],"transform",t);if(this.isSVG){n[i].setAttribute("transform",t)}}},getTransform:function(t){var n=this.$set;var i=n[0];if(t){this.setTransform(t)}else{t=e.style(i,"transform");if(this.isSVG&&(!t||t==="none")){t=e.attr(i,"transform")||"none"}}if(t!=="none"&&!h.test(t)){this.setTransform(t=e.css(i,"transform"))}return t||"none"},getMatrix:function(t){var e=h.exec(t||this.getTransform());if(e){e.shift()}return e||[1,0,0,1,0,0]},getScale:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},setMatrix:function(t,n){if(this.disabled){return}if(!n){n={}}if(typeof t==="string"){t=this.getMatrix(t)}var i=this.getScale(t);var a=typeof n.contain!=="undefined"?n.contain:this.options.contain;if(a){var r=n.dims;if(!r){this.resetDimensions();r=this.dimensions}var s,o,l;var u=this.container;var c=r.width;var h=r.height;var f=u.width;var d=u.height;var p=f/c;var _=d/h;if(this.$parent.css("textAlign")!=="center"||e.css(this.elem,"display")!=="inline"){l=(c-this.elem.offsetWidth)/2;s=l-r.border.left;o=c-f-l+r.border.right}else{s=o=(c-f)/2}var v=(h-d)/2+r.border.top;var g=(h-d)/2-r.border.top-r.border.bottom;if(a==="invert"||a==="automatic"&&p<1.01){t[4]=Math.max(Math.min(t[4],s-r.border.left),-o)}else{t[4]=Math.min(Math.max(t[4],s),-o)}if(a==="invert"||a==="automatic"&&_<1.01){t[5]=Math.max(Math.min(t[5],v-r.border.top),-g)}else{t[5]=Math.min(Math.max(t[5],v),-g)}}if(n.animate!=="skip"){this.transition(!n.animate)}if(n.range){this.$zoomRange.val(i)}if(this.options.disableXAxis||this.options.disableYAxis){var m=this.getMatrix();if(this.options.disableXAxis){t[4]=m[4]}if(this.options.disableYAxis){t[5]=m[5]}}this.setTransform("matrix("+t.join(",")+")");this.scale=i;this._checkPanWhenZoomed(i);if(!n.silent){this._trigger("change",t)}return t},isPanning:function(){return this.panning},transition:function(t){if(!this._transition){return}var n=t||!this.options.transition?"none":this._transition;var i=this.$set;var a=i.length;while(a--){if(e.style(i[a],"transition")!==n){e.style(i[a],"transition",n)}}},pan:function(t,e,n){if(this.options.disablePan){return}if(!n){n={}}var i=n.matrix;if(!i){i=this.getMatrix()}if(n.relative){t+=+i[4];e+=+i[5]}i[4]=t;i[5]=e;this.setMatrix(i,n);if(!n.silent){this._trigger("pan",i[4],i[5])}},zoom:function(t,n){if(typeof t==="object"){n=t;t=null}else if(!n){n={}}var i=e.extend({},this.options,n);if(i.disableZoom){return}var a=false;var r=i.matrix||this.getMatrix();var s=new p(r);var o=this.getScale(r);if(typeof t!=="number"){if(i.linearZoom){t=1+i.increment*(t?-1:1)/o}else{t=t?1/(1+i.increment):1+i.increment}a=true}else{t=1/o}t=Math.max(Math.min(t,i.maxScale/o),i.minScale/o);var l=s.x(new p(t,0,0,0,typeof i.dValue==="number"?i.dValue/o:t,0));var u=i.focal;if(u&&!i.disablePan){this.resetDimensions();var c=i.dims=this.dimensions;var h=u.clientX;var f=u.clientY;if(!this.isSVG){h-=c.width/o/2;f-=c.height/o/2}var d=new _(h,f,1);var v=this.parentOffset||this.$parent.offset();var g=new p(1,0,v.left-this.$doc.scrollLeft(),0,1,v.top-this.$doc.scrollTop());var m=s.inverse().x(g.inverse().x(d));s=s.x(new p([t,0,0,t,0,0]));d=g.x(s.x(m));r[4]=+r[4]+(h-d.e(0));r[5]=+r[5]+(f-d.e(1))}r[0]=l.e(0);r[1]=l.e(3);r[2]=l.e(1);r[3]=l.e(4);this.setMatrix(r,{animate:typeof i.animate!=="undefined"?i.animate:a,range:!i.noSetRange});if(!i.silent){this._trigger("zoom",t,i)}},option:function(t,n){var i;if(!t){return e.extend({},this.options)}if(typeof t==="string"){if(arguments.length===1){return this.options[t]!==undefined?this.options[t]:null}i={};i[t]=n}else{i=t}this._setOptions(i)},_setOptions:function(t){e.each(t,e.proxy(function(t,n){switch(t){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind()}this.options[t]=n;switch(t){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[t]=n;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();break;case"cursor":e.style(this.elem,"cursor",n);break;case"minScale":this.$zoomRange.attr("min",n);break;case"maxScale":this.$zoomRange.attr("max",n);break;case"rangeStep":this.$zoomRange.attr("step",n);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();case"transition":this.transition();break;case"panOnlyWhenZoomed":this._checkPanWhenZoomed();break;case"$set":if(n instanceof e&&n.length){this.$set=n;this._initStyle();this._buildTransform()}}},this))},_checkPanWhenZoomed:function(t){var e=this.options;if(e.panOnlyWhenZoomed){if(!t){t=this.getMatrix()[0]}var n=t<=e.minScale;if(e.disablePan!==n){this.option("disablePan",n)}}},_initStyle:function(){var t={"transform-origin":this.isSVG?"0 0":"50% 50%"};if(!this.options.disablePan){t.cursor=this.options.cursor}this.$set.css(t);var n=this.$parent;if(n.length&&!e.nodeName(this.parent,"body")){t={overflow:"hidden"};if(n.css("position")==="static"){t.position="relative"}n.css(t)}},_resetStyle:function(){this.$elem.css({cursor:"",transition:""});this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this;var n=this.options;var i=n.eventNamespace;var a="mousedown"+i+" pointerdown"+i+" MSPointerDown"+i;var r="touchstart"+i+" "+a;var o="touchend"+i+" click"+i+" pointerup"+i+" MSPointerUp"+i;var l={};var u=this.$reset;var c=this.$zoomRange;e.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=n["on"+this];if(e.isFunction(t)){l["panzoom"+this.toLowerCase()+i]=t}});if(!n.disablePan||!n.disableZoom){l[r]=function(e){if(!jQuery(e.target).hasClass("rgm-modes-drawing-container"))return;var i;if(e.type==="touchstart"?(i=e.touches||e.originalEvent.touches)&&(i.length===1&&!n.disablePan||i.length===2):!n.disablePan&&(e.which||e.originalEvent.which)===n.which){e.preventDefault();e.stopPropagation();t._startMove(e,i)}};if(n.which===3){l.contextmenu=false}}this.$elem.on(l);if(u.length){u.on(o,function(e){e.preventDefault();t.reset()})}if(c.length){c.attr({step:n.rangeStep===v.defaults.rangeStep&&c.attr("step")||n.rangeStep,min:n.minScale,max:n.maxScale}).prop({value:this.getMatrix()[0]})}if(n.disableZoom){return}var h=this.$zoomIn;var f=this.$zoomOut;if(h.length&&f.length){h.on("click",function(e){e.preventDefault();t.zoom()});f.on("click",function(e){e.preventDefault();t.zoom(true)})}if(c.length){l={};l[a]=function(){t.transition(true)};l[(s?"input":"change")+i]=function(){t.zoom(+this.value,{noSetRange:true})};c.on(l)}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){if(this._transform){var t=this.options;this._transition=this._transform+" "+t.duration+"ms "+t.easing}},_getDistance:function(t){var e=t[0];var n=t[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-e.clientX),2)+Math.pow(Math.abs(n.clientY-e.clientY),2))},_getMiddle:function(t){var e=t[0];var n=t[1];return{clientX:(n.clientX-e.clientX)/2+e.clientX,clientY:(n.clientY-e.clientY)/2+e.clientY}},_trigger:function(t){if(typeof t==="string"){t="panzoom"+t}this.$elem.triggerHandler(t,[this].concat(a.call(arguments,1)))},_startMove:function(t,i){if(this.panning){return}var a,r,s,o,l,u,c,h;var d=this;var p=this.options;var _=p.eventNamespace;var v=this.getMatrix();var g=v.slice(0);var m=+g[4];var b=+g[5];var y={matrix:v,animate:"skip"};var P=t.type;if(P==="pointerdown"){a="pointermove";r="pointerup"}else if(P==="touchstart"){a="touchmove";r="touchend"}else if(P==="MSPointerDown"){a="MSPointerMove";r="MSPointerUp"}else{a="mousemove";r="mouseup"}a+=_;r+=_;this.transition(true);this.panning=true;this._trigger("start",t,i);var x=function(t,e){if(!jQuery(t.target).hasClass("rgm-modes-drawing-container"))return;if(e){if(e.length===2){if(s!=null){return}s=d._getDistance(e);o=d.getScale(v);l=d._getMiddle(e);return}if(u!=null){return}if(h=e[0]){u=h.pageX;c=h.pageY}}if(u!=null){return}u=t.pageX;c=t.pageY};x(t,i);var j=function(e){if(!jQuery(t.target).hasClass("rgm-modes-drawing-container"))return;var n;e.preventDefault();i=e.touches||e.originalEvent.touches;x(e,i);if(i){if(i.length===2){var a=d._getMiddle(i);var r=d._getDistance(i)-s;d.zoom(r*(p.increment/100)+o,{focal:a,matrix:v,animate:"skip"});d.pan(+v[4]+a.clientX-l.clientX,+v[5]+a.clientY-l.clientY,y);l=a;return}n=i[0]||{pageX:0,pageY:0}}if(!n){n=e}d.pan(m+n.pageX-u,b+n.pageY-c,y)};e(n).off(_).on(a,j).on(r,function(t){t.preventDefault();e(this).off(_);d.panning=false;t.type="panzoomend";d._trigger(t,v,!f(v,g))})}};e.Panzoom=v;e.fn.panzoom=function(t){var n,r,s,o;if(typeof t==="string"){o=[];r=a.call(arguments,1);this.each(function(){n=e.data(this,i);if(!n){o.push(undefined)}else if(t.charAt(0)!=="_"&&typeof(s=n[t])==="function"&&(s=s.apply(n,r))!==undefined){o.push(s)}});return o.length?o.length===1?o[0]:o:this}return this.each(function(){new v(this,t)})};return v});(function(){var t=this;if(typeof Math.sgn=="undefined"){Math.sgn=function(t){return t==0?0:t>0?1:-1}}var e={subtract:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},dotProduct:function(t,e){return t.x*e.x+t.y*e.y},square:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},scale:function(t,e){return{x:t.x*e,y:t.y*e}}},n=64,i=Math.pow(2,-n-1);var a=function(t,n){var i=[],a=s(t,n),r=n.length-1,l=2*r-1,u=o(a,l,i,0),c=e.subtract(t,n[0]),f=e.square(c),d=0;for(var p=0;p<u;p++){c=e.subtract(t,h(n,r,i[p],null,null));var _=e.square(c);if(_<f){f=_;d=i[p]}}c=e.subtract(t,n[r]);_=e.square(c);if(_<f){f=_;d=1}return{location:d,distance:f}};var r=function(t,e){var n=a(t,e);return{point:h(e,e.length-1,n.location,null,null),location:n.location}};var s=function(t,n){var i=n.length-1,a=2*i-1,r=[],s=[],o=[],l=[],u=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var c=0;c<=i;c++)r[c]=e.subtract(n[c],t);for(var c=0;c<=i-1;c++){s[c]=e.subtract(n[c+1],n[c]);s[c]=e.scale(s[c],3)}for(var h=0;h<=i-1;h++){for(var f=0;f<=i;f++){if(!o[h])o[h]=[];o[h][f]=e.dotProduct(s[h],r[f])}}for(c=0;c<=a;c++){if(!l[c])l[c]=[];l[c].y=0;l[c].x=parseFloat(c)/a}var d=i,p=i-1;for(var _=0;_<=d+p;_++){var v=Math.max(0,_-p),g=Math.min(_,d);for(c=v;c<=g;c++){j=_-c;l[c+j].y+=o[j][c]*u[j][c]}}return l};var o=function(t,e,i,a){var r=[],s=[],f,d,p=[],_=[];switch(l(t,e)){case 0:{return 0}case 1:{if(a>=n){i[0]=(t[0].x+t[e].x)/2;return 1}if(u(t,e)){i[0]=c(t,e);return 1}break}}h(t,e,.5,r,s);f=o(r,e,p,a+1);d=o(s,e,_,a+1);for(var v=0;v<f;v++)i[v]=p[v];for(var v=0;v<d;v++)i[v+f]=_[v];return f+d};var l=function(t,e){var n=0,i,a;i=a=Math.sgn(t[0].y);for(var r=1;r<=e;r++){i=Math.sgn(t[r].y);if(i!=a)n++;a=i}return n};var u=function(t,e){var n,a,r,s,o,l,u,c,h,f,d,p,_,v,g,m;l=t[0].y-t[e].y;u=t[e].x-t[0].x;c=t[0].x*t[e].y-t[e].x*t[0].y;var b=max_distance_below=0;for(var y=1;y<e;y++){var P=l*t[y].x+u*t[y].y+c;if(P>b)b=P;else if(P<max_distance_below)max_distance_below=P}d=0;p=1;_=0;v=l;g=u;m=c-b;h=d*g-v*p;f=1/h;a=(p*m-g*_)*f;v=l;g=u;m=c-max_distance_below;h=d*g-v*p;f=1/h;r=(p*m-g*_)*f;s=Math.min(a,r);o=Math.max(a,r);n=o-s;return n<i?1:0};var c=function(t,e){var n=1,i=0,a=t[e].x-t[0].x,r=t[e].y-t[0].y,s=t[0].x-0,o=t[0].y-0,l=a*i-r*n,u=1/l,c=(a*o-r*s)*u;return 0+n*c};var h=function(t,e,n,i,a){var r=[[]];for(var s=0;s<=e;s++)r[0][s]=t[s];for(var o=1;o<=e;o++){for(var s=0;s<=e-o;s++){if(!r[o])r[o]=[];if(!r[o][s])r[o][s]={};r[o][s].x=(1-n)*r[o-1][s].x+n*r[o-1][s+1].x;r[o][s].y=(1-n)*r[o-1][s].y+n*r[o-1][s+1].y}}if(i!=null)for(s=0;s<=e;s++)i[s]=r[s][0];if(a!=null)for(s=0;s<=e;s++)a[s]=r[e-s][s];return r[e][0]};var f={};var d=function(t){var e=f[t];if(!e){e=[];var n=function(){return function(e){return Math.pow(e,t)}},i=function(){return function(e){return Math.pow(1-e,t)}},a=function(t){return function(e){return t}},r=function(){return function(t){return t}},s=function(){return function(t){return 1-t}},o=function(t){return function(e){var n=1;for(var i=0;i<t.length;i++)n=n*t[i](e);return n}};e.push(new n);for(var l=1;l<t;l++){var u=[new a(t)];for(var c=0;c<t-l;c++)u.push(new r);for(var c=0;c<l;c++)u.push(new s);e.push(new o(u))}e.push(new i);f[t]=e}return e};var p=function(t,e){var n=d(t.length-1),i=0,a=0;for(var r=0;r<t.length;r++){i=i+t[r].x*n[r](e);a=a+t[r].y*n[r](e)}return{x:i,y:a}};var _=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))};var v=function(t){return t[0].x==t[1].x&&t[0].y==t[1].y};var g=function(t,e,n){if(v(t)){return{point:t[0],location:e}}var i=p(t,e),a=0,r=e,s=n>0?1:-1,o=null;while(a<Math.abs(n)){r+=.005*s;o=p(t,r);a+=_(o,i);i=o}return{point:o,location:r}};var m=function(t){if(v(t))return 0;var e=p(t,0),n=0,i=0,a=1,r=null;while(i<1){i+=.005*a;r=p(t,i);n+=_(r,e);e=r}return n};var b=function(t,e,n){return g(t,e,n).point};var y=function(t,e,n){return g(t,e,n).location};var P=function(t,e){var n=p(t,e),i=p(t.slice(0,t.length-1),e),a=i.y-n.y,r=i.x-n.x;return a==0?Infinity:Math.atan(a/r)};var x=function(t,e,n){var i=g(t,e,n);if(i.location>1)i.location=1;if(i.location<0)i.location=0;return P(t,i.location)};var C=function(t,e,n,i){i=i==null?0:i;var a=g(t,e,i),r=P(t,a.location),s=Math.atan(-1/r),o=n/2*Math.sin(s),l=n/2*Math.cos(s);return[{x:a.point.x+l,y:a.point.y+o},{x:a.point.x-l,y:a.point.y-o}]};var E=this.jsBezier={distanceFromCurve:a,gradientAtPoint:P,gradientAtPointAlongCurveFrom:x,nearestPointOnCurve:r,pointOnCurve:p,pointAlongCurveFrom:b,perpendicularToCurveAt:C,locationAlongCurveFrom:y,getLength:m,version:"0.9.0"};if(typeof exports!=="undefined"){exports.jsBezier=E}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this;var e=t.Biltong={version:"0.4.0"};if(typeof exports!=="undefined"){exports.Biltong=e}var n=function(t){return Object.prototype.toString.call(t)==="[object Array]"},i=function(t,e,i){t=n(t)?t:[t.x,t.y];e=n(e)?e:[e.x,e.y];return i(t,e)},a=e.gradient=function(t,e){return i(t,e,function(t,e){if(e[0]==t[0])return e[1]>t[1]?Infinity:-Infinity;else if(e[1]==t[1])return e[0]>t[0]?0:-0;else return(e[1]-t[1])/(e[0]-t[0])})},r=e.normal=function(t,e){return-1/a(t,e)},s=e.lineLength=function(t,e){return i(t,e,function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))})},o=e.quadrant=function(t,e){return i(t,e,function(t,e){if(e[0]>t[0]){return e[1]>t[1]?2:1}else if(e[0]==t[0]){return e[1]>t[1]?2:1}else{return e[1]>t[1]?3:4}})},l=e.theta=function(t,e){return i(t,e,function(t,e){var n=a(t,e),i=Math.atan(n),r=o(t,e);if(r==4||r==3)i+=Math.PI;if(i<0)i+=2*Math.PI;return i})},u=e.intersects=function(t,e){var n=t.x,i=t.x+t.w,a=t.y,r=t.y+t.h,s=e.x,o=e.x+e.w,l=e.y,u=e.y+e.h;return n<=s&&s<=i&&(a<=l&&l<=r)||n<=o&&o<=i&&(a<=l&&l<=r)||n<=s&&s<=i&&(a<=u&&u<=r)||n<=o&&s<=i&&(a<=u&&u<=r)||s<=n&&n<=o&&(l<=a&&a<=u)||s<=i&&i<=o&&(l<=a&&a<=u)||s<=n&&n<=o&&(l<=r&&r<=u)||s<=i&&n<=o&&(l<=r&&r<=u)},c=e.encloses=function(t,e,n){var i=t.x,a=t.x+t.w,r=t.y,s=t.y+t.h,o=e.x,l=e.x+e.w,u=e.y,c=e.y+e.h,h=function(t,e,i,a){return n?t<=e&&i>=a:t<e&&i>a};return h(i,o,a,l)&&h(r,u,s,c)},h=[null,[1,-1],[1,1],[-1,1],[-1,-1]],f=[null,[-1,-1],[-1,1],[1,1],[1,-1]],d=e.pointOnLine=function(t,e,n){var i=a(t,e),r=o(t,e),s=n>0?h[r]:f[r],l=Math.atan(i),u=Math.abs(n*Math.sin(l))*s[1],c=Math.abs(n*Math.cos(l))*s[0];return{x:t.x+c,y:t.y+u}},p=e.perpendicularLineTo=function(t,e,n){var i=a(t,e),r=Math.atan(-1/i),s=n/2*Math.sin(r),o=n/2*Math.cos(r);return[{x:e.x+o,y:e.y+s},{x:e.x-o,y:e.y-s}]}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},n=function(t,e,n){n=n||t.parentNode;var i=n.querySelectorAll(e);for(var a=0;a<i.length;a++){if(i[a]===t){return true}}return false},i=function(t){return typeof t=="string"||t.constructor===String?document.getElementById(t):t},a=function(t){return t.srcElement||t.target},r=function(t,e,n,i){if(!i)return{path:[e],end:1};else if(typeof t.path!=="undefined"&&t.path.indexOf){return{path:t.path,end:t.path.indexOf(n)}}else{var a={path:[],end:-1},r=function(t){a.path.push(t);if(t===n){a.end=a.path.length-1}else if(t.parentNode!=null){r(t.parentNode)}};r(e);return a}},s=function(t,e){for(var n=0,i=t.length;n<i;n++){if(t[n]==e)break}if(n<t.length)t.splice(n,1)},o=1,l=function(t,e,n){var i=o++;t.__ta=t.__ta||{};t.__ta[e]=t.__ta[e]||{};t.__ta[e][i]=n;n.__tauid=i;return i},u=function(t,e,n){t.__ta&&t.__ta[e]&&delete t.__ta[e][n.__tauid];if(n.__taExtra){for(var i=0;i<n.__taExtra.length;i++){O(t,n.__taExtra[i][0],n.__taExtra[i][1])}n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()},c=function(t,e,i,s){if(t==null)return i;else{var o=t.split(","),l=function(s){l.__tauid=i.__tauid;var u=a(s),c=u;var h=r(s,u,e,t!=null);if(h.end!=-1){for(var f=0;f<h.end;f++){c=h.path[f];for(var d=0;d<o.length;d++){if(n(c,o[d],e)){i.apply(c,arguments)}}}}};h(i,s,l);return l}},h=function(t,e,n){t.__taExtra=t.__taExtra||[];t.__taExtra.push([e,n])},f=function(t,e,n,i){if(m&&y[e]){var a=c(i,t,n,y[e]);M(t,y[e],a,n)}if(e==="focus"&&t.getAttribute("tabindex")==null){t.setAttribute("tabindex","1")}M(t,e,c(i,t,n,e),n)},d=function(t,e,n,i){if(t.__taSmartClicks==null){var r=function(e){t.__tad=S(e)},o=function(e){t.__tau=S(e)},l=function(e){if(t.__tad&&t.__tau&&t.__tad[0]===t.__tau[0]&&t.__tad[1]===t.__tau[1]){for(var n=0;n<t.__taSmartClicks.length;n++)t.__taSmartClicks[n].apply(a(e),[e])}};f(t,"mousedown",r,i);f(t,"mouseup",o,i);f(t,"click",l,i);t.__taSmartClicks=[]}t.__taSmartClicks.push(n);n.__taUnstore=function(){s(t.__taSmartClicks,n)}},p={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},_=function(t,e){return function(i,o,l,u){if(o=="contextmenu"&&b)f(i,o,l,u);else{if(i.__taTapHandler==null){var c=i.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:false,taps:0,downSelectors:[]};var h=function(s){var o=a(s),l=r(s,o,i,u!=null),h=false;for(var f=0;f<l.end;f++){if(h)return;o=l.path[f];for(var d=0;d<c.downSelectors.length;d++){if(c.downSelectors[d]==null||n(o,c.downSelectors[d],i)){c.down=true;setTimeout(_,t);setTimeout(v,e);h=true;break}}}},d=function(t){if(c.down){var e=a(t),s,o;c.taps++;var l=k(t);for(var u in p){if(p.hasOwnProperty(u)){var h=p[u];if(h.touches===l&&(h.taps===1||h.taps===c.taps)){for(var f=0;f<c[u].length;f++){o=r(t,e,i,c[u][f][1]!=null);for(var d=0;d<o.end;d++){s=o.path[d];if(c[u][f][1]==null||n(s,c[u][f][1],i)){c[u][f][0].apply(s,[t]);break}}}}}}}},_=function(){c.down=false},v=function(){c.taps=0};f(i,"mousedown",h);f(i,"mouseup",d)}i.__taTapHandler.downSelectors.push(u);i.__taTapHandler[o].push([l,u]);l.__taUnstore=function(){s(i.__taTapHandler[o],l)}}}},v=function(t,e,n,i){for(var a in n.__tamee[t]){if(n.__tamee[t].hasOwnProperty(a)){n.__tamee[t][a].apply(i,[e])}}},g=function(){var t=[];return function(e,i,r,s){if(!e.__tamee){e.__tamee={over:false,mouseenter:[],mouseexit:[]};var o=function(i){var r=a(i);if(s==null&&(r==e&&!e.__tamee.over)||n(r,s,e)&&(r.__tamee==null||!r.__tamee.over)){v("mouseenter",i,e,r);r.__tamee=r.__tamee||{};r.__tamee.over=true;t.push(r)}},u=function(i){var r=a(i);for(var s=0;s<t.length;s++){if(r==t[s]&&!n(i.relatedTarget||i.toElement,"*",r)){r.__tamee.over=false;t.splice(s,1);v("mouseexit",i,e,r)}}};M(e,"mouseover",c(s,e,o,"mouseover"),o);M(e,"mouseout",c(s,e,u,"mouseout"),u)}r.__taUnstore=function(){delete e.__tamee[i][r.__tauid]};l(e,i,r);e.__tamee[i][r.__tauid]=r}},m="ontouchstart"in document.documentElement,b="onmousedown"in document.documentElement,y={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},P="touchstart",x="touchend",j="touchmove",C=function(){var t=-1;if(navigator.appName=="Microsoft Internet Explorer"){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(n.exec(e)!=null)t=parseFloat(RegExp.$1)}return t}(),E=C>-1&&C<9,w=function(t,e){if(t==null)return[0,0];var n=T(t),i=A(n,0);return[i[e+"X"],i[e+"Y"]]},S=function(t){if(t==null)return[0,0];if(E){return[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]}else{return w(t,"page")}},D=function(t){return w(t,"screen")},I=function(t){return w(t,"client")},A=function(t,e){return t.item?t.item(e):t[e]},T=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},k=function(t){return T(t).length},M=function(t,e,n,i){l(t,e,n);i.__tauid=n.__tauid;if(t.addEventListener)t.addEventListener(e,n,false);else if(t.attachEvent){var a=e+n.__tauid;t["e"+a]=n;t[a]=function(){t["e"+a]&&t["e"+a](window.event)};t.attachEvent("on"+e,t[a])}},O=function(t,e,n){if(n==null)return;V(t,function(){var a=i(this);u(a,e,n);if(n.__tauid!=null){if(a.removeEventListener){a.removeEventListener(e,n,false);if(m&&y[e])a.removeEventListener(y[e],n,false)}else if(this.detachEvent){var r=e+n.__tauid;a[r]&&a.detachEvent("on"+e,a[r]);a[r]=null;a["e"+r]=null}}if(n.__taTouchProxy){O(t,n.__taTouchProxy[1],n.__taTouchProxy[0])}})},V=function(t,e){if(t==null)return;t=typeof Window!=="undefined"&&(typeof t.top!=="unknown"&&t==t.top)?[t]:typeof t!=="string"&&(t.tagName==null&&t.length!=null)?t:typeof t==="string"?document.querySelectorAll(t):[t];for(var n=0;n<t.length;n++)e.apply(t[n])};t.Mottle=function(t){t=t||{};var n=t.clickThreshold||250,a=t.dblClickThreshold||450,r=new g,s=new _(n,a),o=t.smartClicks,l=function(t,e,n,a){if(n==null)return;V(t,function(){var t=i(this);if(o&&e==="click")d(t,e,n,a);else if(e==="tap"||e==="dbltap"||e==="contextmenu"){s(t,e,n,a)}else if(e==="mouseenter"||e=="mouseexit")r(t,e,n,a);else f(t,e,n,a)})};this.remove=function(t){V(t,function(){var t=i(this);if(t.__ta){for(var e in t.__ta){if(t.__ta.hasOwnProperty(e)){for(var n in t.__ta[e]){if(t.__ta[e].hasOwnProperty(n))O(t,e,t.__ta[e][n])}}}}t.parentNode&&t.parentNode.removeChild(t)});return this};this.on=function(t,e,n,i){var a=arguments[0],r=arguments.length==4?arguments[2]:null,s=arguments[1],o=arguments[arguments.length-1];l(a,s,o,r);return this};this.off=function(t,e,n){O(t,e,n);return this};this.trigger=function(t,n,a,r){var s=b&&(typeof MouseEvent==="undefined"||a==null||a.constructor===MouseEvent);var o=m&&!b&&y[n]?y[n]:n,l=!(m&&!b&&y[n]);var u=S(a),c=D(a),h=I(a);V(t,function(){var t=i(this),f;a=a||{screenX:c[0],screenY:c[1],clientX:h[0],clientY:h[1]};var d=function(t){if(r)t.payload=r};var p={TouchEvent:function(e){var n=document.createTouch(window,t,0,u[0],u[1],c[0],c[1],h[0],h[1],0,0,0,0);var i=document.createTouchList(n);var a=document.createTouchList(n);var r=document.createTouchList(n);e.initTouchEvent(o,true,true,window,null,c[0],c[1],h[0],h[1],false,false,false,false,i,a,r,1,0)},MouseEvents:function(n){n.initMouseEvent(o,true,true,window,0,c[0],c[1],h[0],h[1],false,false,false,false,1,t);if(e.android){var i=document.createTouch(window,t,0,u[0],u[1],c[0],c[1],h[0],h[1],0,0,0,0);n.touches=n.targetTouches=n.changedTouches=document.createTouchList(i)}}};if(document.createEvent){var _=!l&&!s&&(m&&y[n]&&!e.android),v=_?"TouchEvent":"MouseEvents";f=document.createEvent(v);p[v](f);d(f);t.dispatchEvent(f)}else if(document.createEventObject){f=document.createEventObject();f.eventType=f.eventName=o;f.screenX=c[0];f.screenY=c[1];f.clientX=h[0];f.clientY=h[1];d(f);t.fireEvent("on"+o,f)}});return this}};t.Mottle.consume=function(t,e){if(t.stopPropagation)t.stopPropagation();else t.returnValue=false;if(!e&&t.preventDefault)t.preventDefault()};t.Mottle.pageLocation=S;t.Mottle.setForceTouchEvents=function(t){m=t};t.Mottle.setForceMouseEvents=function(t){b=t};t.Mottle.version="0.8.0";if(typeof exports!=="undefined"){exports.Mottle=t.Mottle}}).call(typeof window==="undefined"?this:window);(function(){"use strict";var t=this;var e=function(t,e,n){if(t.indexOf(e)===-1){n?t.unshift(e):t.push(e);return true}return false};var n=function(t,e){var n=t.indexOf(e);if(n!=-1)t.splice(n,1)};var i=function(t,e){var n=[];for(var i=0;i<t.length;i++){if(e.indexOf(t[i])==-1)n.push(t[i])}return n};var a=function(t){return t==null?false:typeof t==="string"||t.constructor==String};var r=function(t){var e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,a=window.pageYOffset||i.scrollTop||n.scrollTop,r=window.pageXOffset||i.scrollLeft||n.scrollLeft,s=i.clientTop||n.clientTop||0,o=i.clientLeft||n.clientLeft||0,l=e.top+a-s,u=e.left+r-o;return{top:Math.round(l),left:Math.round(u)}};var s=function(t,e,n){n=n||t.parentNode;var i=n.querySelectorAll(e);for(var a=0;a<i.length;a++){if(i[a]===t)return true}return false};var o=function(){var t=-1;if(navigator.appName=="Microsoft Internet Explorer"){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(n.exec(e)!=null)t=parseFloat(RegExp.$1)}return t}(),l=50,u=50,c=o>-1&&o<9,h=o==9,f=function(t){if(c){return[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]}else{var e=p(t),n=d(e,0);return h?[n.pageX||n.clientX,n.pageY||n.clientY]:[n.pageX,n.pageY]}},d=function(t,e){return t.item?t.item(e):t[e]},p=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},_={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy"},v="katavorio-drag-scope",g=["stop","start","drag","drop","over","out","beforeStart"],m=function(){},b=function(){return true
},y=function(t,e,n){for(var i=0;i<t.length;i++){if(t[i]!=n)e(t[i])}},P=function(t,e,n,i){y(t,function(t){t.setActive(e);if(e)t.updatePosition();if(n)t.setHover(i,e)})},x=function(t,e){if(t==null)return;t=!a(t)&&(t.tagName==null&&t.length!=null)?t:[t];for(var n=0;n<t.length;n++)e.apply(t[n],[t[n]])},j=function(t){if(t.stopPropagation){t.stopPropagation();t.preventDefault()}else{t.returnValue=false}},C="input,textarea,select,button,option",E=function(t,e,n){var i=t.srcElement||t.target;return!s(i,n.getInputFilterSelector(),e)};var w=function(t,e,n,i){this.params=e||{};this.el=t;this.params.addClass(this.el,this._class);this.uuid=T();var a=true;this.setEnabled=function(t){a=t};this.isEnabled=function(){return a};this.toggleEnabled=function(){a=!a};this.setScope=function(t){this.scopes=t?t.split(/\s+/):[i]};this.addScope=function(t){var e={};x(this.scopes,function(t){e[t]=true});x(t?t.split(/\s+/):[],function(t){e[t]=true});this.scopes=[];for(var n in e)this.scopes.push(n)};this.removeScope=function(t){var e={};x(this.scopes,function(t){e[t]=true});x(t?t.split(/\s+/):[],function(t){delete e[t]});this.scopes=[];for(var n in e)this.scopes.push(n)};this.toggleScope=function(t){var e={};x(this.scopes,function(t){e[t]=true});x(t?t.split(/\s+/):[],function(t){if(e[t])delete e[t];else e[t]=true});this.scopes=[];for(var n in e)this.scopes.push(n)};this.setScope(e.scope);this.k=e.katavorio;return e.katavorio};var S=function(){return true};var D=function(){return false};var I=function(t,e,n,i){this._class=n.draggable;var o=w.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var c=[0,0],h=null,d=null,p=[0,0],v=false,g=this.params.consumeStartEvent!==false,m=this.el,y=this.params.clone,x=this.params.scroll,C=e.multipleDrop!==false,I=false,A=e.ghostProxy===true?S:e.ghostProxy&&typeof e.ghostProxy==="function"?e.ghostProxy:D,M=function(t){return t.cloneNode(true)};var O=jQuery(m).parents(".rgm-modes-drawing-container");var V=[O.position().left,O.position().top];var L=0;var N=e.snapThreshold||5,F=function(t,e,n,i,a){i=i||N;a=a||N;var r=Math.floor(t[0]/e),s=e*r,o=s+e,l=Math.abs(t[0]-s)<=i?s:Math.abs(o-t[0])<=i?o:t[0];var u=Math.floor(t[1]/n),c=n*u,h=c+n,f=Math.abs(t[1]-c)<=a?c:Math.abs(h-t[1])<=a?h:t[1];return[l,f]};this.posses=[];this.posseRoles={};this.toGrid=function(t){if(this.params.grid==null){return t}else{return F(t,this.params.grid[0],this.params.grid[1])}};this.snap=function(t,e){if(m==null)return;t=t||(this.params.grid?this.params.grid[0]:l);e=e||(this.params.grid?this.params.grid[1]:u);var n=this.params.getPosition(m);this.params.setPosition(m,F(n,t,e,t,e))};this.setUseGhostProxy=function(t){A=t?S:D};var Y;var G=function(t){return e.allowNegative===false?[Math.max(0,t[0]),Math.max(0,t[1])]:t};var U=function(t){Y=typeof t==="function"?t:t?function(t){return G([Math.max(0,Math.min(J.w-this.size[0],t[0])),Math.max(0,Math.min(J.h-this.size[1],t[1]))])}.bind(this):function(t){return G(t)}}.bind(this);U(typeof this.params.constrain==="function"?this.params.constrain:this.params.constrain||this.params.containment);this.setConstrain=function(t){U(t)};var R;this.setRevert=function(t){R=t};var Q=function(t){if(typeof t=="function"){t._katavorioId=T();return t._katavorioId}else{return t}},z={},X=function(t){for(var e in z){var n=z[e];var i=n[0](t);if(n[1])i=!i;if(!i)return false}return true},B=this.setFilter=function(e,n){if(e){var i=Q(e);z[i]=[function(n){var i=n.srcElement||n.target,r;if(a(e)){r=s(i,e,t)}else if(typeof e==="function"){r=e(n,t)}return r},n!==false]}},H=this.addFilter=B,W=this.removeFilter=function(t){var e=typeof t=="function"?t._katavorioId:t;delete z[e]};this.clearAllFilters=function(){z={}};this.canDrag=this.params.canDrag||b;var J,Z=[],q=[];this.downListener=function(t){var e=this.rightButtonCanDrag||t.which!==3&&t.button!==2;if(e&&this.isEnabled()&&this.canDrag()){var i=X(t)&&E(t,this.el,this.k);if(i){if(!y)m=this.el;else{m=this.el.cloneNode(true);m.setAttribute("id",null);m.style.position="absolute";var a=r(this.el);m.style.left=a.left+"px";m.style.top=a.top+"px";document.body.appendChild(m)}g&&j(t);c=f(t);V=[O.position().left,O.position().top];this.params.bind(document,"mousemove",this.moveListener);this.params.bind(document,"mouseup",this.upListener);o.markSelection(this);o.markPosses(this);this.params.addClass(document.body,n.noSelect);K("beforeStart",{el:this.el,pos:h,e:t,drag:this})}else if(this.params.consumeFilteredEvents){j(t)}}}.bind(this);this.moveListener=function(t){L=(L+1)%1e6;if(c){if(!v){var e=K("start",{el:this.el,pos:h,e:t,drag:this});if(e!==false){if(!c)return;this.mark(true);v=true}}if(c){q.length=0;var n=f(t),i=n[0]-c[0],a=n[1]-c[1],r=this.params.ignoreZoom?1:o.getZoom();var s=O.css("transform");var l=s=="none"?1:parseFloat(new RegExp("\\d(\\.\\d*)?").exec(s)[0]);var u=V[0]-O.position().left;var d=V[1]-O.position().top;i+=u;a+=d;i/=l;a/=l;i/=r;a/=r;this.moveBy(i,a,t);o.updateSelection(i,a,this);o.updatePosses(i,a,this);var p=L;var _=this;window.setTimeout(function(){if(L==p&&typeof _["moveListener"]=="function"){_.moveListener(t)}},50)}}}.bind(this);this.upListener=function(t){if(c){c=null;this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.params.removeClass(document.body,n.noSelect);this.unmark(t);o.unmarkSelection(this,t);o.unmarkPosses(this,t);this.stop(t);o.notifySelectionDragStop(this,t);o.notifyPosseDragStop(this,t);v=false;if(y){m&&m.parentNode&&m.parentNode.removeChild(m);m=null}q.length=0;if(R&&R(this.el,this.params.getPosition(this.el))===true){this.params.setPosition(this.el,h);K("revert",this.el)}}}.bind(this);this.getFilters=function(){return z};this.abort=function(){if(c!=null)this.upListener()};this.getDragElement=function(){return m||this.el};var $={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};if(e.events.start)$.start.push(e.events.start);if(e.events.beforeStart)$.beforeStart.push(e.events.beforeStart);if(e.events.stop)$.stop.push(e.events.stop);if(e.events.drag)$.drag.push(e.events.drag);if(e.events.revert)$.revert.push(e.events.revert);this.on=function(t,e){if($[t])$[t].push(e)};this.off=function(t,e){if($[t]){var n=[];for(var i=0;i<$[t].length;i++){if($[t][i]!==e)n.push($[t][i])}$[t]=n}};var K=function(t,e){if($[t]){for(var n=0;n<$[t].length;n++){try{$[t][n](e)}catch(i){}}}};this.notifyStart=function(t){K("start",{el:this.el,pos:this.params.getPosition(m),e:t,drag:this})};this.stop=function(t,e){if(e||v){var n=[],i=o.getSelection(),a=this.params.getPosition(m);if(i.length>1){for(var r=0;r<i.length;r++){var s=this.params.getPosition(i[r].el);n.push([i[r].el,{left:s[0],top:s[1]},i[r]])}}else{n.push([m,{left:a[0],top:a[1]},this])}K("stop",{el:m,pos:te||a,finalPos:a,e:t,drag:this,selection:n})}};this.mark=function(t){h=this.params.getPosition(m);d=this.params.getPosition(m,true);p=[d[0]-h[0],d[1]-h[1]];this.size=this.params.getSize(m);Z=o.getMatchingDroppables(this);P(Z,true,false,this);this.params.addClass(m,this.params.dragClass||n.drag);var e=this.params.getSize(m.parentNode);J={w:e[0],h:e[1]};if(t){o.notifySelectionDragStart(this)}};var te;this.unmark=function(t,i){P(Z,false,true,this);if(I&&A(this.el)){te=[m.offsetLeft,m.offsetTop];this.el.parentNode.removeChild(m);m=this.el}else{te=null}this.params.removeClass(m,this.params.dragClass||n.drag);Z.length=0;I=false;if(!i){if(q.length>0&&te){e.setPosition(this.el,te)}q.sort(k);for(var a=0;a<q.length;a++){var r=q[a].drop(this,t);if(r===true)break}}};this.moveBy=function(t,n,i){q.length=0;var a=this.toGrid([h[0]+t,h[1]+n]),r=Y(a,m);if(A(this.el)){if(a[0]!=r[0]||a[1]!=r[1]){if(!I){var s=M(this.el);e.addClass(s,_.ghostProxy);this.el.parentNode.appendChild(s);m=s;I=true}r=a}else{if(I){this.el.parentNode.removeChild(m);m=this.el;I=false}}}var o={x:r[0],y:r[1],w:this.size[0],h:this.size[1]},l={x:o.x+p[0],y:o.y+p[1],w:o.w,h:o.h},u=null;this.params.setPosition(m,r);for(var c=0;c<Z.length;c++){var f={x:Z[c].pagePosition[0],y:Z[c].pagePosition[1],w:Z[c].size[0],h:Z[c].size[1]};if(this.params.intersects(l,f)&&(C||u==null||u==Z[c].el)&&Z[c].canDrop(this)){if(!u)u=Z[c].el;q.push(Z[c]);Z[c].setHover(this,true,i)}else if(Z[c].isHover()){Z[c].setHover(this,false,i)}}K("drag",{el:this.el,pos:r,e:i,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);if(this.params.handle)B(this.params.handle,false);else B(this.params.filter,this.params.filterExclude)};var A=function(t,e,n,i){this._class=n.droppable;this.params=e||{};this.rank=e.rank||0;this._activeClass=this.params.activeClass||n.active;this._hoverClass=this.params.hoverClass||n.hover;w.apply(this,arguments);var a=false;this.allowLoopback=this.params.allowLoopback!==false;this.setActive=function(t){this.params[t?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.pagePosition=this.params.getPosition(this.el,true);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(t){return true};this.isHover=function(){return a};this.setHover=function(t,e,n){if(e||this.el._katavorioDragHover==null||this.el._katavorioDragHover==t.el._katavorio){this.params[e?"addClass":"removeClass"](this.el,this._hoverClass);this.el._katavorioDragHover=e?t.el._katavorio:null;if(a!==e)this.params.events[e?"over":"out"]({el:this.el,e:n,drag:t,drop:this});a=e}};this.drop=function(t,e){return this.params.events["drop"]({drag:t,e:e,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;a=null}};var T=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t=="x"?e:e&3|8;return n.toString(16)})};var k=function(t,e){return t.rank<e.rank?1:t.rank>e.rank?-1:0};var M=function(t){if(t==null)return null;t=typeof t==="string"||t.constructor==String?document.getElementById(t):t;if(t==null)return null;t._katavorio=t._katavorio||T();return t};t.Katavorio=function(t){var r=[],s={};this._dragsByScope={};this._dropsByScope={};var o=1,l=function(t,e){x(t,function(t){for(var n=0;n<t.scopes.length;n++){e[t.scopes[n]]=e[t.scopes[n]]||[];e[t.scopes[n]].push(t)}})},u=function(e,n){var i=0;x(e,function(e){for(var a=0;a<e.scopes.length;a++){if(n[e.scopes[a]]){var r=t.indexOf(n[e.scopes[a]],e);if(r!=-1){n[e.scopes[a]].splice(r,1);i++}}}});return i>0},c=this.getMatchingDroppables=function(t){var e=[],n={};for(var i=0;i<t.scopes.length;i++){var a=this._dropsByScope[t.scopes[i]];if(a){for(var r=0;r<a.length;r++){if(a[r].canDrop(t)&&!n[a[r].uuid]&&(a[r].allowLoopback||a[r].el!==t.el)){n[a[r].uuid]=true;e.push(a[r])}}}}e.sort(k);return e},h=function(e){e=e||{};var n={events:{}},i;for(i in t)n[i]=t[i];for(i in e)n[i]=e[i];for(i=0;i<g.length;i++){n.events[g[i]]=e[g[i]]||m}n.katavorio=this;return n}.bind(this),f=function(t,e){for(var n=0;n<g.length;n++){if(e[g[n]]){t.on(g[n],e[g[n]])}}}.bind(this),d={},p=t.css||{},b=t.scope||v;for(var P in _)d[P]=_[P];for(var P in p)d[P]=p[P];var j=t.inputFilterSelector||C;this.getInputFilterSelector=function(){return j};this.setInputFilterSelector=function(t){j=t;return this};this.draggable=function(e,n){var i=[];x(e,function(e){e=M(e);if(e!=null){if(e._katavorioDrag==null){var a=h(n);e._katavorioDrag=new I(e,a,d,b);l(e._katavorioDrag,this._dragsByScope);i.push(e._katavorioDrag);t.addClass(e,d.draggable)}else{f(e._katavorioDrag,n)}}}.bind(this));return i};this.droppable=function(e,n){var i=[];x(e,function(e){e=M(e);if(e!=null){var a=new A(e,h(n),d,b);e._katavorioDrop=e._katavorioDrop||[];e._katavorioDrop.push(a);l(a,this._dropsByScope);i.push(a);t.addClass(e,d.droppable)}}.bind(this));return i};this.select=function(e){x(e,function(){var e=M(this);if(e&&e._katavorioDrag){if(!s[e._katavorio]){r.push(e._katavorioDrag);s[e._katavorio]=[e,r.length-1];t.addClass(e,d.selected)}}});return this};this.deselect=function(e){x(e,function(){var e=M(this);if(e&&e._katavorio){var n=s[e._katavorio];if(n){var i=[];for(var a=0;a<r.length;a++)if(r[a].el!==e)i.push(r[a]);r=i;delete s[e._katavorio];t.removeClass(e,d.selected)}}});return this};this.deselectAll=function(){for(var e in s){var n=s[e];t.removeClass(n[0],d.selected)}r.length=0;s={}};this.markSelection=function(t){y(r,function(t){t.mark()},t)};this.markPosses=function(t){if(t.posses){x(t.posses,function(e){if(t.posseRoles[e]&&D[e]){y(D[e].members,function(t){t.mark()},t)}})}};this.unmarkSelection=function(t,e){y(r,function(t){t.unmark(e)},t)};this.unmarkPosses=function(t,e){if(t.posses){x(t.posses,function(n){if(t.posseRoles[n]&&D[n]){y(D[n].members,function(t){t.unmark(e,true)},t)}})}};this.getSelection=function(){return r.slice(0)};this.updateSelection=function(t,e,n){y(r,function(n){n.moveBy(t,e)},n)};var E=function(t,e){if(e.posses){x(e.posses,function(n){if(e.posseRoles[n]&&D[n]){y(D[n].members,function(e){t(e)},e)}})}};this.updatePosses=function(t,e,n){E(function(n){n.moveBy(t,e)},n)};this.notifyPosseDragStop=function(t,e){E(function(t){t.stop(e,true)},t)};this.notifySelectionDragStop=function(t,e){y(r,function(t){t.stop(e,true)},t)};this.notifySelectionDragStart=function(t,e){y(r,function(t){t.notifyStart(e)},t)};this.setZoom=function(t){o=t};this.getZoom=function(){return o};var w=function(t,e,n,i){x(t,function(t){u(t,n);t[i](e);l(t,n)})};x(["set","add","remove","toggle"],function(t){this[t+"Scope"]=function(e,n){w(e._katavorioDrag,n,this._dragsByScope,t+"Scope");w(e._katavorioDrop,n,this._dropsByScope,t+"Scope")}.bind(this);this[t+"DragScope"]=function(e,n){w(e.constructor===I?e:e._katavorioDrag,n,this._dragsByScope,t+"Scope")}.bind(this);this[t+"DropScope"]=function(e,n){w(e.constructor===A?e:e._katavorioDrop,n,this._dropsByScope,t+"Scope")}.bind(this)}.bind(this));this.snapToGrid=function(t,e){for(var n in this._dragsByScope){y(this._dragsByScope[n],function(n){n.snap(t,e)})}};this.getDragsForScope=function(t){return this._dragsByScope[t]};this.getDropsForScope=function(t){return this._dropsByScope[t]};var S=function(t,e,n){t=M(t);if(t[e]){var i=r.indexOf(t[e]);if(i>=0){r.splice(i,1)}if(u(t[e],n)){x(t[e],function(t){t.destroy()})}delete t[e]}};this.elementRemoved=function(t){this.destroyDraggable(t);this.destroyDroppable(t)};this.destroyDraggable=function(t){S(t,"_katavorioDrag",this._dragsByScope)};this.destroyDroppable=function(t){S(t,"_katavorioDrop",this._dropsByScope)};this.reset=function(){this._dragsByScope={};this._dropsByScope={};r=[];s={};D={}};var D={};var T=function(t,n,i){var r=a(n)?n:n.id;var s=a(n)?true:n.active!==false;var o=D[r]||function(){var t={name:r,members:[]};D[r]=t;return t}();x(t,function(t){if(t._katavorioDrag){if(i&&t._katavorioDrag.posseRoles[o.name]!=null)return;e(o.members,t._katavorioDrag);e(t._katavorioDrag.posses,o.name);t._katavorioDrag.posseRoles[o.name]=s}});return o};this.addToPosse=function(t,e){var n=[];for(var i=1;i<arguments.length;i++){n.push(T(t,arguments[i]))}return n.length==1?n[0]:n};this.setPosse=function(t,e){var n=[];for(var a=1;a<arguments.length;a++){n.push(T(t,arguments[a],true).name)}x(t,function(t){if(t._katavorioDrag){var e=i(t._katavorioDrag.posses,n);var a=[];Array.prototype.push.apply(a,t._katavorioDrag.posses);for(var r=0;r<e.length;r++){this.removeFromPosse(t,e[r])}}}.bind(this));return n.length==1?n[0]:n};this.removeFromPosse=function(t,e){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var i=1;i<arguments.length;i++){e=arguments[i];x(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var i=t._katavorioDrag;x(e,function(t){n(D[t].members,i);n(i.posses,t);delete i.posseRoles[t]})}})}};this.removeFromAllPosses=function(t){x(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var e=t._katavorioDrag;x(e.posses,function(t){n(D[t].members,e)});e.posses.length=0;e.posseRoles={}}})};this.setPosseState=function(t,e,n){var i=D[e];if(i){x(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){t._katavorioDrag.posseRoles[i.name]=n}})}}};t.Katavorio.version="0.19.2";if(typeof exports!=="undefined"){exports.Katavorio=t.Katavorio}}).call(typeof window!=="undefined"?window:this);(function(){var t=function(t){return Object.prototype.toString.call(t)==="[object Array]"},e=function(t){return Object.prototype.toString.call(t)==="[object Number]"},n=function(t){return typeof t==="string"},i=function(t){return typeof t==="boolean"},a=function(t){return t==null},r=function(t){return t==null?false:Object.prototype.toString.call(t)==="[object Object]"},s=function(t){return Object.prototype.toString.call(t)==="[object Date]"},o=function(t){return Object.prototype.toString.call(t)==="[object Function]"},l=function(t){return o(t)&&t.name!=null&&t.name.length>0},u=function(t){for(var e in t){if(t.hasOwnProperty(e)){return false}}return true};var c=this;c.jsPlumbUtil={isArray:t,isString:n,isBoolean:i,isNull:a,isObject:r,isDate:s,isFunction:o,isEmpty:u,isNumber:e,clone:function(e){if(n(e)){return""+e}else if(i(e)){return!!e}else if(s(e)){return new Date(e.getTime())}else if(o(e)){return e}else if(t(e)){var a=[];for(var l=0;l<e.length;l++){a.push(this.clone(e[l]))}return a}else if(r(e)){var u={};for(var c in e){u[c]=this.clone(e[c])}return u}else{return e}},merge:function(e,a,s){var o={},l,u;s=s||[];for(u=0;u<s.length;u++){o[s[u]]=true}var c=this.clone(e);for(u in a){if(c[u]==null){c[u]=a[u]}else if(n(a[u])||i(a[u])){if(!o[u]){c[u]=a[u]}else{l=[];l.push.apply(l,t(c[u])?c[u]:[c[u]]);l.push.apply(l,t(a[u])?a[u]:[a[u]]);c[u]=l}}else{if(t(a[u])){l=[];if(t(c[u])){l.push.apply(l,c[u])}l.push.apply(l,a[u]);c[u]=l}else if(r(a[u])){if(!r(c[u])){c[u]={}}for(var h in a[u]){c[u][h]=a[u][h]}}}}return c},replace:function(t,e,n){if(t==null){return}var i=t,a=i;e.replace(/([^\.])+/g,function(t,e,i,r){var s=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),o=i+t.length>=r.length,l=function(){return a[s[1]]||function(){a[s[1]]=[];return a[s[1]]}()};if(o){if(s){l()[s[3]]=n}else{a[t]=n}}else{if(s){var u=l();a=u[s[3]]||function(){u[s[3]]={};return u[s[3]]}()}else{a=a[t]||function(){a[t]={};return a[t]}()}}});return t},functionChain:function(t,e,n){for(var i=0;i<n.length;i++){var a=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(a===e){return a}}return t},populate:function(e,i,a){var s=function(t){var e=t.match(/(\${.*?})/g);if(e!=null){for(var n=0;n<e.length;n++){var a=i[e[n].substring(2,e[n].length-1)]||"";if(a!=null){t=t.replace(e[n],a)}}}return t},l=function(e){if(e!=null){if(n(e)){return s(e)}else if(o(e)&&(a==null||(e.name||"").indexOf(a)===0)){return e(i)}else if(t(e)){var u=[];for(var c=0;c<e.length;c++){u.push(l(e[c]))}return u}else if(r(e)){var h={};for(var f in e){h[f]=l(e[f])}return h}else{return e}}};return l(e)},findWithFunction:function(t,e){if(t){for(var n=0;n<t.length;n++){if(e(t[n])){return n}}}return-1},removeWithFunction:function(t,e){var n=c.jsPlumbUtil.findWithFunction(t,e);if(n>-1){t.splice(n,1)}return n!==-1},remove:function(t,e){var n=t.indexOf(e);if(n>-1){t.splice(n,1)}return n!==-1},addWithFunction:function(t,e,n){if(c.jsPlumbUtil.findWithFunction(t,n)===-1){t.push(e)}},addToList:function(t,e,n,i){var a=t[e];if(a==null){a=[];t[e]=a}a[i?"unshift":"push"](n);return a},suggest:function(t,e,n){if(t.indexOf(e)===-1){if(n){t.unshift(e)}else{t.push(e)}return true}return false},extend:function(e,n,i){var a;n=t(n)?n:[n];for(a=0;a<n.length;a++){for(var r in n[a].prototype){if(n[a].prototype.hasOwnProperty(r)){e.prototype[r]=n[a].prototype[r]}}}var s=function(t,e){return function(){for(a=0;a<n.length;a++){if(n[a].prototype[t]){n[a].prototype[t].apply(this,arguments)}}return e.apply(this,arguments)}};var o=function(t){for(var n in t){e.prototype[n]=s(n,t[n])}};if(arguments.length>2){for(a=2;a<arguments.length;a++){o(arguments[a])}}return e},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})},logEnabled:true,log:function(){if(c.jsPlumbUtil.logEnabled&&typeof console!=="undefined"){try{var t=arguments[arguments.length-1];console.log(t)}catch(e){}}},wrap:function(t,e,n){t=t||function(){};e=e||function(){};return function(){var i=null;try{i=e.apply(this,arguments)}catch(a){c.jsPlumbUtil.log("jsPlumb function failed : "+a)}if(n==null||i!==n){try{i=t.apply(this,arguments)}catch(a){c.jsPlumbUtil.log("wrapped function failed : "+a)}}return i}}};c.jsPlumbUtil.EventGenerator=function(){var t={},e=false,n={ready:true};this.bind=function(e,n,i){var a=function(e){c.jsPlumbUtil.addToList(t,e,n,i);n.__jsPlumb=n.__jsPlumb||{};n.__jsPlumb[c.jsPlumbUtil.uuid()]=e};if(typeof e==="string"){a(e)}else if(e.length!=null){for(var r=0;r<e.length;r++){a(e[r])}}return this};this.fire=function(i,a,r){if(!e&&t[i]){var s=t[i].length,o=0,l=false,u=null;if(!this.shouldFireEvent||this.shouldFireEvent(i,a,r)){while(!l&&o<s&&u!==false){if(n[i]){t[i][o].apply(this,[a,r])}else{try{u=t[i][o].apply(this,[a,r])}catch(h){c.jsPlumbUtil.log("jsPlumb: fire failed for event "+i+" : "+h)}}o++;if(t==null||t[i]==null){l=true}}}}return this};this.unbind=function(e,n){if(arguments.length===0){t={}}else if(arguments.length===1){if(typeof e==="string"){delete t[e]}else if(e.__jsPlumb){var i;for(var a in e.__jsPlumb){i=e.__jsPlumb[a];c.jsPlumbUtil.remove(t[i]||[],e)}}}else if(arguments.length===2){c.jsPlumbUtil.remove(t[e]||[],n)}return this};this.getListener=function(e){return t[e]};this.setSuspendEvents=function(t){e=t};this.isSuspendEvents=function(){return e};this.silently=function(t){this.setSuspendEvents(true);try{t()}catch(e){c.jsPlumbUtil.log("Cannot execute silent function "+e)}this.setSuspendEvents(false)};this.cleanupListeners=function(){for(var e in t){t[e]=null}}};c.jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};if(typeof exports!=="undefined"){exports.jsPlumbUtil=c.jsPlumbUtil}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this;t.jsPlumbUtil.matchesSelector=function(t,e,n){n=n||t.parentNode;var i=n.querySelectorAll(e);for(var a=0;a<i.length;a++){if(i[a]===t){return true}}return false};t.jsPlumbUtil.consume=function(t,e){if(t.stopPropagation){t.stopPropagation()}else{t.returnValue=false}if(!e&&t.preventDefault){t.preventDefault()}};t.jsPlumbUtil.sizeElement=function(t,e,n,i,a){if(t){t.style.height=a+"px";t.height=a;t.style.width=i+"px";t.width=i;t.style.left=e+"px";t.style.top=n+"px"}}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this;var e=[],n;var i=t.jsPlumbUtil,a=function(){return""+(new Date).getTime()},r=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var e={};m.extend(e,t._jsPlumb.paintStyle);m.extend(e,t._jsPlumb.hoverPaintStyle);delete t._jsPlumb.hoverPaintStyle;if(e.gradient&&t._jsPlumb.paintStyle.fill){delete e.gradient}t._jsPlumb.hoverPaintStyle=e}},s=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],o={mouseout:"mouseleave",mouseexit:"mouseleave"},l=function(t,e,n,i){var a=t.getAttachedElements();if(a){for(var r=0,s=a.length;r<s;r++){if(!i||i!==a[r]){a[r].setHover(e,true,n)}}}},u=function(t){return t==null?null:t.split(" ")},c=function(t,e,n){for(var i in e){t[i]=n}},h=function(t,e){e=i.isArray(e)||e.length!=null&&!i.isString(e)?e:[e];for(var n=0;n<e.length;n++){try{t.apply(e[n],[e[n]])}catch(a){i.log(".each iteration failed : "+a)}}},f=function(t,e,n){if(t.getDefaultType){var a=t.getTypeDescriptor(),r={};var s=t.getDefaultType();var o=i.merge({},s);c(r,s,"__default");for(var l=0,u=t._jsPlumb.types.length;l<u;l++){var h=t._jsPlumb.types[l];if(h!=="__default"){var f=t._jsPlumb.instance.getType(h,a);if(f!=null){o=i.merge(o,f,["cssClass"]);c(r,f,h)}}}if(e){o=i.populate(o,e,"_")}t.applyType(o,n,r);if(!n){t.repaint()}}},d=t.jsPlumbUIComponent=function(t){i.EventGenerator.apply(this,arguments);var e=this,n=arguments,a=e.idPrefix,r=a+(new Date).getTime();this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:false,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}};this.cacheTypeItem=function(t,e,n){this._jsPlumb.typeCache[n]=this._jsPlumb.typeCache[n]||{};this._jsPlumb.typeCache[n][t]=e};this.getCachedTypeItem=function(t,e){return this._jsPlumb.typeCache[e]?this._jsPlumb.typeCache[e][t]:null};this.getId=function(){return r};var s=t.overlays||[],o={};if(this.defaultOverlayKeys){for(var l=0;l<this.defaultOverlayKeys.length;l++){Array.prototype.push.apply(s,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[l]]||[])}for(l=0;l<s.length;l++){var u=m.convertToFullOverlaySpec(s[l]);o[u[1].id]=u}}var c={overlays:o,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()};this.getDefaultType=function(){return c};this.appendToDefaultType=function(t){for(var e in t){c[e]=t[e]}};if(t.events){for(var h in t.events){e.bind(h,t.events[h])}}this.clone=function(){var t=Object.create(this.constructor.prototype);this.constructor.apply(t,n);return t}.bind(this);this.isDetachAllowed=function(t){var e=true;if(this._jsPlumb.beforeDetach){try{e=this._jsPlumb.beforeDetach(t)}catch(n){i.log("jsPlumb: beforeDetach callback failed",n)}}return e};this.isDropAllowed=function(t,e,n,a,r,s,o){var l=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:e,scope:n,connection:a,dropEndpoint:r,source:s,target:o});if(this._jsPlumb.beforeDrop){try{l=this._jsPlumb.beforeDrop({sourceId:t,targetId:e,scope:n,connection:a,dropEndpoint:r,source:s,target:o})}catch(u){i.log("jsPlumb: beforeDrop callback failed",u)}}return l};var f=[];this.setListenerComponent=function(t){for(var e=0;e<f.length;e++){f[e][3]=t}}};var p=function(t,e){var n=t._jsPlumb.types[e],i=t._jsPlumb.instance.getType(n,t.getTypeDescriptor());if(i!=null&&i.cssClass&&t.canvas){t._jsPlumb.instance.removeClass(t.canvas,i.cssClass)}};i.extend(t.jsPlumbUIComponent,i.EventGenerator,{getParameter:function(t){return this._jsPlumb.parameters[t]},setParameter:function(t,e){this._jsPlumb.parameters[t]=e},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(t){this._jsPlumb.parameters=t},getClass:function(){return m.getClass(this.canvas)},hasClass:function(t){return m.hasClass(this.canvas,t)},addClass:function(t){m.addClass(this.canvas,t)},removeClass:function(t){m.removeClass(this.canvas,t)},updateClasses:function(t,e){m.updateClasses(this.canvas,t,e)},setType:function(t,e,n){this.clearTypes();this._jsPlumb.types=u(t)||[];f(this,e,n)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(t,e){f(this,t,e)},hasType:function(t){return this._jsPlumb.types.indexOf(t)!==-1},addType:function(t,e,n){var i=u(t),a=false;if(i!=null){for(var r=0,s=i.length;r<s;r++){if(!this.hasType(i[r])){this._jsPlumb.types.push(i[r]);a=true}}if(a){f(this,e,n)}}},removeType:function(t,e,n){var i=u(t),a=false,r=function(t){var e=this._jsPlumb.types.indexOf(t);if(e!==-1){p(this,e);this._jsPlumb.types.splice(e,1);return true}return false}.bind(this);if(i!=null){for(var s=0,o=i.length;s<o;s++){a=r(i[s])||a}if(a){f(this,e,n)}}},clearTypes:function(t,e){var n=this._jsPlumb.types.length;for(var i=0;i<n;i++){p(this,0);this._jsPlumb.types.splice(0,1)}f(this,t,e)},toggleType:function(t,e,n){var i=u(t);if(i!=null){for(var a=0,r=i.length;a<r;a++){var s=this._jsPlumb.types.indexOf(i[a]);if(s!==-1){p(this,s);this._jsPlumb.types.splice(s,1)}else{this._jsPlumb.types.push(i[a])}}f(this,e,n)}},applyType:function(t,e){this.setPaintStyle(t.paintStyle,e);this.setHoverPaintStyle(t.hoverPaintStyle,e);if(t.parameters){for(var n in t.parameters){this.setParameter(n,t.parameters[n])}}this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(t,e){this._jsPlumb.paintStyle=t;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;r(this);if(!e){this.repaint()}},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(t,e){this._jsPlumb.hoverPaintStyle=t;r(this);if(!e){this.repaint()}},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(t){if(t||this.typeId==null){this.cleanupListeners();this.clone=null;this._jsPlumb=null}},isHover:function(){return this._jsPlumb.hover},setHover:function(t,e,n){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=t;var i=t?"addClass":"removeClass";if(this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){this._jsPlumb.instance[i](this.canvas,this._jsPlumb.instance.hoverClass)}if(this._jsPlumb.hoverClass!=null){this._jsPlumb.instance[i](this.canvas,this._jsPlumb.hoverClass)}}if(this._jsPlumb.hoverPaintStyle!=null){this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle;if(!this._jsPlumb.instance.isSuspendDrawing()){n=n||a();this.repaint({timestamp:n,recalc:false})}}if(this.getAttachedElements&&!e){l(this,t,a(),this)}}}});var _=0,v=function(){var t=_+1;_++;return t};var g=t.jsPlumbInstance=function(r){this.version="2.4.3";if(r){m.extend(this.Defaults,r)}this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};i.EventGenerator.apply(this);var o=this,l=v(),u=o.bind,c={},f=1,p=function(t){if(t==null){return null}else if(t.nodeType===3||t.nodeType===8){return{el:t,text:true}}else{var e=o.getElement(t);return{el:e,id:i.isString(t)&&e==null?t:q(e)}}};this.getInstanceIndex=function(){return l};this.setZoom=function(t,e){f=t;o.fire("zoom",f);if(e){o.repaintEverything()}return true};this.getZoom=function(){return f};for(var _ in this.Defaults){c[_]=this.Defaults[_]}var g,b=[];this.unbindContainer=function(){if(g!=null&&b.length>0){for(var t=0;t<b.length;t++){o.off(g,b[t][0],b[t][1])}}};this.setContainer=function(t){this.unbindContainer();t=this.getElement(t);this.select().each(function(e){e.moveParent(t)});this.selectEndpoints().each(function(e){e.moveParent(t)});var e=g;g=t;b.length=0;var n={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"};var i=function(t,e,i){var a=e.srcElement||e.target,r=(a&&a.parentNode?a.parentNode._jsPlumb:null)||(a?a._jsPlumb:null)||(a&&a.parentNode&&a.parentNode.parentNode?a.parentNode.parentNode._jsPlumb:null);if(r){r.fire(t,r,e);var s=i?n[i+t]||t:t;o.fire(s,r.component||r,e)}};var a=function(t,e,n){b.push([t,n]);o.on(g,t,e,n)};var r=function(t){a(t,".jtk-connector",function(e){i(t,e)});a(t,".jtk-endpoint",function(e){i(t,e,"endpoint")});a(t,".jtk-overlay",function(e){i(t,e)})};for(var l=0;l<s.length;l++){r(s[l])}for(var u in E){var c=E[u].el;if(c.parentNode===e){e.removeChild(c);g.appendChild(c)}}};this.getContainer=function(){return g};this.bind=function(t,e){if("ready"===t&&P){e()}else{u.apply(o,[t,e])}};o.importDefaults=function(t){for(var e in t){o.Defaults[e]=t[e]}if(t.Container){o.setContainer(t.Container)}return o};o.restoreDefaults=function(){o.Defaults=m.extend({},c);return o};var y=null,P=false,x=[],j={},C={},E={},w={},S={},D={},I=false,A=[],T=false,k=null,M=this.Defaults.Scope,O=1,V=function(){return""+O++},L=function(t,e){if(g){g.appendChild(t)}else if(!e){this.appendToRoot(t)}else{this.getElement(e).appendChild(t)}}.bind(this),N=function(t,e,n,i){if(!T){var r=q(t),s,l=o.getDragManager();if(l){s=l.getElementsForDraggable(r)}if(n==null){n=a()}var u=Pe({elId:r,offset:e,recalc:false,timestamp:n});if(s&&u&&u.o){for(var c in s){Pe({elId:s[c].id,offset:{left:u.o.left+s[c].offset.left,top:u.o.top+s[c].offset.top},recalc:false,timestamp:n})}}o.anchorManager.redraw(r,e,n,null,i);if(s){for(var h in s){o.anchorManager.redraw(s[h].id,e,n,s[h].offset,i,true)}}}},F=function(t){return C[t]},Y=function(t,e,n,a,r){if(!m.headless){var s=e==null?false:e;if(s){if(m.isDragSupported(t,o)){var l=n||o.Defaults.DragOptions;l=m.extend({},l);if(!m.isAlreadyDraggable(t,o)){var u=m.dragEvents.drag,c=m.dragEvents.stop,h=m.dragEvents.start,f=false;
be(a,t);l[h]=i.wrap(l[h],function(){o.setHoverSuspended(true);o.select({source:t}).addClass(o.elementDraggingClass+" "+o.sourceElementDraggingClass,true);o.select({target:t}).addClass(o.elementDraggingClass+" "+o.targetElementDraggingClass,true);o.setConnectionBeingDragged(true);if(l.canDrag){return n.canDrag()}},false);l[u]=i.wrap(l[u],function(){var e=o.getUIPosition(arguments,o.getZoom());if(e!=null){N(t,e,null,true);if(f){o.addClass(t,"jtk-dragged")}f=true}});l[c]=i.wrap(l[c],function(){var t=arguments[0].selection,e;var n=function(t){if(t[1]!=null){e=o.getUIPosition([{el:t[2].el,pos:[t[1].left,t[1].top]}]);N(t[2].el,e)}o.removeClass(t[0],"jtk-dragged");o.select({source:t[2].el}).removeClass(o.elementDraggingClass+" "+o.sourceElementDraggingClass,true);o.select({target:t[2].el}).removeClass(o.elementDraggingClass+" "+o.targetElementDraggingClass,true);o.getDragManager().dragEnded(t[2].el)};for(var i=0;i<t.length;i++){n(t[i])}f=false;o.setHoverSuspended(false);o.setConnectionBeingDragged(false)});var d=q(t);D[d]=true;var p=D[d];l.disabled=p==null?false:!p;o.initDraggable(t,l);o.getDragManager().register(t);if(r){o.fire("elementDraggable",{el:t,options:l})}}else{if(n.force){o.initDraggable(t,l)}}}}}},G=function(t,e){var n=t.scope.split(/\s/),i=e.scope.split(/\s/);for(var a=0;a<n.length;a++){for(var r=0;r<i.length;r++){if(i[r]===n[a]){return true}}}return false},U=function(t,e){var n=m.extend({},t);if(e){m.extend(n,e)}if(n.source){if(n.source.endpoint){n.sourceEndpoint=n.source}else{n.source=o.getElement(n.source)}}if(n.target){if(n.target.endpoint){n.targetEndpoint=n.target}else{n.target=o.getElement(n.target)}}if(t.uuids){n.sourceEndpoint=F(t.uuids[0]);n.targetEndpoint=F(t.uuids[1])}if(n.sourceEndpoint&&n.sourceEndpoint.isFull()){i.log(o,"could not add connection; source endpoint is full");return}if(n.targetEndpoint&&n.targetEndpoint.isFull()){i.log(o,"could not add connection; target endpoint is full");return}if(!n.type&&n.sourceEndpoint){n.type=n.sourceEndpoint.connectionType}if(n.sourceEndpoint&&n.sourceEndpoint.connectorOverlays){n.overlays=n.overlays||[];for(var a=0,r=n.sourceEndpoint.connectorOverlays.length;a<r;a++){n.overlays.push(n.sourceEndpoint.connectorOverlays[a])}}if(n.sourceEndpoint&&n.sourceEndpoint.scope){n.scope=n.sourceEndpoint.scope}if(!n["pointer-events"]&&n.sourceEndpoint&&n.sourceEndpoint.connectorPointerEvents){n["pointer-events"]=n.sourceEndpoint.connectorPointerEvents}var s=function(t,e){var n=m.extend({},t);for(var i in e){if(e[i]){n[i]=e[i]}}return n};var l=function(t,e,i){return o.addEndpoint(t,s(e,{anchor:n.anchors?n.anchors[i]:n.anchor,endpoint:n.endpoints?n.endpoints[i]:n.endpoint,paintStyle:n.endpointStyles?n.endpointStyles[i]:n.endpointStyle,hoverPaintStyle:n.endpointHoverStyles?n.endpointHoverStyles[i]:n.endpointHoverStyle}))};var u=function(t,e,i,a){if(n[t]&&!n[t].endpoint&&!n[t+"Endpoint"]&&!n.newConnection){var r=q(n[t]),s=i[r];s=s?s[a]:null;if(s){if(!s.enabled){return false}var o=s.endpoint!=null&&s.endpoint._jsPlumb?s.endpoint:l(n[t],s.def,e);if(o.isFull()){return false}n[t+"Endpoint"]=o;if(!n.scope&&s.def.scope){n.scope=s.def.scope}o.setDeleteOnEmpty(true);if(s.uniqueEndpoint){if(!s.endpoint){s.endpoint=o;o.setDeleteOnEmpty(false)}else{o.finalEndpoint=s.endpoint}}}}};if(u("source",0,this.sourceEndpointDefinitions,n.type||"default")===false){return}if(u("target",1,this.targetEndpointDefinitions,n.type||"default")===false){return}if(n.sourceEndpoint&&n.targetEndpoint){if(!G(n.sourceEndpoint,n.targetEndpoint)){n=null}}return n}.bind(o),R=function(t){var e=o.Defaults.ConnectionType||o.getDefaultConnectionType();t._jsPlumb=o;t.newConnection=R;t.newEndpoint=z;t.endpointsByUUID=C;t.endpointsByElement=j;t.finaliseConnection=Q;t.id="con_"+V();var n=new e(t);if(n.isDetachable()){n.endpoints[0].initDraggable("_jsPlumbSource");n.endpoints[1].initDraggable("_jsPlumbTarget")}return n},Q=o.finaliseConnection=function(t,e,n,i){e=e||{};if(!t.suspendedEndpoint){x.push(t)}t.pending=null;t.endpoints[0].isTemporarySource=false;if(i!==false){o.anchorManager.newConnection(t)}N(t.source);if(!e.doNotFireConnectionEvent&&e.fireEvent!==false){var a={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};o.fire("connection",a,n)}},z=function(t,e){var n=o.Defaults.EndpointType||m.Endpoint;var i=m.extend({},t);i._jsPlumb=o;i.newConnection=R;i.newEndpoint=z;i.endpointsByUUID=C;i.endpointsByElement=j;i.fireDetachEvent=te;i.elementId=e||q(i.source);var a=new n(i);a.id="ep_"+V();be(i.elementId,i.source);if(!m.headless){o.getDragManager().endpointAdded(i.source,e)}return a},X=function(t,e,n){var i=j[t];if(i&&i.length){for(var a=0,r=i.length;a<r;a++){for(var s=0,o=i[a].connections.length;s<o;s++){var l=e(i[a].connections[s]);if(l){return}}if(n){n(i[a])}}}},B=function(t,e){return m.each(t,function(t){if(o.isDragSupported(t)){D[o.getAttribute(t,"id")]=e;o.setElementDraggable(t,e)}})},H=function(t,e,n){e=e==="block";var i=null;if(n){i=function(t){t.setVisible(e,true,true)}}var a=p(t);X(a.id,function(t){if(e&&n){var i=t.sourceId===a.id?1:0;if(t.endpoints[i].isVisible()){t.setVisible(true)}}else{t.setVisible(e)}},i)},W=function(t){var e;m.each(t,function(t){var n=o.getAttribute(t,"id");e=D[n]==null?false:D[n];e=!e;D[n]=e;o.setDraggable(t,e);return e}.bind(this));return e},J=function(t,e){var n=null;if(e){n=function(t){var e=t.isVisible();t.setVisible(!e)}}X(t,function(t){var e=t.isVisible();t.setVisible(!e)},n)},Z=function(t){var e=w[t];if(!e){return Pe({elId:t})}else{return{o:e,s:A[t]}}},q=function(t,e,n){if(i.isString(t)){return t}if(t==null){return null}var a=o.getAttribute(t,"id");if(!a||a==="undefined"){if(arguments.length===2&&arguments[1]!==undefined){a=e}else if(arguments.length===1||arguments.length===3&&!arguments[2]){a="jsPlumb_"+l+"_"+V()}if(!n){o.setAttribute(t,"id",a)}}return a};this.setConnectionBeingDragged=function(t){I=t};this.isConnectionBeingDragged=function(){return I};this.getManagedElements=function(){return E};this.connectorClass="jtk-connector";this.connectorOutlineClass="jtk-connector-outline";this.editableConnectorClass="jtk-connector-editable";this.connectedClass="jtk-connected";this.hoverClass="jtk-hover";this.endpointClass="jtk-endpoint";this.endpointConnectedClass="jtk-endpoint-connected";this.endpointFullClass="jtk-endpoint-full";this.endpointDropAllowedClass="jtk-endpoint-drop-allowed";this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden";this.overlayClass="jtk-overlay";this.draggingClass="jtk-dragging";this.elementDraggingClass="jtk-element-dragging";this.sourceElementDraggingClass="jtk-source-element-dragging";this.targetElementDraggingClass="jtk-target-element-dragging";this.endpointAnchorClassPrefix="jtk-endpoint-anchor";this.hoverSourceClass="jtk-source-hover";this.hoverTargetClass="jtk-target-hover";this.dragSelectClass="jtk-drag-select";this.Anchors={};this.Connectors={svg:{}};this.Endpoints={svg:{}};this.Overlays={svg:{}};this.ConnectorRenderers={};this.SVG="svg";this.addEndpoint=function(t,e,n){n=n||{};var a=m.extend({},n);m.extend(a,e);a.endpoint=a.endpoint||o.Defaults.Endpoint;a.paintStyle=a.paintStyle||o.Defaults.EndpointStyle;var r=[],s=i.isArray(t)||t.length!=null&&!i.isString(t)?t:[t];for(var l=0,u=s.length;l<u;l++){a.source=o.getElement(s[l]);ge(a.source);var c=q(a.source),h=z(a,c);var f=be(c,a.source).info.o;i.addToList(j,c,h);if(!T){h.paint({anchorLoc:h.anchor.compute({xy:[f.left,f.top],wh:A[c],element:h,timestamp:k}),timestamp:k})}r.push(h)}return r.length===1?r[0]:r};this.addEndpoints=function(t,e,n){var a=[];for(var r=0,s=e.length;r<s;r++){var l=o.addEndpoint(t,e[r],n);if(i.isArray(l)){Array.prototype.push.apply(a,l)}else{a.push(l)}}return a};this.animate=function(t,e,n){if(!this.animationSupported){return false}n=n||{};var a=o.getElement(t),r=q(a),s=m.animEvents.step,l=m.animEvents.complete;n[s]=i.wrap(n[s],function(){o.revalidate(r)});n[l]=i.wrap(n[l],function(){o.revalidate(r)});o.doAnimate(a,e,n)};this.checkCondition=function(t,e){var n=o.getListener(t),a=true;if(n&&n.length>0){var r=Array.prototype.slice.call(arguments,1);try{for(var s=0,l=n.length;s<l;s++){a=a&&n[s].apply(n[s],r)}}catch(u){i.log(o,"cannot check condition ["+t+"]"+u)}}return a};this.connect=function(t,e){var n=U(t,e),a;if(n){if(n.source==null&&n.sourceEndpoint==null){i.log("Cannot establish connection - source does not exist");return}if(n.target==null&&n.targetEndpoint==null){i.log("Cannot establish connection - target does not exist");return}ge(n.source);a=R(n);Q(a,n)}return a};var $=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];var K=function(t,e,n,i){var a,r=$[n],s=t[r.elId],o=t[r.el],l,u,c=t.endpoints[n];var h={index:n,originalSourceId:n===0?s:t.sourceId,newSourceId:t.sourceId,originalTargetId:n===1?s:t.targetId,newTargetId:t.targetId,connection:t};if(e.constructor===m.Endpoint){a=e;a.addConnection(t);e=a.element}else{l=q(e);u=this[r.epDefs][l];if(l===t[r.elId]){a=null}else if(u){for(var f in u){if(!u[f].enabled){return}a=u[f].endpoint!=null&&u[f].endpoint._jsPlumb?u[f].endpoint:this.addEndpoint(e,u[f].def);if(u[f].uniqueEndpoint){u[f].endpoint=a}a.addConnection(t)}}else{a=t.makeEndpoint(n===0,e,l)}}if(a!=null){c.detachFromConnection(t);t.endpoints[n]=a;t[r.el]=a.element;t[r.elId]=a.elementId;h[n===0?"newSourceId":"newTargetId"]=a.elementId;ee(h);if(!i){t.repaint()}}h.element=e;return h}.bind(this);this.setSource=function(t,e,n){var i=K(t,e,0,n);this.anchorManager.sourceChanged(i.originalSourceId,i.newSourceId,t,i.el)};this.setTarget=function(t,e,n){var i=K(t,e,1,n);this.anchorManager.updateOtherEndpoint(i.originalSourceId,i.originalTargetId,i.newTargetId,t)};this.deleteEndpoint=function(t,e,n){var i=typeof t==="string"?C[t]:t;if(i){o.deleteObject({endpoint:i,dontUpdateHover:e,deleteAttachedObjects:n})}return o};this.deleteEveryEndpoint=function(){var t=o.setSuspendDrawing(true);for(var e in j){var n=j[e];if(n&&n.length){for(var i=0,a=n.length;i<a;i++){o.deleteEndpoint(n[i],true)}}}j={};E={};C={};w={};S={};o.anchorManager.reset();var r=o.getDragManager();if(r){r.reset()}if(!t){o.setSuspendDrawing(false)}return o};var te=function(t,e,n){var i=o.Defaults.ConnectionType||o.getDefaultConnectionType(),a=t.constructor===i,r=a?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;if(e){o.fire("connectionDetached",r,n)}o.fire("internal.connectionDetached",r,n);o.anchorManager.connectionDetached(r)};var ee=o.fireMoveEvent=function(t,e){o.fire("connectionMoved",t,e)};this.unregisterEndpoint=function(t){if(t._jsPlumb.uuid){C[t._jsPlumb.uuid]=null}o.anchorManager.deleteEndpoint(t);for(var e in j){var n=j[e];if(n){var i=[];for(var a=0,r=n.length;a<r;a++){if(n[a]!==t){i.push(n[a])}}j[e]=i}if(j[e].length<1){delete j[e]}}};var ne="isDetachAllowed";var ie="beforeDetach";var ae="checkCondition";this.deleteConnection=function(t,e){if(t!=null){e=e||{};if(e.force||i.functionChain(true,false,[[t.endpoints[0],ne,[t]],[t.endpoints[1],ne,[t]],[t,ne,[t]],[o,ae,[ie,t]]])){t.setHover(false);te(t,!t.pending&&e.fireEvent!==false,e.originalEvent);t.endpoints[0].detachFromConnection(t);t.endpoints[1].detachFromConnection(t);i.removeWithFunction(x,function(e){return t.id===e.id});t.cleanup();t.destroy();return true}}return false};this.deleteEveryConnection=function(t){t=t||{};var e=x.length,n=0;o.batch(function(){for(var i=0;i<e;i++){n+=o.deleteConnection(x[0],t)?1:0}});return n};this.deleteConnectionsForElement=function(t,e){e=e||{};t=o.getElement(t);var n=q(t),i=j[n];if(i&&i.length){for(var a=0,r=i.length;a<r;a++){i[a].deleteEveryConnection(e)}}return o};this.deleteObject=function(t){var e={endpoints:{},connections:{},endpointCount:0,connectionCount:0},n=t.deleteAttachedObjects!==false;var a=function(n){if(n!=null&&e.connections[n.id]==null){if(!t.dontUpdateHover&&n._jsPlumb!=null){n.setHover(false)}e.connections[n.id]=n;e.connectionCount++}};var r=function(i){if(i!=null&&e.endpoints[i.id]==null){if(!t.dontUpdateHover&&i._jsPlumb!=null){i.setHover(false)}e.endpoints[i.id]=i;e.endpointCount++;if(n){for(var r=0;r<i.connections.length;r++){var s=i.connections[r];a(s)}}}};if(t.connection){a(t.connection)}else{r(t.endpoint)}for(var s in e.connections){var l=e.connections[s];if(l._jsPlumb){i.removeWithFunction(x,function(t){return l.id===t.id});te(l,t.fireEvent===false?false:!l.pending,t.originalEvent);var u=t.deleteAttachedObjects==null?null:!t.deleteAttachedObjects;l.endpoints[0].detachFromConnection(l,null,u);l.endpoints[1].detachFromConnection(l,null,u);l.cleanup(true);l.destroy(true)}}for(var c in e.endpoints){var h=e.endpoints[c];if(h._jsPlumb){o.unregisterEndpoint(h);h.cleanup(true);h.destroy(true)}}return e};this.draggable=function(t,e){var n;h(function(t){n=p(t);if(n.el){Y(n.el,true,e,n.id,true)}},t);return o};this.droppable=function(t,e){var n;e=e||{};e.allowLoopback=false;h(function(t){n=p(t);if(n.el){o.initDroppable(n.el,e)}},t);return o};var re=function(t,e,n,i){for(var a=0,r=t.length;a<r;a++){t[a][e].apply(t[a],n)}return i(t)},se=function(t,e,n){var i=[];for(var a=0,r=t.length;a<r;a++){i.push([t[a][e].apply(t[a],n),t[a]])}return i},oe=function(t,e,n){return function(){return re(t,e,arguments,n)}},le=function(t,e){return function(){return se(t,e,arguments)}},ue=function(t,e){var n=[];if(t){if(typeof t==="string"){if(t==="*"){return t}n.push(t)}else{if(e){n=t}else{if(t.length){for(var i=0,a=t.length;i<a;i++){n.push(p(t[i]).id)}}else{n.push(p(t).id)}}}}return n},ce=function(t,e,n){if(t==="*"){return true}return t.length>0?t.indexOf(e)!==-1:!n};this.getConnections=function(t,e){if(!t){t={}}else if(t.constructor===String){t={scope:t}}var n=t.scope||o.getDefaultScope(),i=ue(n,true),a=ue(t.source),r=ue(t.target),s=!e&&i.length>1?{}:[],l=function(t,n){if(!e&&i.length>1){var a=s[t];if(a==null){a=s[t]=[]}a.push(n)}else{s.push(n)}};for(var u=0,c=x.length;u<c;u++){var h=x[u],f=h.proxies&&h.proxies[0]?h.proxies[0].originalEp.elementId:h.sourceId,d=h.proxies&&h.proxies[1]?h.proxies[1].originalEp.elementId:h.targetId;if(ce(i,h.scope)&&ce(a,f)&&ce(r,d)){l(h.scope,h)}}return s};var he=function(t,e){return function(n){for(var i=0,a=t.length;i<a;i++){n(t[i])}return e(t)}},fe=function(t){return function(e){return t[e]}};var de=function(t,e){var n={length:t.length,each:he(t,e),get:fe(t)},i=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],a=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],r,s;for(r=0,s=i.length;r<s;r++){n[i[r]]=oe(t,i[r],e)}for(r=0,s=a.length;r<s;r++){n[a[r]]=le(t,a[r])}return n};var pe=function(t){var e=de(t,pe);return m.extend(e,{setDetachable:oe(t,"setDetachable",pe),setReattach:oe(t,"setReattach",pe),setConnector:oe(t,"setConnector",pe),"delete":function(){for(var e=0,n=t.length;e<n;e++){o.deleteConnection(t[e])}},isDetachable:le(t,"isDetachable"),isReattach:le(t,"isReattach")})};var _e=function(t){var e=de(t,_e);return m.extend(e,{setEnabled:oe(t,"setEnabled",_e),setAnchor:oe(t,"setAnchor",_e),isEnabled:le(t,"isEnabled"),deleteEveryConnection:function(){for(var e=0,n=t.length;e<n;e++){t[e].deleteEveryConnection()}},"delete":function(){for(var e=0,n=t.length;e<n;e++){o.deleteEndpoint(t[e])}}})};this.select=function(t){t=t||{};t.scope=t.scope||"*";return pe(t.connections||o.getConnections(t,true))};this.selectEndpoints=function(t){t=t||{};t.scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,n=e?"*":ue(t.element),i=e?"*":ue(t.source),a=e?"*":ue(t.target),r=ue(t.scope,true);var s=[];for(var o in j){var l=ce(n,o,true),u=ce(i,o,true),c=i!=="*",h=ce(a,o,true),f=a!=="*";if(l||u||h){t:for(var d=0,p=j[o].length;d<p;d++){var _=j[o][d];if(ce(r,_.scope,true)){var v=c&&i.length>0&&!_.isSource,g=f&&a.length>0&&!_.isTarget;if(v||g){continue t}s.push(_)}}}}return _e(s)};this.getAllConnections=function(){return x};this.getDefaultScope=function(){return M};this.getEndpoint=F;this.getEndpoints=function(t){return j[p(t).id]||[]};this.getDefaultEndpointType=function(){return m.Endpoint};this.getDefaultConnectionType=function(){return m.Connection};this.getId=q;this.appendElement=L;var ve=false;this.isHoverSuspended=function(){return ve};this.setHoverSuspended=function(t){ve=t};this.hide=function(t,e){H(t,"none",e);return o};this.idstamp=V;this.connectorsInitialized=false;this.registerConnectorType=function(t,n){e.push([t,n])};var ge=function(t){if(!g&&t){var e=o.getElement(t);if(e.offsetParent){o.setContainer(e.offsetParent)}}};var me=function(){if(o.Defaults.Container){o.setContainer(o.Defaults.Container)}};var be=o.manage=function(t,e,n){if(!E[t]){E[t]={el:e,endpoints:[],connections:[]};E[t].info=Pe({elId:t,timestamp:k});if(!n){o.fire("manageElement",{id:t,info:E[t].info,el:e})}}return E[t]};var ye=function(t){if(E[t]){delete E[t];o.fire("unmanageElement",t)}};var Pe=this.updateOffset=function(t){var e=t.timestamp,n=t.recalc,i=t.offset,a=t.elId,r;if(T&&!e){e=k}if(!n){if(e&&e===S[a]){return{o:t.offset||w[a],s:A[a]}}}if(n||!i&&w[a]==null){r=E[a]?E[a].el:null;if(r!=null){A[a]=o.getSize(r);w[a]=o.getOffset(r);S[a]=e}}else{w[a]=i||w[a];if(A[a]==null){r=E[a].el;if(r!=null){A[a]=o.getSize(r)}}S[a]=e}if(w[a]&&!w[a].right){w[a].right=w[a].left+A[a][0];w[a].bottom=w[a].top+A[a][1];w[a].width=A[a][0];w[a].height=A[a][1];w[a].centerx=w[a].left+w[a].width/2;w[a].centery=w[a].top+w[a].height/2}return{o:w[a],s:A[a]}};this.init=function(){n=t.jsPlumb.getRenderModes();var a=function(e,n,a){t.jsPlumb.Connectors[e][n]=function(){a.apply(this,arguments);t.jsPlumb.ConnectorRenderers[e].apply(this,arguments)};i.extend(t.jsPlumb.Connectors[e][n],[a,t.jsPlumb.ConnectorRenderers[e]])};if(!t.jsPlumb.connectorsInitialized){for(var r=0;r<e.length;r++){for(var s=0;s<n.length;s++){a(n[s],e[r][1],e[r][0])}}t.jsPlumb.connectorsInitialized=true}if(!P){me();o.anchorManager=new t.jsPlumb.AnchorManager({jsPlumbInstance:o});P=true;o.fire("ready",o)}}.bind(this);this.log=y;this.jsPlumbUIComponent=d;this.makeAnchor=function(){var e,n=function(e,n){if(t.jsPlumb.Anchors[e]){return new t.jsPlumb.Anchors[e](n)}if(!o.Defaults.DoNotThrowErrors){throw{msg:"jsPlumb: unknown anchor type '"+e+"'"}}};if(arguments.length===0){return null}var a=arguments[0],r=arguments[1],s=arguments[2],l=null;if(a.compute&&a.getOrientation){return a}else if(typeof a==="string"){l=n(arguments[0],{elementId:r,jsPlumbInstance:o})}else if(i.isArray(a)){if(i.isArray(a[0])||i.isString(a[0])){if(a.length===2&&i.isObject(a[1])){if(i.isString(a[0])){e=t.jsPlumb.extend({elementId:r,jsPlumbInstance:o},a[1]);l=n(a[0],e)}else{e=t.jsPlumb.extend({elementId:r,jsPlumbInstance:o,anchors:a[0]},a[1]);l=new t.jsPlumb.DynamicAnchor(e)}}else{l=new m.DynamicAnchor({anchors:a,selector:null,elementId:r,jsPlumbInstance:o})}}else{var u={x:a[0],y:a[1],orientation:a.length>=4?[a[2],a[3]]:[0,0],offsets:a.length>=6?[a[4],a[5]]:[0,0],elementId:r,jsPlumbInstance:o,cssClass:a.length===7?a[6]:null};l=new t.jsPlumb.Anchor(u);l.clone=function(){return new t.jsPlumb.Anchor(u)}}}if(!l.id){l.id="anchor_"+V()}return l};this.makeAnchors=function(e,n,a){var r=[];for(var s=0,l=e.length;s<l;s++){if(typeof e[s]==="string"){r.push(t.jsPlumb.Anchors[e[s]]({elementId:n,jsPlumbInstance:a}))}else if(i.isArray(e[s])){r.push(o.makeAnchor(e[s],n,a))}}return r};this.makeDynamicAnchor=function(e,n){return new t.jsPlumb.DynamicAnchor({anchors:e,selector:n,elementId:null,jsPlumbInstance:o})};this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};var xe=function(t,e,n,i,a){var r=t.target||t.srcElement,s=false,o=i.getSelector(e,n);for(var l=0;l<o.length;l++){if(o[l]===r){s=true;break}}return a?!s:s};var je=function(e,n,a,r,s){var l=new d(n);var u=n._jsPlumb.EndpointDropHandler({jsPlumb:o,enabled:function(){return e.def.enabled},isFull:function(){var t=o.select({target:e.id}).length;return e.def.maxConnections>0&&t>=e.def.maxConnections},element:e.el,elementId:e.id,isSource:r,isTarget:s,addClass:function(t){o.addClass(e.el,t)},removeClass:function(t){o.removeClass(e.el,t)},onDrop:function(t){var e=t.endpoints[0];e.anchor.locked=false},isDropAllowed:function(){return l.isDropAllowed.apply(l,arguments)},isRedrop:function(t){return t.suspendedElement!=null&&t.suspendedEndpoint!=null&&t.suspendedEndpoint.element===e.el},getEndpoint:function(i){var a=e.def.endpoint;if(a==null||a._jsPlumb==null){var r=o.deriveEndpointAndAnchorSpec(i.getType().join(" "),true);var s=r.endpoints?t.jsPlumb.extend(n,{endpoint:e.def.def.endpoint||r.endpoints[1]}):n;if(r.anchors){s=t.jsPlumb.extend(s,{anchor:e.def.def.anchor||r.anchors[1]})}a=o.addEndpoint(e.el,s);a._mtNew=true}if(n.uniqueEndpoint){e.def.endpoint=a}a.setDeleteOnEmpty(true);if(i.isDetachable()){a.initDraggable()}if(a.anchor.positionFinder!=null){var l=o.getUIPosition(arguments,o.getZoom()),u=o.getOffset(e.el),c=o.getSize(e.el),h=l==null?[0,0]:a.anchor.positionFinder(l,u,c,a.anchor.constructorParams);a.anchor.x=h[0];a.anchor.y=h[1]}return a},maybeCleanup:function(t){if(t._mtNew&&t.connections.length===0){o.deleteObject({endpoint:t})}else{delete t._mtNew}}});var c=t.jsPlumb.dragEvents.drop;a.scope=a.scope||(n.scope||o.Defaults.Scope);a[c]=i.wrap(a[c],u,true);if(s){a[t.jsPlumb.dragEvents.over]=function(){return true}}if(n.allowLoopback===false){a.canDrop=function(t){var n=t.getDragElement()._jsPlumbRelatedElement;return n!==e.el}}o.initDroppable(e.el,a,"internal");return u};this.makeTarget=function(e,n,i){var a=t.jsPlumb.extend({_jsPlumb:this},i);t.jsPlumb.extend(a,n);var r=a.maxConnections||-1,s=function(e){var n=p(e),i=n.id,s=t.jsPlumb.extend({},a.dropOptions||{}),o=a.connectionType||"default";this.targetEndpointDefinitions[i]=this.targetEndpointDefinitions[i]||{};ge(i);if(n.el._isJsPlumbGroup&&s.rank==null){s.rank=-1}var l={def:t.jsPlumb.extend({},a),uniqueEndpoint:a.uniqueEndpoint,maxConnections:r,enabled:true};n.def=l;this.targetEndpointDefinitions[i][o]=l;je(n,a,s,a.isSource===true,true);n.el._katavorioDrop[n.el._katavorioDrop.length-1].targetDef=l}.bind(this);var o=e.length&&e.constructor!==String?e:[e];for(var l=0,u=o.length;l<u;l++){s(o[l])}return this};this.unmakeTarget=function(t,e){var n=p(t);o.destroyDroppable(n.el,"internal");if(!e){delete this.targetEndpointDefinitions[n.id]}return this};this.makeSource=function(e,n,a){var r=t.jsPlumb.extend({_jsPlumb:this},a);t.jsPlumb.extend(r,n);var s=r.connectionType||"default";var l=o.deriveEndpointAndAnchorSpec(s);r.endpoint=r.endpoint||l.endpoints[0];r.anchor=r.anchor||l.anchors[0];var u=r.maxConnections||-1,c=r.onMaxConnections,h=function(e){var n=e.id,a=this.getElement(e.el);this.sourceEndpointDefinitions[n]=this.sourceEndpointDefinitions[n]||{};ge(n);var l={def:t.jsPlumb.extend({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:u,enabled:true};this.sourceEndpointDefinitions[n][s]=l;e.def=l;var h=t.jsPlumb.dragEvents.stop,d=t.jsPlumb.dragEvents.drag,p=t.jsPlumb.extend({},r.dragOptions||{}),_=p.drag,v=p.stop,g=null,m=false;p.scope=p.scope||r.scope;p[d]=i.wrap(p[d],function(){if(_){_.apply(this,arguments)}m=false});p[h]=i.wrap(p[h],function(){if(v){v.apply(this,arguments)}this.currentlyDragging=false;if(g._jsPlumb!=null){var t=r.anchor||this.Defaults.Anchor,e=g.anchor,i=g.connections[0];var a=this.makeAnchor(t,n,this),s=g.element;if(a.positionFinder!=null){var l=o.getOffset(s),u=this.getSize(s),c={left:l.left+e.x*u[0],top:l.top+e.y*u[1]},h=a.positionFinder(c,l,u,a.constructorParams);a.x=h[0];a.y=h[1]}g.setAnchor(a,true);g.repaint();this.repaint(g.elementId);if(i!=null){this.repaint(i.targetId)}}}.bind(this));var b=function(l){if(l.which===3||l.button===2){return}var h=this.sourceEndpointDefinitions[n][s];if(!h.enabled){return}n=this.getId(this.getElement(e.el));if(r.filter){var d=i.isString(r.filter)?xe(l,e.el,r.filter,this,r.filterExclude):r.filter(l,e.el);if(d===false){return}}var _=this.select({source:n}).length;if(h.maxConnections>=0&&_>=h.maxConnections){if(c){c({element:e.el,maxConnections:u},l)}return false}var v=t.jsPlumb.getPositionOnElement(l,a,f);var b={};t.jsPlumb.extend(b,r);b.isTemporarySource=true;b.anchor=[v[0],v[1],0,0];b.dragOptions=p;if(h.def.scope){b.scope=h.def.scope}g=this.addEndpoint(n,b);m=true;g.setDeleteOnEmpty(true);if(h.uniqueEndpoint){if(!h.endpoint){h.endpoint=g;g.setDeleteOnEmpty(false)}else{g.finalEndpoint=h.endpoint}}var y=function(){o.off(g.canvas,"mouseup",y);o.off(e.el,"mouseup",y);if(m){m=false;o.deleteEndpoint(g)}};o.on(g.canvas,"mouseup",y);o.on(e.el,"mouseup",y);var P={};if(h.def.extract){for(var x in h.def.extract){var j=(l.srcElement||l.target).getAttribute(x);if(j){P[h.def.extract[x]]=j}}}o.trigger(g.canvas,"mousedown",l,P);i.consume(l)}.bind(this);this.on(e.el,"mousedown",b);l.trigger=b;if(r.filter&&(i.isString(r.filter)||i.isFunction(r.filter))){o.setDragFilter(e.el,r.filter)}var y=t.jsPlumb.extend({},r.dropOptions||{});je(e,r,y,true,r.isTarget===true)}.bind(this);var d=e.length&&e.constructor!==String?e:[e];for(var _=0,v=d.length;_<v;_++){h(p(d[_]))}return this};this.unmakeSource=function(t,e,n){var i=p(t);o.destroyDroppable(i.el,"internal");var a=this.sourceEndpointDefinitions[i.id];if(a){for(var r in a){if(e==null||e===r){var s=a[r].trigger;if(s){o.off(i.el,"mousedown",s)}if(!n){delete this.sourceEndpointDefinitions[i.id][r]}}}}return this};this.unmakeEverySource=function(){for(var t in this.sourceEndpointDefinitions){o.unmakeSource(t,null,true)}this.sourceEndpointDefinitions={};return this};var Ce=function(t,e,n){e=i.isArray(e)?e:[e];var a=q(t);n=n||"default";for(var r=0;r<e.length;r++){var s=this[e[r]][a];if(s&&s[n]){return s[n].def.scope||this.Defaults.Scope}}}.bind(this);var Ee=function(t,e,n,a){n=i.isArray(n)?n:[n];var r=q(t);a=a||"default";for(var s=0;s<n.length;s++){var o=this[n[s]][r];if(o&&o[a]){o[a].def.scope=e}}}.bind(this);this.getScope=function(t,e){return Ce(t,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(t){return Ce(t,"sourceEndpointDefinitions")};this.getTargetScope=function(t){return Ce(t,"targetEndpointDefinitions")};this.setScope=function(t,e,n){this.setSourceScope(t,e,n);this.setTargetScope(t,e,n)};this.setSourceScope=function(t,e,n){Ee(t,e,"sourceEndpointDefinitions",n);this.setDragScope(t,e)};this.setTargetScope=function(t,e,n){Ee(t,e,"targetEndpointDefinitions",n);this.setDropScope(t,e)};this.unmakeEveryTarget=function(){for(var t in this.targetEndpointDefinitions){o.unmakeTarget(t,true)}this.targetEndpointDefinitions={};return this};var we=function(t,e,n,a,r){var s=t==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,l,u,c;r=r||"default";if(e.length&&!i.isString(e)){l=[];for(var h=0,f=e.length;h<f;h++){u=p(e[h]);if(s[u.id]&&s[u.id][r]){l[h]=s[u.id][r].enabled;c=a?!l[h]:n;s[u.id][r].enabled=c;o[c?"removeClass":"addClass"](u.el,"jtk-"+t+"-disabled")}}}else{u=p(e);var d=u.id;if(s[d]&&s[d][r]){l=s[d][r].enabled;c=a?!l:n;s[d][r].enabled=c;o[c?"removeClass":"addClass"](u.el,"jtk-"+t+"-disabled")}}return l}.bind(this);var Se=function(t,e){if(i.isString(t)||!t.length){return e.apply(this,[t])}else if(t.length){return e.apply(this,[t[0]])}}.bind(this);this.toggleSourceEnabled=function(t,e){we("source",t,null,true,e);return this.isSourceEnabled(t,e)};this.setSourceEnabled=function(t,e,n){return we("source",t,e,null,n)};this.isSource=function(t,e){e=e||"default";return Se(t,function(t){var n=this.sourceEndpointDefinitions[p(t).id];return n!=null&&n[e]!=null}.bind(this))};this.isSourceEnabled=function(t,e){e=e||"default";return Se(t,function(t){var n=this.sourceEndpointDefinitions[p(t).id];return n&&n[e]&&n[e].enabled===true}.bind(this))};this.toggleTargetEnabled=function(t,e){we("target",t,null,true,e);return this.isTargetEnabled(t,e)};this.isTarget=function(t,e){e=e||"default";return Se(t,function(t){var n=this.targetEndpointDefinitions[p(t).id];return n!=null&&n[e]!=null}.bind(this))};this.isTargetEnabled=function(t,e){e=e||"default";return Se(t,function(t){var n=this.targetEndpointDefinitions[p(t).id];return n&&n[e]&&n[e].enabled===true}.bind(this))};this.setTargetEnabled=function(t,e,n){return we("target",t,e,null,n)};this.ready=function(t){o.bind("ready",t)};var De=function(t,e){if(typeof t==="object"&&t.length){for(var n=0,i=t.length;n<i;n++){e(t[n])}}else{e(t)}return o};this.repaint=function(t,e,n){return De(t,function(t){N(t,e,n)})};this.revalidate=function(t,e,n){return De(t,function(t){var i=n?t:o.getId(t);o.updateOffset({elId:i,recalc:true,timestamp:e});var a=o.getDragManager();if(a){a.updateOffsets(i)}o.repaint(t)})};this.repaintEverything=function(){var t=a(),e;for(e in j){o.updateOffset({elId:e,recalc:true,timestamp:t})}for(e in j){N(e,null,t)}return this};this.removeAllEndpoints=function(t,e,n){n=n||[];var i=function(t){var a=p(t),r=j[a.id],s,l;if(r){n.push(a);for(s=0,l=r.length;s<l;s++){o.deleteEndpoint(r[s],false)}}delete j[a.id];if(e){if(a.el&&a.el.nodeType!==3&&a.el.nodeType!==8){for(s=0,l=a.el.childNodes.length;s<l;s++){i(a.el.childNodes[s])}}}};i(t);return this};var Ie=function(t,e){o.removeAllEndpoints(t.id,true,e);var n=o.getDragManager();var i=function(t){if(n){n.elementRemoved(t.id)}o.anchorManager.clearFor(t.id);o.anchorManager.removeFloatingConnection(t.id);if(o.isSource(t.el)){o.unmakeSource(t.el)}if(o.isTarget(t.el)){o.unmakeTarget(t.el)}o.destroyDraggable(t.el);o.destroyDroppable(t.el);delete o.floatingConnections[t.id];delete E[t.id];delete w[t.id];if(t.el){o.removeElement(t.el);t.el._jsPlumb=null}};for(var a=1;a<e.length;a++){i(e[a])}i(t)};this.remove=function(t,e){var n=p(t),i=[];if(n.text){n.el.parentNode.removeChild(n.el)}else if(n.id){o.batch(function(){Ie(n,i)},e===false)}return o};this.empty=function(t,e){var n=[];var i=function(t,e){var a=p(t);if(a.text){a.el.parentNode.removeChild(a.el)}else if(a.el){while(a.el.childNodes.length>0){i(a.el.childNodes[0])}if(!e){Ie(a,n)}}};o.batch(function(){i(t,true)},e===false);return o};this.reset=function(){o.silently(function(){ve=false;o.removeAllGroups();o.removeGroupManager();o.deleteEveryEndpoint();o.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};x.length=0;if(this.doReset){this.doReset()}}.bind(this))};var Ae=function(t){if(t.canvas&&t.canvas.parentNode){t.canvas.parentNode.removeChild(t.canvas)}t.cleanup();t.destroy()};this.clear=function(){o.select().each(Ae);o.selectEndpoints().each(Ae);j={};C={}};this.setDefaultScope=function(t){M=t;return o};this.setDraggable=B;this.deriveEndpointAndAnchorSpec=function(t,e){var n=((e?"":"default ")+t).split(/[\s]/),i=null,a=null,r=null,s=null;for(var l=0;l<n.length;l++){var u=o.getType(n[l],"connection");if(u){if(u.endpoints){i=u.endpoints}if(u.endpoint){a=u.endpoint}if(u.anchors){s=u.anchors}if(u.anchor){r=u.anchor}}}return{endpoints:i?i:[a,a],anchors:s?s:[r,r]}};this.setId=function(t,e,n){var a;if(i.isString(t)){a=t}else{t=this.getElement(t);a=this.getId(t)}var r=this.getConnections({source:a,scope:"*"},true),s=this.getConnections({target:a,scope:"*"},true);e=""+e;if(!n){t=this.getElement(a);this.setAttribute(t,"id",e)}else{t=this.getElement(e)}j[e]=j[a]||[];for(var o=0,l=j[e].length;o<l;o++){j[e][o].setElementId(e);j[e][o].setReferenceElement(t)}delete j[a];this.sourceEndpointDefinitions[e]=this.sourceEndpointDefinitions[a];delete this.sourceEndpointDefinitions[a];this.targetEndpointDefinitions[e]=this.targetEndpointDefinitions[a];delete this.targetEndpointDefinitions[a];this.anchorManager.changeId(a,e);var u=this.getDragManager();if(u){u.changeId(a,e)}E[e]=E[a];delete E[a];var c=function(n,i,a){for(var r=0,s=n.length;r<s;r++){n[r].endpoints[i].setElementId(e);n[r].endpoints[i].setReferenceElement(t);n[r][a+"Id"]=e;n[r][a]=t}};c(r,0,"source");c(s,1,"target");this.repaint(e)
};this.setDebugLog=function(t){y=t};this.setSuspendDrawing=function(t,e){var n=T;T=t;if(t){k=(new Date).getTime()}else{k=null}if(e){this.repaintEverything()}return n};this.isSuspendDrawing=function(){return T};this.getSuspendedAt=function(){return k};this.batch=function(t,e){var n=this.isSuspendDrawing();if(!n){this.setSuspendDrawing(true)}try{t()}catch(a){i.log("Function run while suspended failed",a)}if(!n){this.setSuspendDrawing(false,!e)}};this.doWhileSuspended=this.batch;this.getCachedData=Z;this.timestamp=a;this.show=function(t,e){H(t,"block",e);return o};this.toggleVisible=J;this.toggleDraggable=W;this.addListener=this.bind};i.extend(t.jsPlumbInstance,i.EventGenerator,{setAttribute:function(t,e,n){this.setAttribute(t,e,n)},getAttribute:function(e,n){return this.getAttribute(t.jsPlumb.getElement(e),n)},convertToFullOverlaySpec:function(t){if(i.isString(t)){t=[t,{}]}t[1].id=t[1].id||i.uuid();return t},registerConnectionType:function(e,n){this._connectionTypes[e]=t.jsPlumb.extend({},n);if(n.overlays){var i={};for(var a=0;a<n.overlays.length;a++){var r=this.convertToFullOverlaySpec(n.overlays[a]);i[r[1].id]=r}this._connectionTypes[e].overlays=i}},registerConnectionTypes:function(t){for(var e in t){this.registerConnectionType(e,t[e])}},registerEndpointType:function(e,n){this._endpointTypes[e]=t.jsPlumb.extend({},n);if(n.overlays){var i={};for(var a=0;a<n.overlays.length;a++){var r=this.convertToFullOverlaySpec(n.overlays[a]);i[r[1].id]=r}this._endpointTypes[e].overlays=i}},registerEndpointTypes:function(t){for(var e in t){this.registerEndpointType(e,t[e])}},getType:function(t,e){return e==="connection"?this._connectionTypes[t]:this._endpointTypes[t]},setIdChanged:function(t,e){this.setId(t,e,true)},setParent:function(t,e){var n=this.getElement(t),i=this.getId(n),a=this.getElement(e),r=this.getId(a),s=this.getDragManager();n.parentNode.removeChild(n);a.appendChild(n);if(s){s.setParent(n,i,a,r)}},extend:function(t,e,n){var i;if(n){for(i=0;i<n.length;i++){t[n[i]]=e[n[i]]}}else{for(i in e){t[i]=e[i]}}return t},floatingConnections:{},getFloatingAnchorIndex:function(t){return t.endpoints[0].isFloating()?0:t.endpoints[1].isFloating()?1:-1}});g.prototype.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:false,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:false,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};var m=new g;t.jsPlumb=m;m.getInstance=function(t,e){var n=new g(t);if(e){for(var i in e){n[i]=e[i]}}n.init();return n};m.each=function(t,e){if(t==null){return}if(typeof t==="string"){e(m.getElement(t))}else if(t.length!=null){for(var n=0;n<t.length;n++){e(m.getElement(t[n]))}}else{e(t)}};if(typeof exports!=="undefined"){exports.jsPlumb=m}}).call(typeof window!=="undefined"?window:this);(function(){var t=this,e=t.jsPlumbUtil;var n=function(t,e){if(e==null){return[0,0]}var n=o(e),i=s(n,0);return[i[t+"X"],i[t+"Y"]]},i=n.bind(this,"page"),a=n.bind(this,"screen"),r=n.bind(this,"client"),s=function(t,e){return t.item?t.item(e):t[e]},o=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]};var l=function(t){var e={},n=[],i={},a={},r={};this.register=function(s){var o=t.getId(s),l=t.getOffset(s);if(!e[o]){e[o]=s;n.push(s);i[o]={}}var u=function(e){if(e){for(var n=0;n<e.childNodes.length;n++){if(e.childNodes[n].nodeType!==3&&e.childNodes[n].nodeType!==8){var s=jsPlumb.getElement(e.childNodes[n]),c=t.getId(e.childNodes[n],null,true);if(c&&a[c]&&a[c]>0){var h=t.getOffset(s);i[o][c]={id:c,offset:{left:h.left-l.left,top:h.top-l.top}};r[c]=o}u(e.childNodes[n])}}}};u(s)};this.updateOffsets=function(e,n){if(e!=null){n=n||{};var a=jsPlumb.getElement(e),s=t.getId(a),o=i[s],l=t.getOffset(a);if(o){for(var u in o){if(o.hasOwnProperty(u)){var c=jsPlumb.getElement(u),h=n[u]||t.getOffset(c);if(c.offsetParent==null&&i[s][u]!=null){continue}i[s][u]={id:u,offset:{left:h.left-l.left,top:h.top-l.top}};r[u]=s}}}}};this.endpointAdded=function(n,s){s=s||t.getId(n);var o=document.body,l=n.parentNode;a[s]=a[s]?a[s]+1:1;while(l!=null&&l!==o){var u=t.getId(l,null,true);if(u&&e[u]){var c=t.getOffset(l);if(i[u][s]==null){var h=t.getOffset(n);i[u][s]={id:s,offset:{left:h.left-c.left,top:h.top-c.top}};r[s]=u}break}l=l.parentNode}};this.endpointDeleted=function(t){if(a[t.elementId]){a[t.elementId]--;if(a[t.elementId]<=0){for(var e in i){if(i.hasOwnProperty(e)&&i[e]){delete i[e][t.elementId];delete r[t.elementId]}}}}};this.changeId=function(t,e){i[e]=i[t];i[t]={};r[e]=r[t];r[t]=null};this.getElementsForDraggable=function(t){return i[t]};this.elementRemoved=function(t){var e=r[t];if(e){delete i[e][t];delete r[t]}};this.reset=function(){e={};n=[];i={};a={}};this.dragEnded=function(e){if(e.offsetParent!=null){var n=t.getId(e),i=r[n];if(i){this.updateOffsets(i)}}};this.setParent=function(e,n,a,s,o){var l=r[n];if(!i[s]){i[s]={}}var u=t.getOffset(a),c=o||t.getOffset(e);if(l&&i[l]){delete i[l][n]}i[s][n]={id:n,offset:{left:c.left-u.left,top:c.top-u.top}};r[n]=s};this.clearParent=function(t,e){var n=r[e];if(n){delete i[n][e];delete r[e]}};this.revalidateParent=function(e,n,i){var a=r[n];if(a){var s={};s[n]=i;this.updateOffsets(a,s);t.revalidate(a)}};this.getDragAncestor=function(e){var n=jsPlumb.getElement(e),i=t.getId(n),a=r[i];if(a){return jsPlumb.getElement(a)}else{return null}}};var u=function(t){return t==null?null:t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},c=function(t,e){e=u(e);if(typeof t.className.baseVal!=="undefined"){t.className.baseVal=e}else{t.className=e}},h=function(t){return typeof t.className.baseVal==="undefined"?t.className:t.className.baseVal},f=function(t,n,i){n=n==null?[]:e.isArray(n)?n:n.split(/\s+/);i=i==null?[]:e.isArray(i)?i:i.split(/\s+/);var a=h(t),r=a.split(/\s+/);var s=function(t,e){for(var n=0;n<e.length;n++){if(t){if(r.indexOf(e[n])===-1){r.push(e[n])}}else{var i=r.indexOf(e[n]);if(i!==-1){r.splice(i,1)}}}};s(true,n);s(false,i);c(t,r.join(" "))};t.jsPlumb.extend(t.jsPlumbInstance.prototype,{headless:false,pageLocation:i,screenLocation:a,clientLocation:r,getDragManager:function(){if(this.dragManager==null){this.dragManager=new l(this)}return this.dragManager},recalculateOffsets:function(t){this.getDragManager().updateOffsets(t)},createElement:function(t,e,n,i){return this.createElementNS(null,t,e,n,i)},createElementNS:function(t,e,n,i,a){var r=t==null?document.createElement(e):document.createElementNS(t,e);var s;n=n||{};for(s in n){r.style[s]=n[s]}if(i){r.className=i}a=a||{};for(s in a){r.setAttribute(s,""+a[s])}return r},getAttribute:function(t,e){return t.getAttribute!=null?t.getAttribute(e):null},setAttribute:function(t,e,n){if(t.setAttribute!=null){t.setAttribute(e,n)}},setAttributes:function(t,e){for(var n in e){if(e.hasOwnProperty(n)){t.setAttribute(n,e[n])}}},appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["svg"]},getClass:h,addClass:function(t,e){jsPlumb.each(t,function(t){f(t,e)})},hasClass:function(t,e){t=jsPlumb.getElement(t);if(t.classList){return t.classList.contains(e)}else{return h(t).indexOf(e)!==-1}},removeClass:function(t,e){jsPlumb.each(t,function(t){f(t,null,e)})},updateClasses:function(t,e,n){jsPlumb.each(t,function(t){f(t,e,n)})},setClass:function(t,e){jsPlumb.each(t,function(t){c(t,e)})},setPosition:function(t,e){t.style.left=e.left+"px";t.style.top=e.top+"px"},getPosition:function(t){var e=function(e){var n=t.style[e];return n?n.substring(0,n.length-2):0};return{left:e("left"),top:e("top")}},getStyle:function(t,e){if(typeof window.getComputedStyle!=="undefined"){return getComputedStyle(t,null).getPropertyValue(e)}else{return t.currentStyle[e]}},getSelector:function(t,e){var n=null;if(arguments.length===1){n=t.nodeType!=null?t:document.querySelectorAll(t)}else{n=t.querySelectorAll(e)}return n},getOffset:function(t,e,n){t=jsPlumb.getElement(t);n=n||this.getContainer();var i={left:t.offsetLeft,top:t.offsetTop},a=e||n!=null&&(t!==n&&t.offsetParent!==n)?t.offsetParent:null,r=function(t){if(t!=null&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)){i.left-=t.scrollLeft;i.top-=t.scrollTop}}.bind(this);while(a!=null){i.left+=a.offsetLeft;i.top+=a.offsetTop;r(a);a=e?a.offsetParent:a.offsetParent===n?null:a.offsetParent}if(n!=null&&!e&&(n.scrollTop>0||n.scrollLeft>0)){var s=t.offsetParent!=null?this.getStyle(t.offsetParent,"position"):"static",o=this.getStyle(t,"position");if(o!=="absolute"&&o!=="fixed"&&s!=="absolute"&&s!=="fixed"){i.left-=n.scrollLeft;i.top-=n.scrollTop}}return i},getPositionOnElement:function(t,e,n){var i=typeof e.getBoundingClientRect!=="undefined"?e.getBoundingClientRect():{left:0,top:0,width:0,height:0},a=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||a.scrollTop,o=window.pageXOffset||r.scrollLeft||a.scrollLeft,l=r.clientTop||a.clientTop||0,u=r.clientLeft||a.clientLeft||0,c=0,h=0,f=i.top+s-l+c*n,d=i.left+o-u+h*n,p=jsPlumb.pageLocation(t),_=i.width||e.offsetWidth*n,v=i.height||e.offsetHeight*n,g=(p[0]-d)/_,m=(p[1]-f)/v;return[g,m]},getAbsolutePosition:function(t){var e=function(e){var n=t.style[e];if(n){return parseFloat(n.substring(0,n.length-2))}};return[e("left"),e("top")]},setAbsolutePosition:function(t,e,n,i){if(n){this.animate(t,{left:"+="+(e[0]-n[0]),top:"+="+(e[1]-n[1])},i)}else{t.style.left=e[0]+"px";t.style.top=e[1]+"px"}},getSize:function(t){return[t.offsetWidth,t.offsetHeight]},getWidth:function(t){return t.offsetWidth},getHeight:function(t){return t.offsetHeight},getRenderMode:function(){return"svg"}})}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i="__label",a=function(t,n){var a={cssClass:n.cssClass,labelStyle:t.labelStyle,id:i,component:t,_jsPlumb:t._jsPlumb.instance},r=e.extend(a,n);return new(e.Overlays[t._jsPlumb.instance.getRenderMode()].Label)(r)},r=function(t,i){var a=null;if(n.isArray(i)){var r=i[0],s=e.extend({component:t,_jsPlumb:t._jsPlumb.instance},i[1]);if(i.length===3){e.extend(s,i[2])}a=new(e.Overlays[t._jsPlumb.instance.getRenderMode()][r])(s)}else if(i.constructor===String){a=new(e.Overlays[t._jsPlumb.instance.getRenderMode()][i])({component:t,_jsPlumb:t._jsPlumb.instance})}else{a=i}a.id=a.id||n.uuid();t.cacheTypeItem("overlay",a,a.id);t._jsPlumb.overlays[a.id]=a;return a};e.OverlayCapableJsPlumbUIComponent=function(e){t.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};if(e.label){this.getDefaultType().overlays[i]=["Label",{label:e.label,location:e.labelLocation||this.defaultLabelLocation||.5,labelStyle:e.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:i}]}this.setListenerComponent=function(t){if(this._jsPlumb){for(var e in this._jsPlumb.overlays){this._jsPlumb.overlays[e].setListenerComponent(t)}}}};e.OverlayCapableJsPlumbUIComponent.applyType=function(t,e){if(e.overlays){var n={},i;for(i in e.overlays){var a=t._jsPlumb.overlays[e.overlays[i][1].id];if(a){a.updateFrom(e.overlays[i][1]);n[e.overlays[i][1].id]=true}else{var r=t.getCachedTypeItem("overlay",e.overlays[i][1].id);if(r!=null){r.reattach(t._jsPlumb.instance);r.setVisible(true);r.updateFrom(e.overlays[i][1]);t._jsPlumb.overlays[r.id]=r}else{r=t.addOverlay(e.overlays[i],true)}n[r.id]=true}}for(i in t._jsPlumb.overlays){if(n[t._jsPlumb.overlays[i].id]==null){t.removeOverlay(t._jsPlumb.overlays[i].id,true)}}}};n.extend(e.OverlayCapableJsPlumbUIComponent,t.jsPlumbUIComponent,{setHover:function(t,e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){for(var n in this._jsPlumb.overlays){this._jsPlumb.overlays[n][t?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)}}},addOverlay:function(t,e){var n=r(this,t);if(!e){this.repaint()}return n},getOverlay:function(t){return this._jsPlumb.overlays[t]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(t){var e=this.getOverlay(t);if(e){e.hide()}},hideOverlays:function(){for(var t in this._jsPlumb.overlays){this._jsPlumb.overlays[t].hide()}},showOverlay:function(t){var e=this.getOverlay(t);if(e){e.show()}},showOverlays:function(){for(var t in this._jsPlumb.overlays){this._jsPlumb.overlays[t].show()}},removeAllOverlays:function(t){for(var e in this._jsPlumb.overlays){if(this._jsPlumb.overlays[e].cleanup){this._jsPlumb.overlays[e].cleanup()}}this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;if(!t){this.repaint()}},removeOverlay:function(t,e){var n=this._jsPlumb.overlays[t];if(n){n.setVisible(false);if(!e&&n.cleanup){n.cleanup()}delete this._jsPlumb.overlays[t];if(this._jsPlumb.overlayPositions){delete this._jsPlumb.overlayPositions[t]}}},removeOverlays:function(){for(var t=0,e=arguments.length;t<e;t++){this.removeOverlay(arguments[t])}},moveParent:function(t){if(this.bgCanvas){this.bgCanvas.parentNode.removeChild(this.bgCanvas);t.appendChild(this.bgCanvas)}if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas);t.appendChild(this.canvas);for(var e in this._jsPlumb.overlays){if(this._jsPlumb.overlays[e].isAppendedAtTopLevel){var n=this._jsPlumb.overlays[e].getElement();n.parentNode.removeChild(n);t.appendChild(n)}}}},getLabel:function(){var t=this.getOverlay(i);return t!=null?t.getLabel():null},getLabelOverlay:function(){return this.getOverlay(i)},setLabel:function(t){var e=this.getOverlay(i);if(!e){var n=t.constructor===String||t.constructor===Function?{label:t}:t;e=a(this,n);this._jsPlumb.overlays[i]=e}else{if(t.constructor===String||t.constructor===Function){e.setLabel(t)}else{if(t.label){e.setLabel(t.label)}if(t.location){e.setLocation(t.location)}}}if(!this._jsPlumb.instance.isSuspendDrawing()){this.repaint()}},cleanup:function(t){for(var e in this._jsPlumb.overlays){this._jsPlumb.overlays[e].cleanup(t);this._jsPlumb.overlays[e].destroy(t)}if(t){this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null}},setVisible:function(t){this[t?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(t,e){this._jsPlumb.overlayPositions[t.id]=e},getAbsoluteOverlayPosition:function(t){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[t.id]:null},_clazzManip:function(t,e,n){if(!n){for(var i in this._jsPlumb.overlays){this._jsPlumb.overlays[i][t+"Class"](e)}}},addClass:function(t,e){this._clazzManip("add",t,e)},removeClass:function(t,e){this._clazzManip("remove",t,e)}})}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i=function(t,e,n){var i=false;return{drag:function(){if(i){i=false;return true}if(e.element){var a=n.getUIPosition(arguments,n.getZoom());if(a!=null){n.setPosition(e.element,a)}n.repaint(e.element,a);t.paint({anchorPoint:t.anchor.getCurrentLocation({element:t})})}},stopDrag:function(){i=true}}};var a=function(t,e,n,i){var a=e.createElement("div",{position:"absolute"});e.appendElement(a);var r=e.getId(a);e.setPosition(a,n);a.style.width=i[0]+"px";a.style.height=i[1]+"px";e.manage(r,a,true);t.id=r;t.element=a};var r=function(t,n,i,a,r,s,o,l){var u=new e.FloatingAnchor({reference:n,referenceCanvas:a,jsPlumbInstance:s});return o({paintStyle:t,endpoint:i,anchor:u,source:r,scope:l})};var s=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];var o=function(t,e){var n=0;if(e!=null){for(var i=0;i<t.connections.length;i++){if(t.connections[i].sourceId===e||t.connections[i].targetId===e){n=i;break}}}return t.connections[n]};e.Endpoint=function(t){var l=t._jsPlumb,u=t.newConnection,c=t.newEndpoint;this.idPrefix="_jsplumb_e_";this.defaultLabelLocation=[.5,.5];this.defaultOverlayKeys=["Overlays","EndpointOverlays"];e.OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.appendToDefaultType({connectionType:t.connectionType,maxConnections:t.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:t.maxConnections,paintStyle:t.endpointStyle||t.paintStyle||t.style||this._jsPlumb.instance.Defaults.EndpointStyle||e.Defaults.EndpointStyle,hoverPaintStyle:t.endpointHoverStyle||t.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle,connectorStyle:t.connectorStyle,connectorHoverStyle:t.connectorHoverStyle,connectorClass:t.connectorClass,connectorHoverClass:t.connectorHoverClass,connectorOverlays:t.connectorOverlays,connector:t.connector,connectorTooltip:t.connectorTooltip});this._jsPlumb.enabled=!(t.enabled===false);this._jsPlumb.visible=true;this.element=e.getElement(t.source);this._jsPlumb.uuid=t.uuid;this._jsPlumb.floatingEndpoint=null;var h=null;if(this._jsPlumb.uuid){t.endpointsByUUID[this._jsPlumb.uuid]=this}this.elementId=t.elementId;this.dragProxy=t.dragProxy;this._jsPlumb.connectionCost=t.connectionCost;this._jsPlumb.connectionsDirected=t.connectionsDirected;this._jsPlumb.currentAnchorClass="";this._jsPlumb.events={};var f=t.deleteOnEmpty===true;this.setDeleteOnEmpty=function(t){f=t};var d=function(){var t=l.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var n=l.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(t);this.addClass(n);e.updateClasses(this.element,n,t)}.bind(this);this.prepareAnchor=function(t){var e=this._jsPlumb.instance.makeAnchor(t,this.elementId,l);e.bind("anchorChanged",function(t){this.fire("anchorChanged",{endpoint:this,anchor:t});d()}.bind(this));return e};this.setPreparedAnchor=function(t,e){this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);this.anchor=t;d();if(!e){this._jsPlumb.instance.repaint(this.elementId)}return this};this.setAnchor=function(t,e){var n=this.prepareAnchor(t);this.setPreparedAnchor(n,e);return this};var p=function(t){if(this.connections.length>0){for(var e=0;e<this.connections.length;e++){this.connections[e].setHover(t,false)}}else{this.setHover(t)}}.bind(this);this.bind("mouseover",function(){p(true)});this.bind("mouseout",function(){p(false)});if(!t._transient){this._jsPlumb.instance.anchorManager.add(this,this.elementId)}this.prepareEndpoint=function(i,a){var r=function(t,n){var i=l.getRenderMode();if(e.Endpoints[i][t]){return new e.Endpoints[i][t](n)}if(!l.Defaults.DoNotThrowErrors){throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"}}};var s={_jsPlumb:this._jsPlumb.instance,cssClass:t.cssClass,container:t.container,tooltip:t.tooltip,connectorTooltip:t.connectorTooltip,endpoint:this};var o;if(n.isString(i)){o=r(i,s)}else if(n.isArray(i)){s=n.merge(i[1],s);o=r(i[0],s)}else{o=i.clone()}o.clone=function(){if(n.isString(i)){return r(i,s)}else if(n.isArray(i)){s=n.merge(i[1],s);return r(i[0],s)}}.bind(this);o.typeId=a;return o};this.setEndpoint=function(t,e){var n=this.prepareEndpoint(t);this.setPreparedEndpoint(n,true)};this.setPreparedEndpoint=function(t,e){if(this.endpoint!=null){this.endpoint.cleanup();this.endpoint.destroy()}this.endpoint=t;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas};e.extend(this,t,s);this.isSource=t.isSource||false;this.isTemporarySource=t.isTemporarySource||false;this.isTarget=t.isTarget||false;this.connections=t.connections||[];this.connectorPointerEvents=t["connector-pointer-events"];this.scope=t.scope||l.getDefaultScope();this.timestamp=null;this.reattachConnections=t.reattach||l.Defaults.ReattachConnections;this.connectionsDetachable=l.Defaults.ConnectionsDetachable;if(t.connectionsDetachable===false||t.detachable===false){this.connectionsDetachable=false}this.dragAllowedWhenFull=t.dragAllowedWhenFull!==false;if(t.onMaxConnections){this.bind("maxConnections",t.onMaxConnections)}this.addConnection=function(t){this.connections.push(t);this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)};this.detachFromConnection=function(t,e,n){e=e==null?this.connections.indexOf(t):e;if(e>=0){this.connections.splice(e,1);this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)}if(!n&&f&&this.connections.length===0){l.deleteObject({endpoint:this,fireEvent:false,deleteAttachedObjects:n!==true})}};this.deleteEveryConnection=function(t){var e=this.connections.length;for(var n=0;n<e;n++){l.deleteConnection(this.connections[0],t)}};this.detachFrom=function(t,e,n){var i=[];for(var a=0;a<this.connections.length;a++){if(this.connections[a].endpoints[1]===t||this.connections[a].endpoints[0]===t){i.push(this.connections[a])}}for(var r=0,s=i.length;r<s;r++){l.deleteConnection(i[0])}return this};this.getElement=function(){return this.element};this.setElement=function(i){var a=this._jsPlumb.instance.getId(i),r=this.elementId;n.removeWithFunction(t.endpointsByElement[this.elementId],function(t){return t.id===this.id}.bind(this));this.element=e.getElement(i);this.elementId=l.getId(this.element);l.anchorManager.rehomeEndpoint(this,r,this.element);l.dragManager.endpointAdded(this.element);n.addToList(t.endpointsByElement,a,this);return this};this.makeInPlaceCopy=function(){var e=this.anchor.getCurrentLocation({element:this}),n=this.anchor.getOrientation(this),i=this.anchor.getCssClass(),a={bind:function(){},compute:function(){return[e[0],e[1]]},getCurrentLocation:function(){return[e[0],e[1]]},getOrientation:function(){return n},getCssClass:function(){return i}};return c({dropOptions:t.dropOptions,anchor:a,source:this.element,paintStyle:this.getPaintStyle(),endpoint:t.hideOnDrag?"Blank":this.endpoint,_transient:true,scope:this.scope,reference:this})};this.connectorSelector=function(){var t=this.connections[0];if(t){return t}else{return this.connections.length<this._jsPlumb.maxConnections||this._jsPlumb.maxConnections===-1?null:t}};this.setStyle=this.setPaintStyle;this.paint=function(t){t=t||{};var e=t.timestamp,n=!(t.recalc===false);if(!e||this.timestamp!==e){var i=l.updateOffset({elId:this.elementId,timestamp:e});var a=t.offset?t.offset.o:i.o;if(a!=null){var r=t.anchorPoint,s=t.connectorPaintStyle;if(r==null){var u=t.dimensions||i.s,c={xy:[a.left,a.top],wh:u,element:this,timestamp:e};if(n&&this.anchor.isDynamic&&this.connections.length>0){var h=o(this,t.elementWithPrecedence),f=h.endpoints[0]===this?1:0,d=f===0?h.sourceId:h.targetId,p=l.getCachedData(d),_=p.o,v=p.s;c.txy=[_.left,_.top];c.twh=v;c.tElement=h.endpoints[f]}r=this.anchor.compute(c)}this.endpoint.compute(r,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,s||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=e;for(var g in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(g)){var m=this._jsPlumb.overlays[g];if(m.isVisible()){this._jsPlumb.overlayPlacements[g]=m.draw(this.endpoint,this._jsPlumb.paintStyleInUse);m.paint(this._jsPlumb.overlayPlacements[g])}}}}}};this.getTypeDescriptor=function(){return"endpoint"};this.isVisible=function(){return this._jsPlumb.visible};this.repaint=this.paint;var _=false;this.initDraggable=function(){if(!_&&e.isDragSupported(this.element)){var s={id:null,element:null},o=null,f=false,d=null,p=i(this,s,l),v=t.dragOptions||{},g={},m=e.dragEvents.start,b=e.dragEvents.stop,y=e.dragEvents.drag,P=e.dragEvents.beforeStart,x;var j=function(t){x=t.e.payload||{}};var C=function(i){o=this.connectorSelector();var h=true;if(!this.isEnabled()){h=false}if(o==null&&!this.isSource&&!this.isTemporarySource){h=false}if(this.isSource&&this.isFull()&&!(o!=null&&this.dragAllowedWhenFull)){h=false}if(o!=null&&!o.isDetachable(this)){h=false}var _=l.checkCondition(o==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:o});if(_===false){h=false}else if(typeof _==="object"){e.extend(_,x||{})}else{_=x||{}}if(h===false){if(l.stopDrag){l.stopDrag(this.canvas)}p.stopDrag();return false}for(var v=0;v<this.connections.length;v++){this.connections[v].setHover(false)}this.addClass("endpointDrag");l.setConnectionBeingDragged(true);if(o&&!this.isFull()&&this.isSource){o=null}l.updateOffset({elId:this.elementId});var g=this._jsPlumb.instance.getOffset(this.canvas),m=this.canvas,b=this._jsPlumb.instance.getSize(this.canvas);a(s,l,g,b);l.setAttributes(this.canvas,{dragId:s.id,elId:this.elementId});var y=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var P=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);if(P.endpoints[1]){y=P.endpoints[1]}}var j=this._jsPlumb.instance.makeAnchor("Center");j.isFloating=true;this._jsPlumb.floatingEndpoint=r(this.getPaintStyle(),j,y,this.canvas,s.element,l,c,this.scope);var C=this._jsPlumb.floatingEndpoint.anchor;if(o==null){this.setHover(false,false);o=u({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:s.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:t.connectorStyle,hoverPaintStyle:t.connectorHoverStyle,connector:t.connector,overlays:t.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:t.scope,data:_});o.pending=true;o.addClass(l.draggingClass);this._jsPlumb.floatingEndpoint.addClass(l.draggingClass);this._jsPlumb.floatingEndpoint.anchor=C;l.fire("connectionDrag",o);l.anchorManager.newConnection(o)}else{f=true;o.setHover(false);var E=o.endpoints[0].id===this.id?0:1;this.detachFromConnection(o,null,true);var w=l.getDragScope(m);l.setAttribute(this.canvas,"originalScope",w);l.fire("connectionDrag",o);if(E===0){d=[o.source,o.sourceId,m,w];l.anchorManager.sourceChanged(o.endpoints[E].elementId,s.id,o,s.element)}else{d=[o.target,o.targetId,m,w];o.target=s.element;o.targetId=s.id;l.anchorManager.updateOtherEndpoint(o.sourceId,o.endpoints[E].elementId,o.targetId,o)}o.suspendedEndpoint=o.endpoints[E];o.suspendedElement=o.endpoints[E].getElement();o.suspendedElementId=o.endpoints[E].elementId;o.suspendedElementType=E===0?"source":"target";o.suspendedEndpoint.setHover(false);this._jsPlumb.floatingEndpoint.referenceEndpoint=o.suspendedEndpoint;o.endpoints[E]=this._jsPlumb.floatingEndpoint;o.addClass(l.draggingClass);this._jsPlumb.floatingEndpoint.addClass(l.draggingClass)}l.floatingConnections[s.id]=o;n.addToList(t.endpointsByElement,s.id,this._jsPlumb.floatingEndpoint);l.currentlyDragging=true}.bind(this);var E=function(){l.setConnectionBeingDragged(false);if(o&&o.endpoints!=null){var t=l.getDropEvent(arguments);var e=l.getFloatingAnchorIndex(o);o.endpoints[e===0?1:0].anchor.locked=false;o.removeClass(l.draggingClass);if(this._jsPlumb&&(o.deleteConnectionNow||o.endpoints[e]===this._jsPlumb.floatingEndpoint)){if(f&&o.suspendedEndpoint){if(e===0){o.floatingElement=o.source;o.floatingId=o.sourceId;o.floatingEndpoint=o.endpoints[0];o.floatingIndex=0;o.source=d[0];o.sourceId=d[1]}else{o.floatingElement=o.target;o.floatingId=o.targetId;o.floatingEndpoint=o.endpoints[1];o.floatingIndex=1;o.target=d[0];o.targetId=d[1]}var n=this._jsPlumb.floatingEndpoint;l.setDragScope(d[2],d[3]);o.endpoints[e]=o.suspendedEndpoint;if(o.isReattach()||o._forceReattach||o._forceDetach||!l.deleteConnection(o)){o.setHover(false);o._forceDetach=null;o._forceReattach=null;this._jsPlumb.floatingEndpoint.detachFromConnection(o);o.suspendedEndpoint.addConnection(o);if(e===1){l.anchorManager.updateOtherEndpoint(o.sourceId,o.floatingId,o.targetId,o)}else{l.anchorManager.sourceChanged(o.floatingId,o.sourceId,o,o.source)}l.repaint(d[1])}else{l.deleteObject({endpoint:n})}}}if(this.deleteAfterDragStop){l.deleteObject({endpoint:this})}else{if(this._jsPlumb){this.paint({recalc:false})}}l.fire("connectionDragStop",o,t);if(o.pending){l.fire("connectionAborted",o,t)}l.currentlyDragging=false;o.suspendedElement=null;o.suspendedEndpoint=null;o=null}if(s&&s.element){l.remove(s.element,false,false)}if(h){l.deleteObject({endpoint:h})}if(this._jsPlumb){this.canvas.style.visibility="visible";this.anchor.locked=false;this._jsPlumb.floatingEndpoint=null}}.bind(this);v=e.extend(g,v);v.scope=this.scope||v.scope;v[P]=n.wrap(v[P],j,false);v[m]=n.wrap(v[m],C,false);v[y]=n.wrap(v[y],p.drag);v[b]=n.wrap(v[b],E);v.multipleDrop=false;v.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this);l.initDraggable(this.canvas,v,"internal");this.canvas._jsPlumbRelatedElement=this.element;_=true}};var v=t.endpoint||this._jsPlumb.instance.Defaults.Endpoint||e.Defaults.Endpoint;this.setEndpoint(v,true);var g=t.anchor?t.anchor:t.anchors?t.anchors:l.Defaults.Anchor||"Top";this.setAnchor(g,true);var m=["default",t.type||""].join(" ");this.addType(m,t.data,true);this.canvas=this.endpoint.canvas;this.canvas._jsPlumb=this;this.initDraggable();var b=function(i,a,r,s){if(e.isDropSupported(this.element)){var o=t.dropOptions||l.Defaults.DropOptions||e.Defaults.DropOptions;o=e.extend({},o);o.scope=o.scope||this.scope;var u=e.dragEvents.drop,c=e.dragEvents.over,h=e.dragEvents.out,f=this,d=l.EndpointDropHandler({getEndpoint:function(){return f},jsPlumb:l,enabled:function(){return r!=null?r.isEnabled():true},isFull:function(){return r.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(t){f.addClass(t)},removeClass:function(t){f.removeClass(t)},isDropAllowed:function(){return f.isDropAllowed.apply(f,arguments)},reference:s,isRedrop:function(t,e){return t.suspendedEndpoint&&e.reference&&t.suspendedEndpoint.id===e.reference.id}});o[u]=n.wrap(o[u],d,true);o[c]=n.wrap(o[c],function(){var t=e.getDragObject(arguments),n=l.getAttribute(e.getElement(t),"dragId"),i=l.floatingConnections[n];if(i!=null){var a=l.getFloatingAnchorIndex(i);var r=this.isTarget&&a!==0||i.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===i.suspendedEndpoint.id;if(r){var s=l.checkCondition("checkDropAllowed",{sourceEndpoint:i.endpoints[a],targetEndpoint:this,connection:i});this[(s?"add":"remove")+"Class"](l.endpointDropAllowedClass);this[(s?"remove":"add")+"Class"](l.endpointDropForbiddenClass);i.endpoints[a].anchor.over(this.anchor,this)}}}.bind(this));o[h]=n.wrap(o[h],function(){var t=e.getDragObject(arguments),n=t==null?null:l.getAttribute(e.getElement(t),"dragId"),i=n?l.floatingConnections[n]:null;if(i!=null){var a=l.getFloatingAnchorIndex(i);var r=this.isTarget&&a!==0||i.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===i.suspendedEndpoint.id;if(r){this.removeClass(l.endpointDropAllowedClass);this.removeClass(l.endpointDropForbiddenClass);i.endpoints[a].anchor.out()}}}.bind(this));l.initDroppable(i,o,"internal",a)}}.bind(this);if(!this.anchor.isFloating){b(this.canvas,!(t._transient||this.anchor.isFloating),this,t.reference)}return this};n.extend(e.Endpoint,e.OverlayCapableJsPlumbUIComponent,{setVisible:function(t,e,n){this._jsPlumb.visible=t;if(this.canvas){this.canvas.style.display=t?"block":"none"}this[t?"showOverlays":"hideOverlays"]();if(!e){for(var i=0;i<this.connections.length;i++){this.connections[i].setVisible(t);if(!n){var a=this===this.connections[i].endpoints[0]?1:0;if(this.connections[i].endpoints[a].connections.length===1){this.connections[i].endpoints[a].setVisible(t,true,true)}}}}},getAttachedElements:function(){return this.connections},applyType:function(t,n){this.setPaintStyle(t.endpointStyle||t.paintStyle,n);this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,n);if(t.maxConnections!=null){this._jsPlumb.maxConnections=t.maxConnections}if(t.scope){this.scope=t.scope}e.extend(this,t,s);if(t.cssClass!=null&&this.canvas){this._jsPlumb.instance.addClass(this.canvas,t.cssClass)}e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled
},setEnabled:function(t){this._jsPlumb.enabled=t},cleanup:function(){var t=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");e.removeClass(this.element,t);this.anchor=null;this.endpoint.cleanup(true);this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(t){if(this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.endpoint.setHover(t)}},isFull:function(){return this._jsPlumb.maxConnections===0?true:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(t){var e=false;if(t){for(var n=0;n<this.connections.length;n++){if(this.connections[n].endpoints[1]===t||this.connections[n].endpoints[0]===t){e=true;break}}}return e},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(t){this._jsPlumb.connectionCost=t},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(t){this._jsPlumb.connectionsDirected=t},setElementId:function(t){this.elementId=t;this.anchor.elementId=t},setReferenceElement:function(t){this.element=e.getElement(t)},setDragAllowedWhenFull:function(t){this.dragAllowedWhenFull=t},equals:function(t){return this.anchor.equals(t.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(t){return this.anchor.compute(t)}});t.jsPlumbInstance.prototype.EndpointDropHandler=function(t){return function(e){var i=t.jsPlumb;t.removeClass(i.endpointDropAllowedClass);t.removeClass(i.endpointDropForbiddenClass);var a=i.getDropEvent(arguments),r=i.getDragObject(arguments),s=i.getAttribute(r,"dragId"),o=i.getAttribute(r,"elId"),l=i.getAttribute(r,"originalScope"),u=i.floatingConnections[s];if(u==null){return}var c=u.suspendedEndpoint!=null;if(c&&u.suspendedEndpoint._jsPlumb==null){return}var h=t.getEndpoint(u);if(h==null){return}if(t.isRedrop(u,t)){u._forceReattach=true;u.setHover(false);if(t.maybeCleanup){t.maybeCleanup(h)}return}var f=i.getFloatingAnchorIndex(u);if(f==-1){if(t.maybeCleanup){t.maybeCleanup(h)}return}if(f===0&&!t.isSource||f===1&&!t.isTarget){if(t.maybeCleanup){t.maybeCleanup(h)}return}if(t.onDrop){t.onDrop(u)}if(l){i.setDragScope(r,l)}var d=t.isFull(e);if(d){h.fire("maxConnections",{endpoint:this,connection:u,maxConnections:h._jsPlumb.maxConnections},a)}if(!d&&t.enabled()){var p=true;if(f===0){u.floatingElement=u.source;u.floatingId=u.sourceId;u.floatingEndpoint=u.endpoints[0];u.floatingIndex=0;u.source=t.element;u.sourceId=t.elementId}else{u.floatingElement=u.target;u.floatingId=u.targetId;u.floatingEndpoint=u.endpoints[1];u.floatingIndex=1;u.target=t.element;u.targetId=t.elementId}if(c&&u.suspendedEndpoint.id!==h.id){if(!u.isDetachAllowed(u)||!u.endpoints[f].isDetachAllowed(u)||!u.suspendedEndpoint.isDetachAllowed(u)||!i.checkCondition("beforeDetach",u)){p=false}}var _=function(e){u.endpoints[f].detachFromConnection(u);if(u.suspendedEndpoint){u.suspendedEndpoint.detachFromConnection(u)}u.endpoints[f]=h;h.addConnection(u);var r=h.getParameters();for(var s in r){u.setParameter(s,r[s])}if(!c){if(r.draggable){i.initDraggable(this.element,t.dragOptions,"internal",i)}}else{var o=u.suspendedEndpoint.elementId;i.fireMoveEvent({index:f,originalSourceId:f===0?o:u.sourceId,newSourceId:f===0?h.elementId:u.sourceId,originalTargetId:f===1?o:u.targetId,newTargetId:f===1?h.elementId:u.targetId,originalSourceEndpoint:f===0?u.suspendedEndpoint:u.endpoints[0],newSourceEndpoint:f===0?h:u.endpoints[0],originalTargetEndpoint:f===1?u.suspendedEndpoint:u.endpoints[1],newTargetEndpoint:f===1?h:u.endpoints[1],connection:u},a)}if(f===1){i.anchorManager.updateOtherEndpoint(u.sourceId,u.floatingId,u.targetId,u)}else{i.anchorManager.sourceChanged(u.floatingId,u.sourceId,u,u.source)}if(u.endpoints[0].finalEndpoint){var l=u.endpoints[0];l.detachFromConnection(u);u.endpoints[0]=u.endpoints[0].finalEndpoint;u.endpoints[0].addConnection(u)}if(n.isObject(e)){u.mergeData(e)}i.finaliseConnection(u,null,a,false);u.setHover(false)}.bind(this);var v=function(){if(u.suspendedEndpoint){u.endpoints[f]=u.suspendedEndpoint;u.setHover(false);u._forceDetach=true;if(f===0){u.source=u.suspendedEndpoint.element;u.sourceId=u.suspendedEndpoint.elementId}else{u.target=u.suspendedEndpoint.element;u.targetId=u.suspendedEndpoint.elementId}u.suspendedEndpoint.addConnection(u);if(f===1){i.anchorManager.updateOtherEndpoint(u.sourceId,u.floatingId,u.targetId,u)}else{i.anchorManager.sourceChanged(u.floatingId,u.sourceId,u,u.source)}i.repaint(u.sourceId);u._forceDetach=false}};p=p&&t.isDropAllowed(u.sourceId,u.targetId,u.scope,u,h);if(p){_(p);return true}else{v()}}if(t.maybeCleanup){t.maybeCleanup(h)}i.currentlyDragging=false}}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i=function(t,n,i,a,r){if(!t.Defaults.DoNotThrowErrors&&e.Connectors[n][i]==null){throw{msg:"jsPlumb: unknown connector type '"+i+"'"}}return new e.Connectors[n][i](a,r)},a=function(t,e,n){return t?n.makeAnchor(t,e,n):null},r=function(t,e,i,a){if(e!=null){e._jsPlumbConnections=e._jsPlumbConnections||{};if(a){delete e._jsPlumbConnections[t.id]}else{e._jsPlumbConnections[t.id]=true}if(n.isEmpty(e._jsPlumbConnections)){i.removeClass(e,i.connectedClass)}else{i.addClass(e,i.connectedClass)}}};e.Connection=function(t){var i=t.newEndpoint;this.id=t.id;this.connector=null;this.idPrefix="_jsplumb_c_";this.defaultLabelLocation=.5;this.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.previousConnection=t.previousConnection;this.source=e.getElement(t.source);this.target=e.getElement(t.target);if(t.sourceEndpoint){this.source=t.sourceEndpoint.getElement()}if(t.targetEndpoint){this.target=t.targetEndpoint.getElement()}e.OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.sourceId=this._jsPlumb.instance.getId(this.source);this.targetId=this._jsPlumb.instance.getId(this.target);this.scope=t.scope;this.endpoints=[];this.endpointStyles=[];var a=this._jsPlumb.instance;a.manage(this.sourceId,this.source);a.manage(this.targetId,this.target);this._jsPlumb.visible=true;this._jsPlumb.editable=t.editable===true;this._jsPlumb.params={cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams,overlays:t.overlays};this._jsPlumb.lastPaintedAt=null;this.bind("mouseover",function(){this.setHover(true)}.bind(this));this.bind("mouseout",function(){this.setHover(false)}.bind(this));this.editableRequested=t.editable!==false;this.setEditable=function(t){return this.connector?this.connector.setEditable(t):false};this.isEditable=function(){return this.connector?this.connector.isEditable():false};this.isEditing=function(){return this.connector?this.connector.isEditing():false};this.makeEndpoint=function(e,n,r,s){r=r||this._jsPlumb.instance.getId(n);return this.prepareEndpoint(a,i,this,s,e?0:1,t,n,r)};if(t.type){t.endpoints=t.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(t.type).endpoints}var r=this.makeEndpoint(true,this.source,this.sourceId,t.sourceEndpoint),s=this.makeEndpoint(false,this.target,this.targetId,t.targetEndpoint);if(r){n.addToList(t.endpointsByElement,this.sourceId,r)}if(s){n.addToList(t.endpointsByElement,this.targetId,s)}if(!this.scope){this.scope=this.endpoints[0].scope}if(t.deleteEndpointsOnEmpty!=null){this.endpoints[0].setDeleteOnEmpty(t.deleteEndpointsOnEmpty);this.endpoints[1].setDeleteOnEmpty(t.deleteEndpointsOnEmpty)}var o=a.Defaults.ConnectionsDetachable;if(t.detachable===false){o=false}if(this.endpoints[0].connectionsDetachable===false){o=false}if(this.endpoints[1].connectionsDetachable===false){o=false}var l=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections;this.appendToDefaultType({detachable:o,reattach:l,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||a.Defaults.PaintStyle||e.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||a.Defaults.HoverPaintStyle||e.Defaults.HoverPaintStyle});var u=a.getSuspendedAt();if(!a.isSuspendDrawing()){var c=a.getCachedData(this.sourceId),h=c.o,f=c.s,d=a.getCachedData(this.targetId),p=d.o,_=d.s,v=u||a.timestamp(),g=this.endpoints[0].anchor.compute({xy:[h.left,h.top],wh:f,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[p.left,p.top],twh:_,tElement:this.endpoints[1],timestamp:v});this.endpoints[0].paint({anchorLoc:g,timestamp:v});g=this.endpoints[1].anchor.compute({xy:[p.left,p.top],wh:_,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[h.left,h.top],twh:f,tElement:this.endpoints[0],timestamp:v});this.endpoints[1].paint({anchorLoc:g,timestamp:v})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=function(){return this.endpoints};this.isDetachable=function(){return this._jsPlumb.detachable===true};this.setDetachable=function(t){this._jsPlumb.detachable=t===true};this.isReattach=function(){return this._jsPlumb.reattach===true||this.endpoints[0].reattachConnections===true||this.endpoints[1].reattachConnections===true};this.setReattach=function(t){this._jsPlumb.reattach=t===true};this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=t.directed;if(t.directed==null){this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected()}var m=e.extend({},this.endpoints[1].getParameters());e.extend(m,this.endpoints[0].getParameters());e.extend(m,this.getParameters());this.setParameters(m);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||a.Defaults.Connector||e.Defaults.Connector,true);if(t.geometry){this.connector.setGeometry(t.geometry)}var b=t.data==null||!n.isObject(t.data)?{}:t.data;this.getData=function(){return b};this.setData=function(t){b=t||{}};this.mergeData=function(t){b=e.extend(b,t)};var y=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,t.type].join(" ");if(/[^\s]/.test(y)){this.addType(y,t.data,true)}this.updateConnectedClass()};n.extend(e.Connection,e.OverlayCapableJsPlumbUIComponent,{applyType:function(t,n,i){if(t.detachable!=null){this.setDetachable(t.detachable)}if(t.reattach!=null){this.setReattach(t.reattach)}if(t.scope){this.scope=t.scope}if(t.cssClass!=null&&this.canvas){this._jsPlumb.instance.addClass(this.canvas,t.cssClass)}var a=null;if(t.anchor){a=this.getCachedTypeItem("anchors",i.anchor);if(a==null){a=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)];this.cacheTypeItem("anchors",a,i.anchor)}}else if(t.anchors){a=this.getCachedTypeItem("anchors",i.anchors);if(a==null){a=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])];this.cacheTypeItem("anchors",a,i.anchors)}}if(a!=null){this.endpoints[0].anchor=a[0];this.endpoints[1].anchor=a[1];if(this.endpoints[1].anchor.isDynamic){this._jsPlumb.instance.repaint(this.endpoints[1].elementId)}}e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(t,e){if(e){this.endpoints[0].addClass(t);this.endpoints[1].addClass(t);if(this.suspendedEndpoint){this.suspendedEndpoint.addClass(t)}}if(this.connector){this.connector.addClass(t)}},removeClass:function(t,e){if(e){this.endpoints[0].removeClass(t);this.endpoints[1].removeClass(t);if(this.suspendedEndpoint){this.suspendedEndpoint.removeClass(t)}}if(this.connector){this.connector.removeClass(t)}},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t;if(this.connector){this.connector.setVisible(t)}this.repaint()},cleanup:function(){this.updateConnectedClass(true);this.endpoints=null;this.source=null;this.target=null;if(this.connector!=null){this.connector.cleanup(true);this.connector.destroy(true)}this.connector=null},updateConnectedClass:function(t){if(this._jsPlumb){r(this,this.source,this._jsPlumb.instance,t);r(this,this.target,this._jsPlumb.instance,t)}},setHover:function(e){if(this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.connector.setHover(e);t.jsPlumb[e?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass);t.jsPlumb[e?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass)}},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-Infinity},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return this._jsPlumb.directed===true},getConnector:function(){return this.connector},getGeometry:function(){return this.connector?this.connector.getGeometry():null},setGeometry:function(t){if(this.connector){this.connector.setGeometry(t)}},prepareConnector:function(t,e){var a={_jsPlumb:this._jsPlumb.instance,cssClass:(this._jsPlumb.params.cssClass||"")+(this.isEditable()?this._jsPlumb.instance.editableConnectorClass:""),container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"],editable:this.editableRequested},r=this._jsPlumb.instance.getRenderMode(),s;if(n.isString(t)){s=i(this._jsPlumb.instance,r,t,a,this)}else if(n.isArray(t)){if(t.length===1){s=i(this._jsPlumb.instance,r,t[0],a,this)}else{s=i(this._jsPlumb.instance,r,t[0],n.merge(t[1],a),this)}}if(e!=null){s.typeId=e}return s},setPreparedConnector:function(t,e,n,i){var a,r="";if(this.connector!=null){a=this.connector;r=a.getClass();this.connector.cleanup();this.connector.destroy()}this.connector=t;if(i){this.cacheTypeItem("connector",t,i)}this.canvas=this.connector.canvas;this.bgCanvas=this.connector.bgCanvas;this.addClass(r);if(this.canvas){this.canvas._jsPlumb=this}if(this.bgCanvas){this.bgCanvas._jsPlumb=this}if(a!=null){var s=this.getOverlays();for(var o=0;o<s.length;o++){if(s[o].transfer){s[o].transfer(this.connector)}}}if(!n){this.setListenerComponent(this.connector)}if(!e){this.repaint()}},setConnector:function(t,e,n,i){var a=this.prepareConnector(t,i);this.setPreparedConnector(a,e,n,i)},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){t=t||{};var e=t.timestamp,n=false,i=n?this.sourceId:this.targetId,a=n?this.targetId:this.sourceId,r=n?0:1,s=n?1:0;if(e==null||e!==this._jsPlumb.lastPaintedAt){var o=this._jsPlumb.instance.updateOffset({elId:a}).o,l=this._jsPlumb.instance.updateOffset({elId:i}).o,u=this.endpoints[s],c=this.endpoints[r];var h=u.anchor.getCurrentLocation({xy:[o.left,o.top],wh:[o.width,o.height],element:u,timestamp:e}),f=c.anchor.getCurrentLocation({xy:[l.left,l.top],wh:[l.width,l.height],element:c,timestamp:e});this.connector.resetBounds();this.connector.compute({sourcePos:h,targetPos:f,sourceEndpoint:this.endpoints[s],targetEndpoint:this.endpoints[r],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:o,targetInfo:l});var d={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};for(var p in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(p)){var _=this._jsPlumb.overlays[p];if(_.isVisible()){this._jsPlumb.overlayPlacements[p]=_.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(_));d.minX=Math.min(d.minX,this._jsPlumb.overlayPlacements[p].minX);d.maxX=Math.max(d.maxX,this._jsPlumb.overlayPlacements[p].maxX);d.minY=Math.min(d.minY,this._jsPlumb.overlayPlacements[p].minY);d.maxY=Math.max(d.maxY,this._jsPlumb.overlayPlacements[p].maxY)}}}var v=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,g=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),m={xmin:Math.min(this.connector.bounds.minX-(v+g),d.minX),ymin:Math.min(this.connector.bounds.minY-(v+g),d.minY),xmax:Math.max(this.connector.bounds.maxX+(v+g),d.maxX),ymax:Math.max(this.connector.bounds.maxY+(v+g),d.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,m);for(var b in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(b)){var y=this._jsPlumb.overlays[b];if(y.isVisible()){y.paint(this._jsPlumb.overlayPlacements[b],m)}}}}this._jsPlumb.lastPaintedAt=e}},repaint:function(t){t=t||{};this.paint({elId:this.sourceId,recalc:!(t.recalc===false),timestamp:t.timestamp})},prepareEndpoint:function(t,n,i,r,s,o,l,u){var c;if(r){i.endpoints[s]=r;r.addConnection(i)}else{if(!o.endpoints){o.endpoints=[null,null]}var h=o.endpoints[s]||o.endpoint||t.Defaults.Endpoints[s]||e.Defaults.Endpoints[s]||t.Defaults.Endpoint||e.Defaults.Endpoint;if(!o.endpointStyles){o.endpointStyles=[null,null]}if(!o.endpointHoverStyles){o.endpointHoverStyles=[null,null]}var f=o.endpointStyles[s]||o.endpointStyle||t.Defaults.EndpointStyles[s]||e.Defaults.EndpointStyles[s]||t.Defaults.EndpointStyle||e.Defaults.EndpointStyle;if(f.fill==null&&o.paintStyle!=null){f.fill=o.paintStyle.stroke}if(f.outlineStroke==null&&o.paintStyle!=null){f.outlineStroke=o.paintStyle.outlineStroke}if(f.outlineWidth==null&&o.paintStyle!=null){f.outlineWidth=o.paintStyle.outlineWidth}var d=o.endpointHoverStyles[s]||o.endpointHoverStyle||t.Defaults.EndpointHoverStyles[s]||e.Defaults.EndpointHoverStyles[s]||t.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle;if(o.hoverPaintStyle!=null){if(d==null){d={}}if(d.fill==null){d.fill=o.hoverPaintStyle.stroke}}var p=o.anchors?o.anchors[s]:o.anchor?o.anchor:a(t.Defaults.Anchors[s],u,t)||a(e.Defaults.Anchors[s],u,t)||a(t.Defaults.Anchor,u,t)||a(e.Defaults.Anchor,u,t),_=o.uuids?o.uuids[s]:null;c=n({paintStyle:f,hoverPaintStyle:d,endpoint:h,connections:[i],uuid:_,anchor:p,source:l,scope:o.scope,reattach:o.reattach||t.Defaults.ReattachConnections,detachable:o.detachable||t.Defaults.ConnectionsDetachable});if(r==null){c.setDeleteOnEmpty(true)}i.endpoints[s]=c;if(o.drawEndpoints===false){c.setVisible(false,true,true)}}return c}})}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumbUtil,n=t.jsPlumb;n.AnchorManager=function(t){var i={},a={},r={},s={},o={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},l=["left","top","right","bottom"],u={},c=this,h={},f=t.jsPlumbInstance,d={},p=function(t,e,n,i,a,r){if(t===e){return{orientation:o.IDENTITY,a:["top","top"]}}var s=Math.atan2(i.centery-n.centery,i.centerx-n.centerx),u=Math.atan2(n.centery-i.centery,n.centerx-i.centerx);var c=[],h={};(function(t,e){for(var n=0;n<t.length;n++){h[t[n]]={left:[e[n].left,e[n].centery],right:[e[n].right,e[n].centery],top:[e[n].centerx,e[n].top],bottom:[e[n].centerx,e[n].bottom]}}})(["source","target"],[n,i]);for(var f=0;f<l.length;f++){for(var d=0;d<l.length;d++){c.push({source:l[f],target:l[d],dist:Biltong.lineLength(h.source[l[f]],h.target[l[d]])})}}c.sort(function(t,e){return t.dist<e.dist?-1:t.dist>e.dist?1:0});var p=c[0].source,_=c[0].target;for(var v=0;v<c.length;v++){if(!a.isContinuous||a.isEdgeSupported(c[v].source)){p=c[v].source}else{p=null}if(!r.isContinuous||r.isEdgeSupported(c[v].target)){_=c[v].target}else{_=null}if(p!=null&&_!=null){break}}return{a:[p,_],theta:s,theta2:u}},_=function(t,e,n,i,a,r,s){var o=[],l=e[a?0:1]/(i.length+1);for(var u=0;u<i.length;u++){var c=(u+1)*l,h=r*e[a?1:0];if(s){c=e[a?0:1]-c}var f=a?c:h,d=n[0]+f,p=f/e[0],_=a?h:c,v=n[1]+_,g=_/e[1];o.push([d,v,p,g,i[u][1],i[u][2]])}return o},v=function(t){return function(e,n){var i=true;if(t){i=e[0][0]<n[0][0]}else{i=e[0][0]>n[0][0]}return i===false?-1:1}},g=function(t,e){var n=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0],i=e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0];if(n>i){return 1}else{return-1}},m={top:function(t,e){return t[0]>e[0]?1:-1},right:v(true),bottom:v(true),left:g},b=function(t,e){return t.sort(e)},y=function(t,e){var n=f.getCachedData(t),i=n.s,r=n.o,o=function(e,n,i,r,o,l,u){if(r.length>0){var c=b(r,m[e]),h=e==="right"||e==="top",f=_(e,n,i,c,o,l,h);var d=function(t,e){a[t.id]=[e[0],e[1],e[2],e[3]];s[t.id]=u};for(var p=0;p<f.length;p++){var v=f[p][4],g=v.endpoints[0].elementId===t,y=v.endpoints[1].elementId===t;if(g){d(v.endpoints[0],f[p])}if(y){d(v.endpoints[1],f[p])}}}};o("bottom",i,[r.left,r.top],e.bottom,true,1,[0,1]);o("top",i,[r.left,r.top],e.top,true,0,[0,-1]);o("left",i,[r.left,r.top],e.left,false,0,[-1,0]);o("right",i,[r.left,r.top],e.right,false,1,[1,0])};this.reset=function(){i={};u={};h={}};this.addFloatingConnection=function(t,e){d[t]=e};this.removeFloatingConnection=function(t){delete d[t]};this.newConnection=function(t){var i=t.sourceId,a=t.targetId,r=t.endpoints,s=true,o=function(o,l,c,h,f){if(i===a&&c.isContinuous){t._jsPlumb.instance.removeElement(r[1].canvas);s=false}e.addToList(u,h,[f,l,c.constructor===n.DynamicAnchor])};o(0,r[0],r[0].anchor,a,t);if(s){o(1,r[1],r[1].anchor,i,t)}};var P=function(t){(function(t,n){if(t){var i=function(t){return t[4]===n};e.removeWithFunction(t.top,i);e.removeWithFunction(t.left,i);e.removeWithFunction(t.bottom,i);e.removeWithFunction(t.right,i)}})(h[t.elementId],t.id)};this.connectionDetached=function(t,n){var i=t.connection||t,a=t.sourceId,r=t.targetId,s=i.endpoints,o=function(t,n,i,a,r){e.removeWithFunction(u[a],function(t){return t[0].id===r.id})};o(1,s[1],s[1].anchor,a,i);o(0,s[0],s[0].anchor,r,i);if(i.floatingId){o(i.floatingIndex,i.floatingEndpoint,i.floatingEndpoint.anchor,i.floatingId,i);P(i.floatingEndpoint)}P(i.endpoints[0]);P(i.endpoints[1]);if(!n){c.redraw(i.sourceId);if(i.targetId!==i.sourceId){c.redraw(i.targetId)}}};this.add=function(t,n){e.addToList(i,n,t)};this.changeId=function(t,e){u[e]=u[t];i[e]=i[t];delete u[t];delete i[t]};this.getConnectionsFor=function(t){return u[t]||[]};this.getEndpointsFor=function(t){return i[t]||[]};this.deleteEndpoint=function(t){e.removeWithFunction(i[t.elementId],function(e){return e.id===t.id});P(t)};this.clearFor=function(t){delete i[t];i[t]=[]};var x=function(n,i,a,r,s,o,l,u,c,h,f,d){var p=-1,_=-1,v=r.endpoints[l],g=v.id,m=[1,0][l],b=[[i,a],r,s,o,g],y=n[c],P=v._continuousAnchorEdge?n[v._continuousAnchorEdge]:null,x,j;if(P){var C=e.findWithFunction(P,function(t){return t[4]===g});if(C!==-1){P.splice(C,1);for(x=0;x<P.length;x++){j=P[x][1];e.addWithFunction(f,j,function(t){return t.id===j.id});e.addWithFunction(d,P[x][1].endpoints[l],function(t){return t.id===j.endpoints[l].id});e.addWithFunction(d,P[x][1].endpoints[m],function(t){return t.id===j.endpoints[m].id})}}}for(x=0;x<y.length;x++){j=y[x][1];if(t.idx===1&&y[x][3]===o&&_===-1){_=x}e.addWithFunction(f,j,function(t){return t.id===j.id});e.addWithFunction(d,y[x][1].endpoints[l],function(t){return t.id===j.endpoints[l].id});e.addWithFunction(d,y[x][1].endpoints[m],function(t){return t.id===j.endpoints[m].id})}if(p!==-1){y[p]=b}else{var E=u?_!==-1?_:0:y.length;y.splice(E,0,b)}v._continuousAnchorEdge=c};this.updateOtherEndpoint=function(t,i,a,r){var s=e.findWithFunction(u[t],function(t){return t[0].id===r.id}),o=e.findWithFunction(u[i],function(t){return t[0].id===r.id});if(s!==-1){u[t][s][0]=r;u[t][s][1]=r.endpoints[1];u[t][s][2]=r.endpoints[1].anchor.constructor===n.DynamicAnchor}if(o>-1){u[i].splice(o,1);e.addToList(u,a,[r,r.endpoints[0],r.endpoints[0].anchor.constructor===n.DynamicAnchor])}r.updateConnectedClass()};this.sourceChanged=function(t,i,a,r){if(t!==i){a.sourceId=i;a.source=r;e.removeWithFunction(u[t],function(t){return t[0].id===a.id});var s=e.findWithFunction(u[a.targetId],function(t){return t[0].id===a.id});if(s>-1){u[a.targetId][s][0]=a;u[a.targetId][s][1]=a.endpoints[0];u[a.targetId][s][2]=a.endpoints[0].anchor.constructor===n.DynamicAnchor}e.addToList(u,i,[a,a.endpoints[1],a.endpoints[1].anchor.constructor===n.DynamicAnchor]);if(a.endpoints[1].anchor.isContinuous){if(a.source===a.target){a._jsPlumb.instance.removeElement(a.endpoints[1].canvas)}else{if(a.endpoints[1].canvas.parentNode==null){a._jsPlumb.instance.appendElement(a.endpoints[1].canvas)}}}a.updateConnectedClass()}};this.rehomeEndpoint=function(t,e,n){var a=i[e]||[],r=f.getId(n);if(r!==e){var s=a.indexOf(t);if(s>-1){var o=a.splice(s,1)[0];c.add(o,r)}}for(var l=0;l<t.connections.length;l++){if(t.connections[l].sourceId===e){c.sourceChanged(e,t.elementId,t.connections[l],t.element)}else if(t.connections[l].targetId===e){t.connections[l].targetId=t.elementId;t.connections[l].target=t.element;c.updateOtherEndpoint(t.connections[l].sourceId,e,t.elementId,t.connections[l])}}};this.redraw=function(t,a,r,s,o,l){if(!f.isSuspendDrawing()){var c=i[t]||[],_=u[t]||[],v=[],g=[],m=[];r=r||f.timestamp();s=s||{left:0,top:0};if(a){a={left:a.left+s.left,top:a.top+s.top}}var b=f.updateOffset({elId:t,offset:a,recalc:false,timestamp:r}),P={};for(var j=0;j<_.length;j++){var C=_[j][0],E=C.sourceId,w=C.targetId,S=C.endpoints[0].anchor.isContinuous,D=C.endpoints[1].anchor.isContinuous;if(S||D){var I=E+"_"+w,A=P[I],T=C.sourceId===t?1:0;if(S&&!h[E]){h[E]={top:[],right:[],bottom:[],left:[]}}if(D&&!h[w]){h[w]={top:[],right:[],bottom:[],left:[]}}if(t!==w){f.updateOffset({elId:w,timestamp:r})}if(t!==E){f.updateOffset({elId:E,timestamp:r})}var k=f.getCachedData(w),M=f.getCachedData(E);if(w===E&&(S||D)){x(h[E],-Math.PI/2,0,C,false,w,0,false,"top",E,v,g);x(h[w],-Math.PI/2,0,C,false,E,1,false,"top",w,v,g)}else{if(!A){A=p(E,w,M.o,k.o,C.endpoints[0].anchor,C.endpoints[1].anchor);P[I]=A}if(S){x(h[E],A.theta,0,C,false,w,0,false,A.a[0],E,v,g)}if(D){x(h[w],A.theta2,-1,C,true,E,1,true,A.a[1],w,v,g)}}if(S){e.addWithFunction(m,E,function(t){return t===E})}if(D){e.addWithFunction(m,w,function(t){return t===w})}e.addWithFunction(v,C,function(t){return t.id===C.id});if(S&&T===0||D&&T===1){e.addWithFunction(g,C.endpoints[T],function(t){return t.id===C.endpoints[T].id})}}}for(j=0;j<c.length;j++){if(c[j].connections.length===0&&c[j].anchor.isContinuous){if(!h[t]){h[t]={top:[],right:[],bottom:[],left:[]}}x(h[t],-Math.PI/2,0,{endpoints:[c[j],c[j]],paint:function(){}},false,t,0,false,c[j].anchor.getDefaultFace(),t,v,g);e.addWithFunction(m,t,function(e){return e===t})}}for(j=0;j<m.length;j++){y(m[j],h[m[j]])}for(j=0;j<c.length;j++){c[j].paint({timestamp:r,offset:b,dimensions:b.s,recalc:l!==true})}for(j=0;j<g.length;j++){var O=f.getCachedData(g[j].elementId);g[j].paint({timestamp:r,offset:O,dimensions:O.s})}for(j=0;j<_.length;j++){var V=_[j][1];if(V.anchor.constructor===n.DynamicAnchor){V.paint({elementWithPrecedence:t,timestamp:r});e.addWithFunction(v,_[j][0],function(t){return t.id===_[j][0].id});for(var L=0;L<V.connections.length;L++){if(V.connections[L]!==_[j][0]){e.addWithFunction(v,V.connections[L],function(t){return t.id===V.connections[L].id})}}}else if(V.anchor.constructor===n.Anchor){e.addWithFunction(v,_[j][0],function(t){return t.id===_[j][0].id})}}var N=d[t];if(N){N.paint({timestamp:r,recalc:false,elId:t})}for(j=0;j<v.length;j++){v[j].paint({elId:t,timestamp:r,recalc:false,clearEdits:o})}}};var j=function(t){e.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=true;this.isContinuous=true;var n=t.faces||["top","right","bottom","left"],i=!(t.clockwise===false),o={},l={top:"bottom",right:"left",left:"right",bottom:"top"},u={top:"right",right:"bottom",left:"top",bottom:"left"},c={top:"left",right:"top",left:"bottom",bottom:"right"},h=i?u:c,f=i?c:u,d=t.cssClass||"";for(var p=0;p<n.length;p++){o[n[p]]=true}this.getDefaultFace=function(){return n.length===0?"top":n[0]};this.verifyEdge=function(t){if(o[t]){return t}else if(o[l[t]]){return l[t]}else if(o[h[t]]){return h[t]}else if(o[f[t]]){return f[t]}return t};this.isEdgeSupported=function(t){return o[t]===true};this.compute=function(t){return r[t.element.id]||a[t.element.id]||[0,0]};this.getCurrentLocation=function(t){return r[t.element.id]||a[t.element.id]||[0,0]};this.getOrientation=function(t){return s[t.id]||[0,0]};this.clearUserDefinedLocation=function(){delete r[t.elementId]};this.setUserDefinedLocation=function(e){r[t.elementId]=e};this.getCssClass=function(){return d}};f.continuousAnchorFactory={get:function(t){return new j(t)},clear:function(t){delete r[t];delete a[t]}}};n.Anchor=function(t){this.x=t.x||0;this.y=t.y||0;this.elementId=t.elementId;this.cssClass=t.cssClass||"";this.userDefinedLocation=null;this.orientation=t.orientation||[0,0];this.lastReturnValue=null;this.offsets=t.offsets||[0,0];this.timestamp=null;e.EventGenerator.apply(this);this.compute=function(t){var e=t.xy,n=t.wh,i=t.timestamp;if(t.clearUserDefinedLocation){this.userDefinedLocation=null}if(i&&i===this.timestamp){return this.lastReturnValue}if(this.userDefinedLocation!=null){this.lastReturnValue=this.userDefinedLocation}else{this.lastReturnValue=[e[0]+this.x*n[0]+this.offsets[0],e[1]+this.y*n[1]+this.offsets[1]]}this.timestamp=i;return this.lastReturnValue};this.getCurrentLocation=function(t){t=t||{};return this.lastReturnValue==null||t.timestamp!=null&&this.timestamp!==t.timestamp?this.compute(t):this.lastReturnValue}};e.extend(n.Anchor,e.EventGenerator,{equals:function(t){if(!t){return false}var e=t.getOrientation(),n=this.getOrientation();return this.x===t.x&&this.y===t.y&&this.offsets[0]===t.offsets[0]&&this.offsets[1]===t.offsets[1]&&n[0]===e[0]&&n[1]===e[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(t){this.userDefinedLocation=t},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});n.FloatingAnchor=function(t){n.Anchor.apply(this,arguments);var e=t.reference,i=t.referenceCanvas,a=n.getSize(i),r=0,s=0,o=null,l=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(t){var e=t.xy,n=[e[0]+a[0]/2,e[1]+a[1]/2];l=n;return n};this.getOrientation=function(t){if(o){return o}else{var n=e.getOrientation(t);return[Math.abs(n[0])*r*-1,Math.abs(n[1])*s*-1]}};this.over=function(t,e){o=t.getOrientation(e)};this.out=function(){o=null};this.getCurrentLocation=function(t){return l==null?this.compute(t):l}};e.extend(n.FloatingAnchor,n.Anchor);var i=function(t,e,i){return t.constructor===n.Anchor?t:e.makeAnchor(t,i,e)};n.DynamicAnchor=function(t){n.Anchor.apply(this,arguments);this.isDynamic=true;this.anchors=[];this.elementId=t.elementId;this.jsPlumbInstance=t.jsPlumbInstance;for(var e=0;e<t.anchors.length;e++){this.anchors[e]=i(t.anchors[e],this.jsPlumbInstance,this.elementId)}this.getAnchors=function(){return this.anchors};this.locked=false;var a=this.anchors.length>0?this.anchors[0]:null,r=a,s=this,o=function(t,e,n,i,a){var r=i[0]+t.x*a[0],s=i[1]+t.y*a[1],o=i[0]+a[0]/2,l=i[1]+a[1]/2;return Math.sqrt(Math.pow(e-r,2)+Math.pow(n-s,2))+Math.sqrt(Math.pow(o-r,2)+Math.pow(l-s,2))},l=t.selector||function(t,e,n,i,a){var r=n[0]+i[0]/2,s=n[1]+i[1]/2;var l=-1,u=Infinity;for(var c=0;c<a.length;c++){var h=o(a[c],r,s,t,e);if(h<u){l=c+0;u=h}}return a[l]};this.compute=function(t){var e=t.xy,n=t.wh,i=t.txy,o=t.twh;this.timestamp=t.timestamp;var u=s.getUserDefinedLocation();if(u!=null){return u}if(this.locked||i==null||o==null){return a.compute(t)}else{t.timestamp=null}a=l(e,n,i,o,this.anchors);this.x=a.x;this.y=a.y;if(a!==r){this.fire("anchorChanged",a)}r=a;return a.compute(t)};this.getCurrentLocation=function(t){return this.getUserDefinedLocation()||(a!=null?a.getCurrentLocation(t):null)};this.getOrientation=function(t){return a!=null?a.getOrientation(t):[0,0]};this.over=function(t,e){if(a!=null){a.over(t,e)}};this.out=function(){if(a!=null){a.out()}};this.getCssClass=function(){return a&&a.getCssClass()||""}};e.extend(n.DynamicAnchor,n.Anchor);var a=function(t,e,i,a,r,s){n.Anchors[r]=function(n){var o=n.jsPlumbInstance.makeAnchor([t,e,i,a,0,0],n.elementId,n.jsPlumbInstance);o.type=r;if(s){s(o,n)}return o}};a(.5,0,0,-1,"TopCenter");a(.5,1,0,1,"BottomCenter");a(0,.5,-1,0,"LeftMiddle");a(1,.5,1,0,"RightMiddle");a(.5,0,0,-1,"Top");a(.5,1,0,1,"Bottom");a(0,.5,-1,0,"Left");a(1,.5,1,0,"Right");a(.5,.5,0,0,"Center");a(1,0,0,-1,"TopRight");a(1,1,0,1,"BottomRight");a(0,0,0,-1,"TopLeft");a(0,1,0,1,"BottomLeft");n.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)
};n.Anchors.AutoDefault=function(t){var e=t.jsPlumbInstance.makeDynamicAnchor(n.Defaults.DynamicAnchors(t));e.type="AutoDefault";return e};var r=function(t,e){n.Anchors[t]=function(n){var i=n.jsPlumbInstance.makeAnchor(["Continuous",{faces:e}],n.elementId,n.jsPlumbInstance);i.type=t;return i}};n.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)};r("ContinuousLeft",["left"]);r("ContinuousTop",["top"]);r("ContinuousBottom",["bottom"]);r("ContinuousRight",["right"]);a(0,0,0,0,"Assign",function(t,e){var n=e.position||"Fixed";t.positionFinder=n.constructor===String?e.jsPlumbInstance.AnchorPositionFinders[n]:n;t.constructorParams=e});t.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(t,e,n){return[(t.left-e.left)/n[0],(t.top-e.top)/n[1]]},Grid:function(t,e,n,i){var a=t.left-e.left,r=t.top-e.top,s=n[0]/i.grid[0],o=n[1]/i.grid[1],l=Math.floor(a/s),u=Math.floor(r/o);return[(l*s+s/2)/n[0],(u*o+o/2)/n[1]]}};n.Anchors.Perimeter=function(t){t=t||{};var e=t.anchorCount||60,n=t.shape;if(!n){throw new Error("no shape supplied to Perimeter Anchor type")}var i=function(){var t=.5,n=Math.PI*2/e,i=0,a=[];for(var r=0;r<e;r++){var s=t+t*Math.sin(i),o=t+t*Math.cos(i);a.push([s,o,0,0]);i+=n}return a},a=function(t){var n=e/t.length,i=[],a=function(t,a,r,s,o){n=e*o;var l=(r-t)/n,u=(s-a)/n;for(var c=0;c<n;c++){i.push([t+l*c,a+u*c,0,0])}};for(var r=0;r<t.length;r++){a.apply(null,t[r])}return i},r=function(t){var e=[];for(var n=0;n<t.length;n++){e.push([t[n][0],t[n][1],t[n][2],t[n][3],1/t.length])}return a(e)},s=function(){return r([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])};var o={Circle:i,Ellipse:i,Diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){var e=t.points,n=[],i=0;for(var r=0;r<e.length-1;r++){var s=Math.sqrt(Math.pow(e[r][2]-e[r][0])+Math.pow(e[r][3]-e[r][1]));i+=s;n.push([e[r][0],e[r][1],e[r+1][0],e[r+1][1],s])}for(var o=0;o<n.length;o++){n[o][4]=n[o][4]/i}return a(n)}},l=function(t,e){var n=[],i=e/180*Math.PI;for(var a=0;a<t.length;a++){var r=t[a][0]-.5,s=t[a][1]-.5;n.push([.5+(r*Math.cos(i)-s*Math.sin(i)),.5+(r*Math.sin(i)+s*Math.cos(i)),t[a][2],t[a][3]])}return n};if(!o[n]){throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type")}var u=o[n](t);if(t.rotation){u=l(u,t.rotation)}var c=t.jsPlumbInstance.makeDynamicAnchor(u);c.type="Perimeter";return c}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,i=t.Biltong;e.Segments={AbstractSegment:function(t){this.params=t;this.findClosestPointOnPath=function(t,e){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var n=e.Segments.AbstractSegment.apply(this,arguments),a,r,s,o,l,u,c,h=function(){a=Math.sqrt(Math.pow(l-o,2)+Math.pow(c-u,2));r=i.gradient({x:o,y:u},{x:l,y:c});s=-1/r};this.type="Straight";this.getLength=function(){return a};this.getGradient=function(){return r};this.getCoordinates=function(){return{x1:o,y1:u,x2:l,y2:c}};this.setCoordinates=function(t){o=t.x1;u=t.y1;l=t.x2;c=t.y2;h()};this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2});this.getBounds=function(){return{minX:Math.min(o,l),minY:Math.min(u,c),maxX:Math.max(o,l),maxY:Math.max(u,c)}};this.pointOnPath=function(t,e){if(t===0&&!e){return{x:o,y:u}}else if(t===1&&!e){return{x:l,y:c}}else{var n=e?t>0?t:a+t:t*a;return i.pointOnLine({x:o,y:u},{x:l,y:c},n)}};this.gradientAtPoint=function(t){return r};this.pointAlongPathFrom=function(t,e,n){var a=this.pointOnPath(t,n),r=e<=0?{x:o,y:u}:{x:l,y:c};if(e<=0&&Math.abs(e)>1){e*=-1}return i.pointOnLine(a,r,e)};var f=function(t,e,n){return n>=Math.min(t,e)&&n<=Math.max(t,e)};var d=function(t,e,n){return Math.abs(n-t)<Math.abs(n-e)?t:e};this.findClosestPointOnPath=function(t,e){var n={d:Infinity,x:null,y:null,l:null,x1:o,x2:l,y1:u,y2:c};if(r===0){n.y=u;n.x=f(o,l,t)?t:d(o,l,t)}else if(r===Infinity||r===-Infinity){n.x=o;n.y=f(u,c,e)?e:d(u,c,e)}else{var h=u-r*o,p=e-s*t,_=(p-h)/(r-s),v=r*_+h;n.x=f(o,l,_)?_:d(o,l,_);n.y=f(u,c,v)?v:d(u,c,v)}var g=i.lineLength([n.x,n.y],[o,u]);n.d=i.lineLength([t,e],[n.x,n.y]);n.l=g/a;return n}},Arc:function(t){var n=e.Segments.AbstractSegment.apply(this,arguments),a=function(e,n){return i.theta([t.cx,t.cy],[e,n])},r=function(t,e){if(t.anticlockwise){var n=t.startAngle<t.endAngle?t.startAngle+s:t.startAngle,i=Math.abs(n-t.endAngle);return n-i*e}else{var a=t.endAngle<t.startAngle?t.endAngle+s:t.endAngle,r=Math.abs(a-t.startAngle);return t.startAngle+r*e}},s=2*Math.PI;this.radius=t.r;this.anticlockwise=t.ac;this.type="Arc";if(t.startAngle&&t.endAngle){this.startAngle=t.startAngle;this.endAngle=t.endAngle;this.x1=t.cx+this.radius*Math.cos(t.startAngle);this.y1=t.cy+this.radius*Math.sin(t.startAngle);this.x2=t.cx+this.radius*Math.cos(t.endAngle);this.y2=t.cy+this.radius*Math.sin(t.endAngle)}else{this.startAngle=a(t.x1,t.y1);this.endAngle=a(t.x2,t.y2);this.x1=t.x1;this.y1=t.y1;this.x2=t.x2;this.y2=t.y2}if(this.endAngle<0){this.endAngle+=s}if(this.startAngle<0){this.startAngle+=s}var o=this.endAngle<this.startAngle?this.endAngle+s:this.endAngle;this.sweep=Math.abs(o-this.startAngle);if(this.anticlockwise){this.sweep=s-this.sweep}var l=2*Math.PI*this.radius,u=this.sweep/s,c=l*u;this.getLength=function(){return c};this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var h=1e-10,f=function(t){var e=Math.floor(t),n=Math.ceil(t);if(t-e<h){return e}else if(n-t<h){return n}return t};this.pointOnPath=function(e,n){if(e===0){return{x:this.x1,y:this.y1,theta:this.startAngle}}else if(e===1){return{x:this.x2,y:this.y2,theta:this.endAngle}}if(n){e=e/c}var i=r(this,e),a=t.cx+t.r*Math.cos(i),s=t.cy+t.r*Math.sin(i);return{x:f(a),y:f(s),theta:i}};this.gradientAtPoint=function(e,n){var a=this.pointOnPath(e,n);var r=i.normal([t.cx,t.cy],[a.x,a.y]);if(!this.anticlockwise&&(r===Infinity||r===-Infinity)){r*=-1}return r};this.pointAlongPathFrom=function(e,n,i){var a=this.pointOnPath(e,i),r=n/l*2*Math.PI,s=this.anticlockwise?-1:1,o=a.theta+s*r,u=t.cx+this.radius*Math.cos(o),c=t.cy+this.radius*Math.sin(o);return{x:u,y:c}}},Bezier:function(n){this.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}];var i=e.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)};this.type="Bezier";var a=function(e,n,i){if(i){n=t.jsBezier.locationAlongCurveFrom(e,n>0?0:1,n)}return n};this.pointOnPath=function(e,n){e=a(this.curve,e,n);return t.jsBezier.pointOnCurve(this.curve,e)};this.gradientAtPoint=function(e,n){e=a(this.curve,e,n);return t.jsBezier.gradientAtPoint(this.curve,e)};this.pointAlongPathFrom=function(e,n,i){e=a(this.curve,e,i);return t.jsBezier.pointAlongCurveFrom(this.curve,e,n)};this.getLength=function(){return t.jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds}}};e.SegmentRenderer={getPath:function(t){return{Straight:function(){var e=t.getCoordinates();return"M "+e.x1+" "+e.y1+" L "+e.x2+" "+e.y2},Bezier:function(){var e=t.params;return"M "+e.x1+" "+e.y1+" C "+e.cp1x+" "+e.cp1y+" "+e.cp2x+" "+e.cp2y+" "+e.x2+" "+e.y2},Arc:function(){var e=t.params,n=t.sweep>Math.PI?1:0,i=t.anticlockwise?0:1;return"M"+t.x1+" "+t.y1+" A "+t.radius+" "+e.r+" 0 "+n+","+i+" "+t.x2+" "+t.y2}}[t.type]()}};var a=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};e.Connectors.AbstractConnector=function(t){a.apply(this,arguments);var r=[],s=0,o=[],l=[],u=t.stub||0,c=n.isArray(u)?u[0]:u,h=n.isArray(u)?u[1]:u,f=t.gap||0,d=n.isArray(f)?f[0]:f,p=n.isArray(f)?f[1]:f,_=null,v=false,g=null,m=null,b=t.editable!==false&&e.ConnectorEditors!=null&&e.ConnectorEditors[this.type]!=null;var y=this.setGeometry=function(t,e){v=!e;m=t};var P=this.getGeometry=function(){return m};this.getPathData=function(){var t="";for(var n=0;n<r.length;n++){t+=e.SegmentRenderer.getPath(r[n]);t+=" "}return t};this.hasBeenEdited=function(){return v};this.isEditing=function(){return this.editor!=null&&this.editor.isActive()};this.setEditable=function(t){if(t&&e.ConnectorEditors!=null&&e.ConnectorEditors[this.type]!=null&&(this.overrideSetEditable==null||this.overrideSetEditable())){b=t}else{b=false}return b};this.isEditable=function(){return b};this.findSegmentForPoint=function(t,e){var n={d:Infinity,s:null,x:null,y:null,l:null};for(var i=0;i<r.length;i++){var a=r[i].findClosestPointOnPath(t,e);if(a.d<n.d){n.d=a.d;n.l=a.l;n.x=a.x;n.y=a.y;n.s=r[i];n.x1=a.x1;n.x2=a.x2;n.y1=a.y1;n.y2=a.y2;n.index=i}}return n};var x=function(){var t=0;for(var e=0;e<r.length;e++){var n=r[e].getLength();l[e]=n/s;o[e]=[t,t+=n/s]}},j=function(t,e){if(e){t=t>0?t/s:(s+t)/s}var n=o.length-1,i=1;for(var a=0;a<o.length;a++){if(o[a][1]>=t){n=a;i=t===1?1:t===0?0:(t-o[a][0])/l[a];break}}return{segment:r[n],proportion:i,index:n}},C=function(t,n,i){if(i.x1===i.x2&&i.y1===i.y2){return}var a=new e.Segments[n](i);r.push(a);s+=a.getLength();t.updateBounds(a)},E=function(){s=r.length=o.length=l.length=0};this.setSegments=function(t){_=[];s=0;for(var e=0;e<t.length;e++){_.push(t[e]);s+=t[e].getLength()}};this.getLength=function(){return s};var w=function(t){this.strokeWidth=t.strokeWidth;var e=i.quadrant(t.sourcePos,t.targetPos),n=t.targetPos[0]<t.sourcePos[0],a=t.targetPos[1]<t.sourcePos[1],r=t.strokeWidth||1,s=t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),o=t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),l=n?t.targetPos[0]:t.sourcePos[0],u=a?t.targetPos[1]:t.sourcePos[1],f=Math.abs(t.targetPos[0]-t.sourcePos[0]),_=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(s[0]===0&&s[1]===0||o[0]===0&&o[1]===0){var v=f>_?0:1,g=[1,0][v];s=[];o=[];s[v]=t.sourcePos[v]>t.targetPos[v]?-1:1;o[v]=t.sourcePos[v]>t.targetPos[v]?1:-1;s[g]=0;o[g]=0}var m=n?f+d*s[0]:d*s[0],b=a?_+d*s[1]:d*s[1],y=n?p*o[0]:f+p*o[0],P=a?p*o[1]:_+p*o[1],x=s[0]*o[0]+s[1]*o[1];var j={sx:m,sy:b,tx:y,ty:P,lw:r,xSpan:Math.abs(y-m),ySpan:Math.abs(P-b),mx:(m+y)/2,my:(b+P)/2,so:s,to:o,x:l,y:u,w:f,h:_,segment:e,startStubX:m+s[0]*c,startStubY:b+s[1]*c,endStubX:y+o[0]*h,endStubY:P+o[1]*h,isXGreaterThanStubTimes2:Math.abs(m-y)>c+h,isYGreaterThanStubTimes2:Math.abs(b-P)>c+h,opposite:x===-1,perpendicular:x===0,orthogonal:x===1,sourceAxis:s[0]===0?"y":"x",points:[l,u,f,_,m,b,y,P]};j.anchorOrientation=j.opposite?"opposite":j.orthogonal?"orthogonal":"perpendicular";return j};this.getSegments=function(){return r};this.updateBounds=function(t){var e=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,e.minX);this.bounds.maxX=Math.max(this.bounds.maxX,e.maxX);this.bounds.minY=Math.min(this.bounds.minY,e.minY);this.bounds.maxY=Math.max(this.bounds.maxY,e.maxY)};var S=function(){console.log("SEGMENTS:");for(var t=0;t<r.length;t++){console.log(r[t].type,r[t].getLength(),o[t])}};this.pointOnPath=function(t,e){var n=j(t,e);return n.segment&&n.segment.pointOnPath(n.proportion,false)||[0,0]};this.gradientAtPoint=function(t,e){var n=j(t,e);return n.segment&&n.segment.gradientAtPoint(n.proportion,false)||0};this.pointAlongPathFrom=function(t,e,n){var i=j(t,n);return i.segment&&i.segment.pointAlongPathFrom(i.proportion,e,false)||[0,0]};this.compute=function(t){g=w.call(this,t);E();this._compute(g,t);this.x=g.points[0];this.y=g.points[1];this.w=g.points[2];this.h=g.points[3];this.segment=g.segment;x()};return{addSegment:C,prepareCompute:w,sourceStub:c,targetStub:h,maxStub:Math.max(c,h),sourceGap:d,targetGap:p,maxGap:Math.max(d,p),setGeometry:y,getGeometry:P}};n.extend(e.Connectors.AbstractConnector,a);e.Endpoints.AbstractEndpoint=function(t){a.apply(this,arguments);var e=this.compute=function(t,e,n,i){var a=this._compute.apply(this,arguments);this.x=a[0];this.y=a[1];this.w=a[2];this.h=a[3];this.bounds.minX=this.x;this.bounds.minY=this.y;this.bounds.maxX=this.x+this.w;this.bounds.maxY=this.y+this.h;return a};return{compute:e,cssClass:t.cssClass}};n.extend(e.Endpoints.AbstractEndpoint,a);e.Endpoints.Dot=function(t){this.type="Dot";var n=e.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.radius=t.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(t,e,n,i){this.radius=n.radius||this.radius;var a=t[0]-this.radius,r=t[1]-this.radius,s=this.radius*2,o=this.radius*2;if(n.stroke){var l=n.strokeWidth||1;a-=l;r-=l;s+=l*2;o+=l*2}return[a,r,s,o,this.radius]}};n.extend(e.Endpoints.Dot,e.Endpoints.AbstractEndpoint);e.Endpoints.Rectangle=function(t){this.type="Rectangle";var n=e.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.width=t.width||20;this.height=t.height||20;this._compute=function(t,e,n,i){var a=n.width||this.width,r=n.height||this.height,s=t[0]-a/2,o=t[1]-r/2;return[s,o,a,r]}};n.extend(e.Endpoints.Rectangle,e.Endpoints.AbstractEndpoint);var r=function(t){e.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};n.extend(r,e.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}});e.Endpoints.Image=function(i){this.type="Image";r.apply(this,arguments);e.Endpoints.AbstractEndpoint.apply(this,arguments);var a=i.onload,s=i.src||i.url,o=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=false;this._jsPlumb.initialized=false;this._jsPlumb.deleted=false;this._jsPlumb.widthToUse=i.width;this._jsPlumb.heightToUse=i.height;this._jsPlumb.endpoint=i.endpoint;this._jsPlumb.img.onload=function(){if(this._jsPlumb!=null){this._jsPlumb.ready=true;this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width;this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height;if(a){a(this)}}}.bind(this);this._jsPlumb.endpoint.setImage=function(t,e){var n=t.constructor===String?t:t.src;a=e;this._jsPlumb.img.src=n;if(this.canvas!=null){this.canvas.setAttribute("src",this._jsPlumb.img.src)}}.bind(this);this._jsPlumb.endpoint.setImage(s,a);this._compute=function(t,e,n,i){this.anchorPoint=t;if(this._jsPlumb.ready){return[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]}else{return[0,0,0,0]}};this.canvas=e.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+o);if(this._jsPlumb.widthToUse){this.canvas.setAttribute("width",this._jsPlumb.widthToUse)}if(this._jsPlumb.heightToUse){this.canvas.setAttribute("height",this._jsPlumb.heightToUse)}this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(t,e,i){if(!this._jsPlumb.deleted){if(!this._jsPlumb.initialized){this.canvas.setAttribute("src",this._jsPlumb.img.src);this.appendDisplayElement(this.canvas);this._jsPlumb.initialized=true}var a=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,r=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;n.sizeElement(this.canvas,a,r,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(e,n){if(this._jsPlumb!=null){if(this._jsPlumb.ready){this.actuallyPaint(e,n)}else{t.setTimeout(function(){this.paint(e,n)}.bind(this),200)}}}};n.extend(e.Endpoints.Image,[r,e.Endpoints.AbstractEndpoint],{cleanup:function(t){if(t){this._jsPlumb.deleted=true;if(this.canvas){this.canvas.parentNode.removeChild(this.canvas)}this.canvas=null}}});e.Endpoints.Blank=function(t){var i=e.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";r.apply(this,arguments);this._compute=function(t,e,n,i){return[t[0],t[1],10,0]};var a=t.cssClass?" "+t.cssClass:"";this.canvas=e.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+a);this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(t,e){n.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};n.extend(e.Endpoints.Blank,[e.Endpoints.AbstractEndpoint,r],{cleanup:function(){if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}}});e.Endpoints.Triangle=function(t){this.type="Triangle";e.Endpoints.AbstractEndpoint.apply(this,arguments);var n=this;t=t||{};t.width=t.width||55;t.height=t.height||55;this.width=t.width;this.height=t.height;this._compute=function(t,e,i,a){var r=i.width||n.width,s=i.height||n.height,o=t[0]-r/2,l=t[1]-s/2;return[o,l,r,s]}};var s=e.Overlays.AbstractOverlay=function(t){this.visible=true;this.isAppendedAtTopLevel=true;this.component=t.component;this.loc=t.location==null?.5:t.location;this.endpointLoc=t.endpointLocation==null?[.5,.5]:t.endpointLocation;this.visible=t.visible!==false};s.prototype={cleanup:function(t){if(t){this.component=null;this.canvas=null;this.endpointLoc=null}},reattach:function(t){},setVisible:function(t){this.visible=t;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},incrementLocation:function(t){this.loc+=t;this.component.repaint()},setLocation:function(t){this.loc=t;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};e.Overlays.Arrow=function(t){this.type="Arrow";s.apply(this,arguments);this.isAppendedAtTopLevel=false;t=t||{};var a=this;this.length=t.length||20;this.width=t.width||20;this.id=t.id;var r=(t.direction||1)<0?-1:1,o=t.paintStyle||{"stroke-width":1},l=t.foldback||.623;this.computeMaxSize=function(){return a.width*1.5};this.elementCreated=function(n,i){this.path=n;if(t.events){for(var a in t.events){e.on(n,a,t.events[a])}}};this.draw=function(t,e){var a,s,u,c,h;if(t.pointAlongPathFrom){if(n.isString(this.loc)||this.loc>1||this.loc<0){var f=parseInt(this.loc,10),d=this.loc<0?1:0;a=t.pointAlongPathFrom(d,f,false);s=t.pointAlongPathFrom(d,f-r*this.length/2,false);u=i.pointOnLine(a,s,this.length)}else if(this.loc===1){a=t.pointOnPath(this.loc);s=t.pointAlongPathFrom(this.loc,-this.length);u=i.pointOnLine(a,s,this.length);if(r===-1){var p=u;u=a;a=p}}else if(this.loc===0){u=t.pointOnPath(this.loc);s=t.pointAlongPathFrom(this.loc,this.length);a=i.pointOnLine(u,s,this.length);if(r===-1){var _=u;u=a;a=_}}else{a=t.pointAlongPathFrom(this.loc,r*this.length/2);s=t.pointOnPath(this.loc);u=i.pointOnLine(a,s,this.length)}c=i.perpendicularLineTo(a,u,this.width);h=i.pointOnLine(a,u,l*this.length);var v={hxy:a,tail:c,cxy:h},g=o.stroke||e.stroke,m=o.fill||e.stroke,b=o.strokeWidth||e.strokeWidth;return{component:t,d:v,"stroke-width":b,stroke:g,fill:m,minX:Math.min(a.x,c[0].x,c[1].x),maxX:Math.max(a.x,c[0].x,c[1].x),minY:Math.min(a.y,c[0].y,c[1].y),maxY:Math.max(a.y,c[0].y,c[1].y)}}else{return{component:t,minX:0,maxX:0,minY:0,maxY:0}}}};n.extend(e.Overlays.Arrow,s,{updateFrom:function(t){this.length=t.length||this.length;this.width=t.width||this.width;this.direction=t.direction!=null?t.direction:this.direction;this.foldback=t.foldback||this.foldback}});e.Overlays.PlainArrow=function(t){t=t||{};var n=e.extend(t,{foldback:1});e.Overlays.Arrow.call(this,n);this.type="PlainArrow"};n.extend(e.Overlays.PlainArrow,e.Overlays.Arrow);e.Overlays.Diamond=function(t){t=t||{};var n=t.length||40,i=e.extend(t,{length:n/2,foldback:2});e.Overlays.Arrow.call(this,i);this.type="Diamond"};n.extend(e.Overlays.Diamond,e.Overlays.Arrow);var o=function(t,e){if(t._jsPlumb.cachedDimensions==null||e){t._jsPlumb.cachedDimensions=t.getDimensions()}return t._jsPlumb.cachedDimensions};var l=function(t){e.jsPlumbUIComponent.apply(this,arguments);s.apply(this,arguments);var i=this.fire;this.fire=function(){i.apply(this,arguments);if(this.component){this.component.fire.apply(this.component,arguments)}};this.detached=false;this.id=t.id;this._jsPlumb.div=null;this._jsPlumb.initialised=false;this._jsPlumb.component=t.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=t.create;this._jsPlumb.initiallyInvisible=t.visible===false;this.getElement=function(){if(this._jsPlumb.div==null){var n=this._jsPlumb.div=e.getElement(this._jsPlumb.create(this._jsPlumb.component));n.style.position="absolute";n.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"");this._jsPlumb.instance.appendElement(n);this._jsPlumb.instance.getId(n);this.canvas=n;var i="translate(-50%, -50%)";n.style.webkitTransform=i;n.style.mozTransform=i;n.style.msTransform=i;n.style.oTransform=i;n.style.transform=i;n._jsPlumb=this;if(t.visible===false){n.style.display="none"}}return this._jsPlumb.div};this.draw=function(t,e,i){var a=o(this);if(a!=null&&a.length===2){var r={x:0,y:0};if(i){r={x:i[0],y:i[1]}}else if(t.pointOnPath){var s=this.loc,l=false;if(n.isString(this.loc)||this.loc<0||this.loc>1){s=parseInt(this.loc,10);l=true}r=t.pointOnPath(s,l)}else{var u=this.loc.constructor===Array?this.loc:this.endpointLoc;r={x:u[0]*t.w,y:u[1]*t.h}}var c=r.x-a[0]/2,h=r.y-a[1]/2;return{component:t,d:{minx:c,miny:h,td:a,cxy:r},minX:c,maxX:c+a[0],minY:h,maxY:h+a[1]}}else{return{minX:0,maxX:0,minY:0,maxY:0}}}};n.extend(l,[e.jsPlumbUIComponent,s],{getDimensions:function(){return[1,1]},setVisible:function(t){if(this._jsPlumb.div){this._jsPlumb.div.style.display=t?"block":"none";if(t&&this._jsPlumb.initiallyInvisible){o(this,true);this.component.repaint();this._jsPlumb.initiallyInvisible=false}}},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){if(t){if(this._jsPlumb.div!=null){this._jsPlumb.div._jsPlumb=null;this._jsPlumb.instance.removeElement(this._jsPlumb.div)}}else{if(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode){this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)}this.detached=true}},reattach:function(t){if(this._jsPlumb.div!=null){t.getContainer().appendChild(this._jsPlumb.div)}this.detached=false},computeMaxSize:function(){var t=o(this);return Math.max(t[0],t[1])},paint:function(t,e){if(!this._jsPlumb.initialised){this.getElement();t.component.appendDisplayElement(this._jsPlumb.div);this._jsPlumb.initialised=true;if(this.detached){this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)}}this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px";this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}});e.Overlays.Custom=function(t){this.type="Custom";l.apply(this,arguments)};n.extend(e.Overlays.Custom,l);e.Overlays.GuideLines=function(){var t=this;t.length=50;t.strokeWidth=5;this.type="GuideLines";s.apply(this,arguments);e.jsPlumbUIComponent.apply(this,arguments);this.draw=function(e,n){var a=e.pointAlongPathFrom(t.loc,t.length/2),r=e.pointOnPath(t.loc),s=i.pointOnLine(a,r,t.length),o=i.perpendicularLineTo(a,s,40),l=i.perpendicularLineTo(s,a,20);return{connector:e,head:a,tail:s,headLine:l,tailLine:o,minX:Math.min(a.x,s.x,l[0].x,l[1].x),minY:Math.min(a.y,s.y,l[0].y,l[1].y),maxX:Math.max(a.x,s.x,l[0].x,l[1].x),maxY:Math.max(a.y,s.y,l[0].y,l[1].y)}}};e.Overlays.Label=function(t){this.labelStyle=t.labelStyle;var n=null,i=null,a=null,r=null;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var s=e.extend({create:function(){return e.createElement("div")}},t);e.Overlays.Custom.call(this,s);this.type="Label";this.label=t.label||"";this.labelText=null;if(this.labelStyle){var o=this.getElement();this.labelStyle.font=this.labelStyle.font||"12px sans-serif";o.style.font=this.labelStyle.font;o.style.color=this.labelStyle.color||"black";if(this.labelStyle.fill){o.style.background=this.labelStyle.fill}if(this.labelStyle.borderWidth>0){var l=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";o.style.border=this.labelStyle.borderWidth+"px solid "+l}if(this.labelStyle.padding){o.style.padding=this.labelStyle.padding}}};n.extend(e.Overlays.Label,e.Overlays.Custom,{cleanup:function(t){if(t){this.div=null;this.label=null;this.labelText=null;this.cssClass=null;this.labelStyle=null}},getLabel:function(){return this.label},setLabel:function(t){this.label=t;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){this.update();return l.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label==="function"){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else{if(this.labelText==null){this.labelText=this.label;this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>")}}},updateFrom:function(t){if(t.label!=null){this.setLabel(t.label)}}})}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb;var n=function(e){var n=e._mottle;if(!n){n=e._mottle=new t.Mottle}return n};e.extend(t.jsPlumbInstance.prototype,{getEventManager:function(){return n(this)},on:function(t,e,n){this.getEventManager().on.apply(this,arguments);return this},off:function(t,e,n){this.getEventManager().off.apply(this,arguments);return this}})}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumbUtil,n=t.jsPlumbInstance;var i="jtk-group-collapsed";var a="jtk-group-expanded";var r="[jtk-group-content]";var s="elementDraggable";var o="stop";var l="revert";var u="_groupManager";var c="_jsPlumbGroup";var h="_jsPlumbGroupDrag";var f="group:addMember";var d="group:removeMember";var p="group:add";var _="group:remove";var v="group:expand";var g="group:collapse";var m="groupDragStop";var b="connectionMoved";var y="internal.connectionDetached";var P="removeAll";var x="orphanAll";var j="show";var C="hide";var E=function(t){var n={},r={},s={},o=this;t.bind("connection",function(t){if(t.source[c]!=null&&t.target[c]!=null&&t.source[c]===t.target[c]){r[t.connection.id]=t.source[c];s[t.connection.id]=t.source[c]}else{if(t.source[c]!=null){e.suggest(t.source[c].connections.source,t.connection);r[t.connection.id]=t.source[c]}if(t.target[c]!=null){e.suggest(t.target[c].connections.target,t.connection);s[t.connection.id]=t.target[c]}}});function l(t){delete t.proxies;var n=r[t.id],i;if(n!=null){i=function(e){return e.id===t.id};e.removeWithFunction(n.connections.source,i);e.removeWithFunction(n.connections.target,i);delete r[t.id]}n=s[t.id];if(n!=null){i=function(e){return e.id===t.id};e.removeWithFunction(n.connections.source,i);e.removeWithFunction(n.connections.target,i);delete s[t.id]}}t.bind(y,function(t){l(t.connection)});t.bind(b,function(t){var e=t.index===0?r:s;var n=e[t.connection.id];if(n){var i=n.connections[t.index===0?"source":"target"];var a=i.indexOf(t.connection);if(a!==-1){i.splice(a,1)}}});this.addGroup=function(e){t.addClass(e.getEl(),a);n[e.id]=e;e.manager=this;m(e);t.fire(p,{group:e})};this.addToGroup=function(e,n,i){e=this.getGroup(e);if(e){var a=e.getEl();if(n._isJsPlumbGroup){return}var r=n._jsPlumbGroup;if(r!==e){var s=t.getOffset(n,true);var l=e.collapsed?t.getOffset(a,true):t.getOffset(e.getDragArea(),true);if(r!=null){r.remove(n,i);o.updateConnectionsForGroup(r)}e.add(n,i);var u=function(t,n){var i=n===0?1:0;t.each(function(t){t.setVisible(false);if(t.endpoints[i].element._jsPlumbGroup===e){t.endpoints[i].setVisible(false);o.expandConnection(t,i,e)}else{t.endpoints[n].setVisible(false);o.collapseConnection(t,n,e)}})};if(e.collapsed){u(t.select({source:n}),0);u(t.select({target:n}),1)}var c=t.getId(n);t.dragManager.setParent(n,c,a,t.getId(a),s);var h={left:s.left-l.left,top:s.top-l.top};t.setPosition(n,h);t.dragManager.revalidateParent(n,c,s);o.updateConnectionsForGroup(e);t.revalidate(c);setTimeout(function(){t.fire(f,{group:e,el:n})},0)}}};this.removeFromGroup=function(t,e,n){t=this.getGroup(t);if(t){t.remove(e,null,n)}};this.getGroup=function(t){var i=t;if(e.isString(t)){i=n[t];if(i==null){throw new TypeError("No such group ["+t+"]")}}return i};this.getGroups=function(){var t=[];for(var e in n){t.push(n[e])}return t};this.removeGroup=function(e,i,a,r){e=this.getGroup(e);this.expandGroup(e,true);e[i?P:x](a,r);t.remove(e.getEl());delete n[e.id];delete t._groups[e.id];t.fire(_,{group:e})};this.removeAllGroups=function(t,e,i){for(var a in n){this.removeGroup(n[a],t,e,i)}};function u(e,n){var i=e.getMembers();for(var a=0;a<i.length;a++){t[n?j:C](i[a],true)}}var h=this.collapseConnection=function(e,n,i){var a,r=i.getEl(),s=t.getId(r),o=e.endpoints[n].elementId;var l=e.endpoints[n===0?1:0].element;if(l[c]&&(!l[c].shouldProxy()&&l[c].collapsed)){return}e.proxies=e.proxies||[];if(e.proxies[n]){a=e.proxies[n].ep}else{a=t.addEndpoint(r,{endpoint:i.getEndpoint(e,n),anchor:i.getAnchor(e,n),parameters:{isProxyEndpoint:true}})}a.setDeleteOnEmpty(true);e.proxies[n]={ep:a,originalEp:e.endpoints[n]};if(n===0){t.anchorManager.sourceChanged(o,s,e,r)}else{t.anchorManager.updateOtherEndpoint(e.endpoints[0].elementId,o,s,e);e.target=r;e.targetId=s}e.proxies[n].originalEp.detachFromConnection(e,null,true);a.connections=[e];e.endpoints[n]=a;e.setVisible(true)};this.collapseGroup=function(e){e=this.getGroup(e);if(e==null||e.collapsed){return}var n=e.getEl();u(e,false);if(e.shouldProxy()){var r=function(t,n){for(var i=0;i<t.length;i++){var a=t[i];h(a,n,e)}};r(e.connections.source,0);r(e.connections.target,1)}e.collapsed=true;t.removeClass(n,a);t.addClass(n,i);t.revalidate(n);t.fire(g,{group:e})};var d=this.expandConnection=function(e,n,i){if(e.proxies==null||e.proxies[n]==null){return}var a=t.getId(i.getEl()),r=e.proxies[n].originalEp.element,s=e.proxies[n].originalEp.elementId;e.endpoints[n]=e.proxies[n].originalEp;if(n===0){t.anchorManager.sourceChanged(a,s,e,r)}else{t.anchorManager.updateOtherEndpoint(e.endpoints[0].elementId,a,s,e);e.target=r;e.targetId=s}e.proxies[n].ep.detachFromConnection(e,null);e.proxies[n].originalEp.addConnection(e);delete e.proxies[n]};this.expandGroup=function(e,n){e=this.getGroup(e);if(e==null||!e.collapsed){return}var r=e.getEl();u(e,true);if(e.shouldProxy()){var s=function(t,n){for(var i=0;i<t.length;i++){var a=t[i];d(a,n,e)}};s(e.connections.source,0);s(e.connections.target,1)}e.collapsed=false;t.addClass(r,a);t.removeClass(r,i);t.revalidate(r);this.repaintGroup(e);if(!n){t.fire(v,{group:e})}};this.repaintGroup=function(e){e=this.getGroup(e);var n=e.getMembers();for(var i=0;i<n.length;i++){t.revalidate(n[i])}};function m(e){var n=e.getMembers();var i=t.getConnections({source:n},true);var a=t.getConnections({target:n},true);var o={};e.connections.source.length=0;e.connections.target.length=0;var l=function(t){for(var n=0;n<t.length;n++){if(o[t[n].id]){continue}o[t[n].id]=true;if(t[n].source._jsPlumbGroup===e){if(t[n].target._jsPlumbGroup!==e){e.connections.source.push(t[n])}r[t[n].id]=e}else if(t[n].target._jsPlumbGroup===e){e.connections.target.push(t[n]);s[t[n].id]=e}}};l(i);l(a)}this.updateConnectionsForGroup=m;this.refreshAllGroups=function(){for(var e in n){m(n[e]);t.dragManager.updateOffsets(t.getId(n[e].getEl()))}}};var w=function(n,i){var a=this;var u=i.el;this.getEl=function(){return u};this.id=i.id||e.uuid();u._isJsPlumbGroup=true;var p=this.getDragArea=function(){var t=n.getSelector(u,r);return t&&t.length>0?t[0]:u};var _=i.ghost===true;var v=_||i.constrain===true;var g=i.revert!==false;var b=i.orphan===true;var y=i.prune===true;var P=i.dropOverride===true;var x=i.proxied!==false;var j=[];this.connections={source:[],target:[],internal:[]};this.getAnchor=function(t,e){return i.anchor||"Continuous"};this.getEndpoint=function(t,e){return i.endpoint||["Dot",{radius:10}]};this.collapsed=false;if(i.draggable!==false){var C={stop:function(t){n.fire(m,jsPlumb.extend(t,{group:a}))},scope:h};if(i.dragOptions){t.jsPlumb.extend(C,i.dragOptions)}n.draggable(i.el,C)}if(i.droppable!==false){n.droppable(i.el,{drop:function(t){var e=t.drag.el;if(e._isJsPlumbGroup){return}var i=e._jsPlumbGroup;if(i!==a){if(i!=null){if(i.overrideDrop(e,a)){return}}n.getGroupManager().addToGroup(a,e,false)}}})}var E=function(t,e){var n=t.nodeType==null?t:[t];for(var i=0;i<n.length;i++){e(n[i])}};this.overrideDrop=function(t,e){return P&&(g||y||b)};this.add=function(t,e){var i=p();E(t,function(t){if(t._jsPlumbGroup!=null){if(t._jsPlumbGroup===a){return
}else{t._jsPlumbGroup.remove(t,true,e,false)}}t._jsPlumbGroup=a;j.push(t);if(n.isAlreadyDraggable(t)){k(t)}if(t.parentNode!==i){i.appendChild(t)}if(!e){n.fire(f,{group:a,el:t})}});n.getGroupManager().updateConnectionsForGroup(a)};this.remove=function(t,i,r,s){E(t,function(t){delete t._jsPlumbGroup;e.removeWithFunction(j,function(e){return e===t});if(i){try{a.getDragArea().removeChild(t)}catch(s){jsPlumbUtil.log("Could not remove element from Group "+s)}}T(t);if(!r){n.fire(d,{group:a,el:t})}});if(!s){n.getGroupManager().updateConnectionsForGroup(a)}};this.removeAll=function(t,e){for(var i=0,r=j.length;i<r;i++){a.remove(j[0],t,e,true)}j.length=0;n.getGroupManager().updateConnectionsForGroup(a)};this.orphanAll=function(){for(var t=0;t<j.length;t++){D(j[t])}j.length=0};this.getMembers=function(){return j};u[c]=this;n.bind(s,function(t){if(t.el._jsPlumbGroup===this){k(t.el)}}.bind(this));function w(t){return t.offsetParent}function S(t,e){var i=w(t),a=n.getSize(i),r=n.getSize(t),s=e[0],o=s+r[0],l=e[1],u=l+r[1];return o>0&&s<a[0]&&u>0&&l<a[1]}function D(t){var e=n.getId(t);var i=n.getOffset(t);t.parentNode.removeChild(t);n.getContainer().appendChild(t);n.setPosition(t,i);delete t._jsPlumbGroup;T(t);n.dragManager.clearParent(t,e)}function I(t){if(!S(t.el,t.pos)){var e=t.el._jsPlumbGroup;if(y){n.remove(t.el)}else{D(t.el)}e.remove(t.el)}}function A(t){var e=n.getId(t);n.revalidate(t);n.dragManager.revalidateParent(t,e)}function T(t){if(!t._katavorioDrag){return}if(y||b){t._katavorioDrag.off(o,I)}if(!y&&!b&&g){t._katavorioDrag.off(l,A);t._katavorioDrag.setRevert(null)}}function k(t){if(!t._katavorioDrag){return}if(y||b){t._katavorioDrag.on(o,I)}if(v){t._katavorioDrag.setConstrain(true)}if(_){t._katavorioDrag.setUseGhostProxy(true)}if(!y&&!b&&g){t._katavorioDrag.on(l,A);t._katavorioDrag.setRevert(function(t,e){return!S(t,e)})}}this.shouldProxy=function(){return x};n.getGroupManager().addGroup(this)};n.prototype.addGroup=function(t){var e=this;e._groups=e._groups||{};if(e._groups[t.id]!=null){throw new TypeError("cannot create Group ["+t.id+"]; a Group with that ID exists")}if(t.el[c]!=null){throw new TypeError("cannot create Group ["+t.id+"]; the given element is already a Group")}var n=new w(e,t);e._groups[n.id]=n;if(t.collapsed){this.collapseGroup(n)}return n};n.prototype.addToGroup=function(t,e,n){var i=function(e){var i=this.getId(e);this.manage(i,e);this.getGroupManager().addToGroup(t,e,n)}.bind(this);if(Array.isArray(e)){for(var a=0;a<e.length;a++){i(e[a])}}else{i(e)}};n.prototype.removeFromGroup=function(t,e,n){this.getGroupManager().removeFromGroup(t,e,n)};n.prototype.removeGroup=function(t,e,n,i){this.getGroupManager().removeGroup(t,e,n,i)};n.prototype.removeAllGroups=function(t,e,n){this.getGroupManager().removeAllGroups(t,e,n)};n.prototype.getGroup=function(t){return this.getGroupManager().getGroup(t)};n.prototype.getGroups=function(){return this.getGroupManager().getGroups()};n.prototype.expandGroup=function(t){this.getGroupManager().expandGroup(t)};n.prototype.collapseGroup=function(t){this.getGroupManager().collapseGroup(t)};n.prototype.repaintGroup=function(t){this.getGroupManager().repaintGroup(t)};n.prototype.toggleGroup=function(t){t=this.getGroupManager().getGroup(t);if(t!=null){this.getGroupManager()[t.collapsed?"expandGroup":"collapseGroup"](t)}};n.prototype.getGroupManager=function(){var t=this[u];if(t==null){t=this[u]=new E(this)}return t};n.prototype.removeGroupManager=function(){delete this[u]};n.prototype.getGroupFor=function(t){t=this.getElement(t);if(t){return t[c]}}}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i=function(t){this.type="Flowchart";t=t||{};t.stub=t.stub==null?30:t.stub;var n,i=e.Connectors.AbstractConnector.apply(this,arguments),a=t.midpoint==null?.5:t.midpoint,r=t.alwaysRespectStubs===true,s=null,o=null,l,u=t.cornerRadius!=null?t.cornerRadius:0,c=t.loopbackRadius||25,h=false,f=function(t){return t<0?-1:t===0?0:1},d=function(t,e,n,i){if(s===e&&o===n){return}var a=s==null?i.sx:s,r=o==null?i.sy:o,l=a===e?"v":"h",u=f(e-a),c=f(n-r);s=e;o=n;t.push([a,r,e,n,l,u,c])},p=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},_=function(t){var e=[];e.push.apply(e,t);return e},v=function(t,e,n){var a=null,r;for(var s=0;s<e.length-1;s++){a=a||_(e[s]);r=_(e[s+1]);if(u>0&&a[4]!==r[4]){var o=Math.min(u,p(a),p(r));a[2]-=a[5]*o;a[3]-=a[6]*o;r[0]+=r[5]*o;r[1]+=r[6]*o;var l=a[6]===r[5]&&r[5]===1||a[6]===r[5]&&r[5]===0&&a[5]!==r[6]||a[6]===r[5]&&r[5]===-1,c=r[1]>a[3]?1:-1,h=r[0]>a[2]?1:-1,f=c===h,d=f&&l||!f&&!l?r[0]:a[2],v=f&&l||!f&&!l?a[3]:r[1];i.addSegment(t,"Straight",{x1:a[0],y1:a[1],x2:a[2],y2:a[3]});i.addSegment(t,"Arc",{r:o,x1:a[2],y1:a[3],x2:r[0],y2:r[1],cx:d,cy:v,ac:l})}else{var g=a[2]===a[0]?0:a[2]>a[0]?n.lw/2:-(n.lw/2),m=a[3]===a[1]?0:a[3]>a[1]?n.lw/2:-(n.lw/2);i.addSegment(t,"Straight",{x1:a[0]-g,y1:a[1]-m,x2:a[2]+g,y2:a[3]+m})}a=r}if(r!=null){i.addSegment(t,"Straight",{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})}};this._compute=function(t,e){n=[];s=null;o=null;l=null;var u=function(){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},h={perpendicular:u,orthogonal:u,opposite:function(e){var n=t,i=e==="x"?0:1,a={x:function(){return n.so[i]===1&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||n.so[i]===-1&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return n.so[i]===1&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||n.so[i]===-1&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}};if(!r&&a[e]()){return{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]}else{return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}}};var f=h[t.anchorOrientation](t.sourceAxis),p=t.sourceAxis==="x"?0:1,_=t.sourceAxis==="x"?1:0,g=f[p],m=f[_],b=f[p+2],y=f[_+2];d(n,f[0],f[1],t);if(false&&e.sourcePos[0]===e.targetPos[0]&&e.sourcePos[1]===e.targetPos[1]){d(n,f[0]-c,f[1],t);d(n,f[0]-c,f[1]-2*c,t);d(n,f[0]+c,f[1]-2*c,t);d(n,f[0]+c,f[1],t);d(n,f[0],f[1],t)}else{var P=t.startStubX+(t.endStubX-t.startStubX)*a,x=t.startStubY+(t.endStubY-t.startStubY)*a;var j={x:[0,1],y:[1,0]},C={perpendicular:function(e){var n=t,i={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},a={x:[[n.startStubX,n.endStubX],null,[n.endStubX,n.startStubX]],y:[[n.startStubY,n.endStubY],null,[n.endStubY,n.startStubY]]},r={x:[[P,n.startStubY],[P,n.endStubY]],y:[[n.startStubX,x],[n.endStubX,x]]},s={x:[[n.endStubX,n.startStubY]],y:[[n.startStubX,n.endStubY]]},o={x:[[n.startStubX,n.endStubY],[n.endStubX,n.endStubY]],y:[[n.endStubX,n.startStubY],[n.endStubX,n.endStubY]]},l={x:[[n.startStubX,x],[n.endStubX,x],[n.endStubX,n.endStubY]],y:[[P,n.startStubY],[P,n.endStubY],[n.endStubX,n.endStubY]]},u={x:[n.startStubY,n.endStubY],y:[n.startStubX,n.endStubX]},c=j[e][0],h=j[e][1],f=n.so[c]+1,d=n.to[h]+1,p=n.to[h]===-1&&u[e][1]<u[e][0]||n.to[h]===1&&u[e][1]>u[e][0],_=a[e][f][0],v=a[e][f][1],g=i[e][f][d];if(n.segment===g[3]||n.segment===g[2]&&p){return r[e]}else if(n.segment===g[2]&&v<_){return s[e]}else if(n.segment===g[2]&&v>=_||n.segment===g[1]&&!p){return l[e]}else if(n.segment===g[0]||n.segment===g[1]&&p){return o[e]}},orthogonal:function(e,n,i,a,r){var s=t,o={x:s.so[0]===-1?Math.min(n,a):Math.max(n,a),y:s.so[1]===-1?Math.min(n,a):Math.max(n,a)}[e];return{x:[[o,i],[o,r],[a,r]],y:[[i,o],[r,o],[r,a]]}[e]},opposite:function(n,a,r,s){var o=t,l={x:"y",y:"x"}[n],u={x:"height",y:"width"}[n],c=o["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var h=r+(1-e.sourceEndpoint.anchor[l])*e.sourceInfo[u]+i.maxStub;return{x:[[a,h],[s,h]],y:[[h,a],[h,s]]}[n]}else if(!c||o.so[p]===1&&a>s||o.so[p]===-1&&a<s){return{x:[[a,x],[s,x]],y:[[P,a],[P,s]]}[n]}else if(o.so[p]===1&&a<s||o.so[p]===-1&&a>s){return{x:[[P,o.sy],[P,o.ty]],y:[[o.sx,x],[o.tx,x]]}[n]}}};var E=C[t.anchorOrientation](t.sourceAxis,g,m,b,y);if(E){for(var w=0;w<E.length;w++){d(n,E[w][0],E[w][1],t)}}d(n,f[2],f[3],t)}d(n,t.tx,t.ty,t);v(this,n,t)}};n.extend(i,e.Connectors.AbstractConnector);e.registerConnectorType(i,"Flowchart")}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;e.Connectors.AbstractBezierConnector=function(t){t=t||{};var n=t.showLoopback!==false,i=t.curviness||10,a=t.margin||5,r=t.proximityLimit||80,s=t.orientation&&t.orientation==="clockwise",o=t.loopbackRadius||25,l=false,u;this.overrideSetEditable=function(){return!l};this._compute=function(t,e){var i=e.sourcePos,r=e.targetPos,c=Math.abs(i[0]-r[0]),h=Math.abs(i[1]-r[1]);if(!n||e.sourceEndpoint.elementId!==e.targetEndpoint.elementId){l=false;this._computeBezier(t,e,i,r,c,h)}else{l=true;var f=e.sourcePos[0],d=e.sourcePos[1]-a,p=f,_=d-o,v=p-o,g=_-o;c=2*o;h=2*o;t.points[0]=v;t.points[1]=g;t.points[2]=c;t.points[3]=h;u.addSegment(this,"Arc",{loopback:true,x1:f-v+4,y1:d-g,startAngle:0,endAngle:2*Math.PI,r:o,ac:!s,x2:f-v-4,y2:d-g,cx:p-v,cy:_-g})}};u=e.Connectors.AbstractConnector.apply(this,arguments);return u};n.extend(e.Connectors.AbstractBezierConnector,e.Connectors.AbstractConnector);var i=function(t){t=t||{};this.type="Bezier";var n=e.Connectors.AbstractBezierConnector.apply(this,arguments),i=t.curviness||150,a=10;this.getCurviness=function(){return i};this._findControlPoint=function(t,e,n,r,s,o,l){var u=o[0]!==l[0]||o[1]===l[1],c=[];if(!u){if(o[0]===0){c.push(e[0]<n[0]?t[0]+a:t[0]-a)}else{c.push(t[0]-i*o[0])}if(o[1]===0){c.push(e[1]<n[1]?t[1]+a:t[1]-a)}else{c.push(t[1]+i*l[1])}}else{if(l[0]===0){c.push(n[0]<e[0]?t[0]+a:t[0]-a)}else{c.push(t[0]+i*l[0])}if(l[1]===0){c.push(n[1]<e[1]?t[1]+a:t[1]-a)}else{c.push(t[1]+i*o[1])}}return c};this._computeBezier=function(t,e,i,a,r,s){var o=this.getGeometry(),l,u,c=i[0]<a[0]?r:0,h=i[1]<a[1]?s:0,f=i[0]<a[0]?0:r,d=i[1]<a[1]?0:s;if((this.hasBeenEdited()||this.isEditing())&&o!=null&&o.controlPoints!=null&&o.controlPoints[0]!=null&&o.controlPoints[1]!=null){l=o.controlPoints[0];u=o.controlPoints[1]}else{l=this._findControlPoint([c,h],i,a,e.sourceEndpoint,e.targetEndpoint,t.so,t.to);u=this._findControlPoint([f,d],a,i,e.targetEndpoint,e.sourceEndpoint,t.to,t.so)}n.setGeometry({controlPoints:[l,u]},true);n.addSegment(this,"Bezier",{x1:c,y1:h,x2:f,y2:d,cp1x:l[0],cp1y:l[1],cp2x:u[0],cp2y:u[1]})}};n.extend(i,e.Connectors.AbstractBezierConnector);e.registerConnectorType(i,"Bezier")}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i=function(t,e,n,i){if(t<=n&&i<=e){return 1}else if(t<=n&&e<=i){return 2}else if(n<=t&&i>=e){return 3}return 4},a=function(t,e,n,i,a,r,s,o,l){if(o<=l){return[t,e]}if(n===1){if(i[3]<=0&&a[3]>=1){return[t+(i[2]<.5?-1*r:r),e]}else if(i[2]>=1&&a[2]<=0){return[t,e+(i[3]<.5?-1*s:s)]}else{return[t+-1*r,e+-1*s]}}else if(n===2){if(i[3]>=1&&a[3]<=0){return[t+(i[2]<.5?-1*r:r),e]}else if(i[2]>=1&&a[2]<=0){return[t,e+(i[3]<.5?-1*s:s)]}else{return[t+r,e+-1*s]}}else if(n===3){if(i[3]>=1&&a[3]<=0){return[t+(i[2]<.5?-1*r:r),e]}else if(i[2]<=0&&a[2]>=1){return[t,e+(i[3]<.5?-1*s:s)]}else{return[t+-1*r,e+-1*s]}}else if(n===4){if(i[3]<=0&&a[3]>=1){return[t+(i[2]<.5?-1*r:r),e]}else if(i[2]<=0&&a[2]>=1){return[t,e+(i[3]<.5?-1*s:s)]}else{return[t+r,e+-1*s]}}};var r=function(t){t=t||{};this.type="StateMachine";var n=e.Connectors.AbstractBezierConnector.apply(this,arguments),r=t.curviness||10,s=t.margin||5,o=t.proximityLimit||80,l=t.orientation&&t.orientation==="clockwise",u;this._computeBezier=function(t,e,l,c,h,f){var d=e.sourcePos[0]<e.targetPos[0]?0:h,p=e.sourcePos[1]<e.targetPos[1]?0:f,_=e.sourcePos[0]<e.targetPos[0]?h:0,v=e.sourcePos[1]<e.targetPos[1]?f:0;if(e.sourcePos[2]===0){d-=s}if(e.sourcePos[2]===1){d+=s}if(e.sourcePos[3]===0){p-=s}if(e.sourcePos[3]===1){p+=s}if(e.targetPos[2]===0){_-=s}if(e.targetPos[2]===1){_+=s}if(e.targetPos[3]===0){v-=s}if(e.targetPos[3]===1){v+=s}var g=(d+_)/2,m=(p+v)/2,b=i(d,p,_,v),y=Math.sqrt(Math.pow(_-d,2)+Math.pow(v-p,2)),P,x,j,C,E=n.getGeometry();if((this.hasBeenEdited()||this.isEditing())&&E!=null){P=E.controlPoints[0][0];j=E.controlPoints[0][1];x=E.controlPoints[1][0];C=E.controlPoints[1][1]}else{u=a(g,m,b,e.sourcePos,e.targetPos,r,r,y,o);P=u[0];x=u[0];j=u[1];C=u[1];n.setGeometry({controlPoints:[u,u]},true)}n.addSegment(this,"Bezier",{x1:_,y1:v,x2:d,y2:p,cp1x:P,cp1y:j,cp2x:x,cp2y:C})}};n.extend(r,e.Connectors.AbstractBezierConnector);e.registerConnectorType(r,"StateMachine")}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i="Straight";var a=function(t){this.type=i;var n=e.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t,e){n.addSegment(this,i,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY});n.addSegment(this,i,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY});n.addSegment(this,i,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};n.extend(a,e.Connectors.AbstractConnector);e.registerConnectorType(a,i)}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil;var i={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},a="stroke-dasharray",r="dashstyle",s="linearGradient",o="radialGradient",l="defs",u="fill",c="stop",h="stroke",f="stroke-width",d="style",p="none",_="jsplumb_gradient_",v="strokeWidth",g={svg:"http://www.w3.org/2000/svg"},m=function(t,e){for(var n in e){t.setAttribute(n,""+e[n])}},b=function(t,n){n=n||{};n.version="1.1";n.xmlns=g.svg;return e.createElementNS(g.svg,t,null,null,n)},y=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},P=function(t){var e=t.querySelectorAll(" defs,linearGradient,radialGradient");for(var n=0;n<e.length;n++){e[n].parentNode.removeChild(e[n])}},x=function(t,e,n,i,a){var r=_+a._jsPlumb.instance.idstamp();P(t);var f;if(!n.gradient.offset){f=b(s,{id:r,gradientUnits:"userSpaceOnUse"})}else{f=b(o,{id:r})}var d=b(l);t.appendChild(d);d.appendChild(f);for(var p=0;p<n.gradient.stops.length;p++){var v=a.segment===1||a.segment===2?p:n.gradient.stops.length-1-p,g=n.gradient.stops[v][1],m=b(c,{offset:Math.floor(n.gradient.stops[p][0]*100)+"%","stop-color":g});f.appendChild(m)}var y=n.stroke?h:u;e.setAttribute(y,"url(#"+r+")")},j=function(t,e,n,s,o){e.setAttribute(u,n.fill?n.fill:p);e.setAttribute(h,n.stroke?n.stroke:p);if(n.gradient){x(t,e,n,s,o)}else{P(t);e.setAttribute(d,"")}if(n.strokeWidth){e.setAttribute(f,n.strokeWidth)}if(n[r]&&n[v]&&!n[a]){var l=n[r].indexOf(",")===-1?" ":",",c=n[r].split(l),_="";c.forEach(function(t){_+=Math.floor(t*n.strokeWidth)+l});e.setAttribute(a,_)}else if(n[a]){e.setAttribute(a,n[a])}for(var g in i){if(n[g]){e.setAttribute(i[g],n[g])}}},C=function(t,e,n){if(t.childNodes.length>n){t.insertBefore(e,t.childNodes[n])}else{t.appendChild(e)}};n.svg={node:b,attr:m,pos:y};var E=function(t){var i=t.pointerEventsSpec||"all",a={};e.jsPlumbUIComponent.apply(this,t.originalArgs);this.canvas=null;this.path=null;this.svg=null;this.bgCanvas=null;var r=t.cssClass+" "+(t.originalArgs[0].cssClass||""),s={style:"",width:0,height:0,"pointer-events":i,position:"absolute"};this.svg=b("svg",s);if(t.useDivWrapper){this.canvas=e.createElement("div",{position:"absolute"});n.sizeElement(this.canvas,0,0,1,1);this.canvas.className=r}else{m(this.svg,{"class":r});this.canvas=this.svg}t._jsPlumb.appendElement(this.canvas,t.originalArgs[0].parent);if(t.useDivWrapper){this.canvas.appendChild(this.svg)}var o=[this.canvas];this.getDisplayElements=function(){return o};this.appendDisplayElement=function(t){o.push(t)};this.paint=function(e,i,r){if(e!=null){var s=[this.x,this.y],o=[this.w,this.h],l;if(r!=null){if(r.xmin<0){s[0]+=r.xmin}if(r.ymin<0){s[1]+=r.ymin}o[0]=r.xmax+(r.xmin<0?-r.xmin:0);o[1]=r.ymax+(r.ymin<0?-r.ymin:0)}if(t.useDivWrapper){n.sizeElement(this.canvas,s[0],s[1],o[0],o[1]);s[0]=0;s[1]=0;l=y([0,0])}else{l=y([s[0],s[1]])}a.paint.apply(this,arguments);m(this.svg,{style:l,width:o[0]||0,height:o[1]||0})}};return{renderer:a}};n.extend(E,e.jsPlumbUIComponent,{cleanup:function(t){if(t||this.typeId==null){if(this.canvas){this.canvas._jsPlumb=null}if(this.svg){this.svg._jsPlumb=null}if(this.bgCanvas){this.bgCanvas._jsPlumb=null}if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}this.svg=null;this.canvas=null;this.path=null;this.group=null}else{if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode){this.bgCanvas.parentNode.removeChild(this.bgCanvas)}}},reattach:function(t){var e=t.getContainer();if(this.canvas&&this.canvas.parentNode==null){e.appendChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode==null){e.appendChild(this.bgCanvas)}},setVisible:function(t){if(this.canvas){this.canvas.style.display=t?"block":"none"}}});e.ConnectorRenderers.svg=function(t){var n=this,i=E.apply(this,[{cssClass:t._jsPlumb.connectorClass+(this.isEditable()?" "+t._jsPlumb.editableConnectorClass:""),originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:t._jsPlumb}]);var a=this.setEditable;this.setEditable=function(t){var n=a.apply(this,[t]);e[n?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.editableConnectorClass)};i.renderer.paint=function(i,a,r){var s=n.getSegments(),o="",l=[0,0];if(r.xmin<0){l[0]=-r.xmin}if(r.ymin<0){l[1]=-r.ymin}if(s.length>0){o=n.getPathData();var u={d:o,transform:"translate("+l[0]+","+l[1]+")","pointer-events":t["pointer-events"]||"visibleStroke"},c=null,h=[n.x,n.y,n.w,n.h];if(i.outlineStroke){var f=i.outlineWidth||1,d=i.strokeWidth+2*f;c=e.extend({},i);delete c.gradient;c.stroke=i.outlineStroke;c.strokeWidth=d;if(n.bgPath==null){n.bgPath=b("path",u);e.addClass(n.bgPath,e.connectorOutlineClass);C(n.svg,n.bgPath,0)}else{m(n.bgPath,u)}j(n.svg,n.bgPath,c,h,n)}if(n.path==null){n.path=b("path",u);C(n.svg,n.path,i.outlineStroke?1:0)}else{m(n.path,u)}j(n.svg,n.path,i,h,n)}}};n.extend(e.ConnectorRenderers.svg,E);var w=e.SvgEndpoint=function(t){var n=E.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:t._jsPlumb}]);n.renderer.paint=function(t){var n=e.extend({},t);if(n.outlineStroke){n.stroke=n.outlineStroke}if(this.node==null){this.node=this.makeNode(n);this.svg.appendChild(this.node)}else if(this.updateNode!=null){this.updateNode(this.node)}j(this.svg,this.node,n,[this.x,this.y,this.w,this.h],this);y(this.node,[this.x,this.y])}.bind(this)};n.extend(w,E);e.Endpoints.svg.Dot=function(){e.Endpoints.Dot.apply(this,arguments);w.apply(this,arguments);this.makeNode=function(t){return b("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(t){m(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}};n.extend(e.Endpoints.svg.Dot,[e.Endpoints.Dot,w]);e.Endpoints.svg.Rectangle=function(){e.Endpoints.Rectangle.apply(this,arguments);w.apply(this,arguments);this.makeNode=function(t){return b("rect",{width:this.w,height:this.h})};this.updateNode=function(t){m(t,{width:this.w,height:this.h})}};n.extend(e.Endpoints.svg.Rectangle,[e.Endpoints.Rectangle,w]);e.Endpoints.svg.Image=e.Endpoints.Image;e.Endpoints.svg.Blank=e.Endpoints.Blank;e.Overlays.svg.Label=e.Overlays.Label;e.Overlays.svg.Custom=e.Overlays.Custom;var S=function(t,n){t.apply(this,n);e.jsPlumbUIComponent.apply(this,n);this.isAppendedAtTopLevel=false;var i=this;this.path=null;this.paint=function(t,e){if(t.component.svg&&e){if(this.path==null){this.path=b("path",{"pointer-events":"all"});t.component.svg.appendChild(this.path);if(this.elementCreated){this.elementCreated(this.path,t.component)}this.canvas=t.component.svg}var i=n&&n.length===1?n[0].cssClass||"":"",r=[0,0];if(e.xmin<0){r[0]=-e.xmin}if(e.ymin<0){r[1]=-e.ymin}m(this.path,{d:a(t.d),"class":i,stroke:t.stroke?t.stroke:null,fill:t.fill?t.fill:null,transform:"translate("+r[0]+","+r[1]+")"})}};var a=function(t){return isNaN(t.cxy.x)||isNaN(t.cxy.y)?"":"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.transfer=function(t){if(t.canvas&&this.path&&this.path.parentNode){this.path.parentNode.removeChild(this.path);t.canvas.appendChild(this.path)}}};n.extend(S,[e.jsPlumbUIComponent,e.Overlays.AbstractOverlay],{cleanup:function(t){if(this.path!=null){if(t){this._jsPlumb.instance.removeElement(this.path)}else{if(this.path.parentNode){this.path.parentNode.removeChild(this.path)}}}},reattach:function(t){if(this.path&&this.canvas&&this.path.parentNode==null){this.canvas.appendChild(this.path)}},setVisible:function(t){if(this.path!=null){this.path.style.display=t?"block":"none"}}});e.Overlays.svg.Arrow=function(){S.apply(this,[e.Overlays.Arrow,arguments])};n.extend(e.Overlays.svg.Arrow,[e.Overlays.Arrow,S]);e.Overlays.svg.PlainArrow=function(){S.apply(this,[e.Overlays.PlainArrow,arguments])};n.extend(e.Overlays.svg.PlainArrow,[e.Overlays.PlainArrow,S]);e.Overlays.svg.Diamond=function(){S.apply(this,[e.Overlays.Diamond,arguments])};n.extend(e.Overlays.svg.Diamond,[e.Overlays.Diamond,S]);e.Overlays.svg.GuideLines=function(){var t=null,n=this,i,a;e.Overlays.GuideLines.apply(this,arguments);this.paint=function(e,s){if(t==null){t=b("path");e.connector.svg.appendChild(t);n.attachListeners(t,e.connector);n.attachListeners(t,n);i=b("path");e.connector.svg.appendChild(i);n.attachListeners(i,e.connector);n.attachListeners(i,n);a=b("path");e.connector.svg.appendChild(a);n.attachListeners(a,e.connector);n.attachListeners(a,n)}var o=[0,0];if(s.xmin<0){o[0]=-s.xmin}if(s.ymin<0){o[1]=-s.ymin}m(t,{d:r(e.head,e.tail),stroke:"red",fill:null,transform:"translate("+o[0]+","+o[1]+")"});m(i,{d:r(e.tailLine[0],e.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+o[0]+","+o[1]+")"});m(a,{d:r(e.headLine[0],e.headLine[1]),stroke:"green",fill:null,transform:"translate("+o[0]+","+o[1]+")"})};var r=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}};n.extend(e.Overlays.svg.GuideLines,e.Overlays.GuideLines)}).call(typeof window!=="undefined"?window:this);(function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,i=t.Katavorio,a=t.Biltong;var r=function(t,n){n=n||"main";var r="_katavorio_"+n;var s=t[r],o=t.getEventManager();if(!s){s=new i({bind:o.on,unbind:o.off,getSize:e.getSize,getPosition:function(e,n){var i=t.getOffset(e,n,e._katavorioDrag?e.offsetParent:null);return[i.left,i.top]},setPosition:function(t,e){t.style.left=e[0]+"px";t.style.top=e[1]+"px"},addClass:e.addClass,removeClass:e.removeClass,intersects:a.intersects,indexOf:function(t,e){return t.indexOf(e)},scope:t.getDefaultScope(),css:{noSelect:t.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}});s.setZoom(t.getZoom());t[r]=s;t.bind("zoom",s.setZoom)}return s};var s=function(t,e){var i=function(i){if(e[i]!=null){if(n.isString(e[i])){var a=e[i].match(/-=/)?-1:1,r=e[i].substring(2);return t[i]+a*r}else{return e[i]}}else{return t[i]}};return[i("left"),i("top")]};e.extend(t.jsPlumbInstance.prototype,{animationSupported:true,getElement:function(t){if(t==null){return null}t=typeof t==="string"?t:t.length!=null&&t.enctype==null?t[0]:t;return typeof t==="string"?document.getElementById(t):t},removeElement:function(t){r(this).elementRemoved(t);this.getEventManager().remove(t)},doAnimate:function(t,n,i){i=i||{};var a=this.getOffset(t),r=s(a,n),o=r[0]-a.left,l=r[1]-a.top,u=i.duration||250,c=15,h=u/c,f=c/u*o,d=c/u*l,p=0,_=setInterval(function(){e.setPosition(t,{left:a.left+f*(p+1),top:a.top+d*(p+1)});if(i.step!=null){i.step(p,Math.ceil(h))}p++;if(p>=h){window.clearInterval(_);if(i.complete!=null){i.complete()}}},c)},destroyDraggable:function(t,e){r(this,e).destroyDraggable(t)},destroyDroppable:function(t,e){r(this,e).destroyDroppable(t)},initDraggable:function(t,e,n){r(this,n).draggable(t,e)},initDroppable:function(t,e,n){r(this,n).droppable(t,e)},isAlreadyDraggable:function(t){return t._katavorioDrag!=null},isDragSupported:function(t,e){return true},isDropSupported:function(t,e){return true},isElementDraggable:function(t){t=e.getElement(t);return t._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(t){return t[0].drag.getDragElement()},getDragScope:function(t){return t._katavorioDrag&&t._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(t){return t[0].e},getUIPosition:function(t,e){var n=t[0].el;if(n.offsetParent==null){return null}var i=t[0].finalPos||t[0].pos;var a={left:i[0],top:i[1]};if(n._katavorioDrag&&n.offsetParent!==this.getContainer()){var r=this.getOffset(n.offsetParent);a.left+=r.left;a.top+=r.top}return a},setDragFilter:function(t,e,n){if(t._katavorioDrag){t._katavorioDrag.setFilter(e,n)}},setElementDraggable:function(t,n){t=e.getElement(t);if(t._katavorioDrag){t._katavorioDrag.setEnabled(n)}},setDragScope:function(t,e){if(t._katavorioDrag){t._katavorioDrag.k.setDragScope(t,e)}},setDropScope:function(t,e){if(t._katavorioDrop&&t._katavorioDrop.length>0){t._katavorioDrop[0].k.setDropScope(t,e)}},addToPosse:function(t,n){var i=Array.prototype.slice.call(arguments,1);var a=r(this);e.each(t,function(t){t=[e.getElement(t)];t.push.apply(t,i);a.addToPosse.apply(a,t)})},setPosse:function(t,n){var i=Array.prototype.slice.call(arguments,1);var a=r(this);e.each(t,function(t){t=[e.getElement(t)];t.push.apply(t,i);a.setPosse.apply(a,t)})},removeFromPosse:function(t,n){var i=Array.prototype.slice.call(arguments,1);var a=r(this);e.each(t,function(t){t=[e.getElement(t)];t.push.apply(t,i);a.removeFromPosse.apply(a,t)})},removeFromAllPosses:function(t){var n=r(this);e.each(t,function(t){n.removeFromAllPosses(e.getElement(t))})},setPosseState:function(t,n,i){var a=r(this);e.each(t,function(t){a.setPosseState(e.getElement(t),n,i)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(t){if(t._katavorioDrag){t._katavorioDrag.abort()}},addToDragSelection:function(t){r(this).select(t)},removeFromDragSelection:function(t){r(this).deselect(t)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(t,e,n,i){this.getEventManager().trigger(t,e,n,i)},doReset:function(){for(var t in this){if(t.indexOf("_katavorio_")===0){this[t].reset()}}}});var o=function(t){var e=function(){if(/complete|loaded|interactive/.test(document.readyState)&&typeof document.body!=="undefined"&&document.body!=null){t()}else{setTimeout(e,9)}};e()};o(e.init)}).call(typeof window!=="undefined"?window:this);(function(t){"use strict";if(typeof t.snOoPy=="undefined")t.snOoPy={};if(typeof t.snOoPy.SNooPY=="undefined")t.snOoPy.SNooPY={}})(window);(function(t,e){"use strict";if(typeof t.a_dp=="undefined"){t.a_dp=function(){this.a_V=[{a_bQ:this,a_ka:t.a_dp.a_V.a_j8,a_j9:-1}]};t.a_dp.prototype.a_by=function(){return this.a_V[0]};t.a_dp.prototype.a_dn=function(){var e=this.a_by();if(e.a_j9+1>t.a_dp.a_j6){e.a_j9=0;e.a_ka+=t.a_dp.a_j7}else{++e.a_j9}return e.a_ka+e.a_j9};t.a_dp.a_V={a_j8:"u",a_j7:"x",a_j6:999999999,a_j5:null};t.a_dp.a_do=function(){if(t.a_dp.a_V.a_j5==null){t.a_dp.a_V.a_j5=new t.a_dp}return t.a_dp.a_V.a_j5}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_fQ=="undefined"){t.a_fQ=function(t){this.a_V=[{a_bQ:this,a_j4:t}]};t.a_fQ.prototype.a_by=function(){return this.a_V[0]};t.a_fQ.prototype.a_fM=function(t){var e=this.a_by();var n="";for(var i=0;i<e.a_j4.length;++i){var a=e.a_j4[i];if(i%2==0){n+=a}else{if(typeof t[a]!="undefined"){n+=t[a]}}}return n}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_jk=="undefined"){t.a_jk=function(t,e,n){this.a_V=[{a_bQ:this,a_jY:t,a_jW:e,a_jS:n,a_jT:(e?1:-1)*t,a_jU:e?1:-1,a_jV:function(t,e,n){return t>e||n&&t==e}}]};t.a_jk.prototype.a_by=function(){return this.a_V[0]};t.a_jk.prototype.a_jO=function(){return this.a_by().a_jY};t.a_jk.prototype.a_jX=function(){return this.a_by().a_jW};t.a_jk.prototype.a_jL=function(){return this.a_by().a_jS};t.a_jk.prototype.a_jz=function(t){var e=this.a_by();return e.a_jV(e.a_jU*t,e.a_jT,e.a_jS)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_jd=="undefined"){t.a_jd=function(e,n,i){this.a_V=[{a_bQ:this,a_jD:e,a_ji:n,a_jh:i,a_jR:null,a_jP:null,a_jI:null,a_jG:null,a_jN:function(e){return e?t.a_jd.a_V.a_jm:t.a_jd.a_V.a_jl},a_jw:function(e){var n=this;if(n.a_jR==null){n.a_jR=new t.a_fQ(t.a_jd.a_V.a_jv.slice())}var i={};i[t.a_jd.a_V.a_jo]=e;return n.a_jR.a_fM(i)},a_jC:function(e){var n=this;if(n.a_jP==null){n.a_jP=new t.a_fQ(t.a_jd.a_V.a_ju.slice())}var i={};i[t.a_jd.a_V.a_jq]=e;i[t.a_jd.a_V.a_jr]=n.a_jD;return n.a_jP.a_fM(i)},a_jH:function(e,n,i){var a=this;var r={};r[t.a_jd.a_V.a_jo]=n;r[t.a_jd.a_V.a_jp]=i.a_jO();r[t.a_jd.a_V.a_jn]=a.a_jN(i.a_jL());return e.a_fM(r)},a_jA:function(e){var n=this;if(n.a_jI==null){n.a_jI=new t.a_fQ(t.a_jd.a_V.a_jt.slice())}return n.a_jH(n.a_jI,e,n.a_ji)},a_jx:function(e){var n=this;if(n.a_jG==null){n.a_jG=new t.a_fQ(t.a_jd.a_V.a_js.slice())}return n.a_jH(n.a_jG,e,n.a_jh)}}]};t.a_jd.prototype.a_by=function(){return this.a_V[0]};t.a_jd.prototype.a_fz=function(t){var e=this.a_by();var n=new RegExp("^-?(0|[1-9][0-9]*)(\\.[0-9]+)?$").exec(t);var i=2;if(n){var a=0;if(n[i]){a=n[i].length-1}if(e.a_jD>=0&&a>e.a_jD){return e.a_jC(a)}var r=Number.parseFloat(t);if(e.a_ji!=null&&!e.a_ji.a_jz(r)){return e.a_jA(t)}if(e.a_jh!=null&&!e.a_jh.a_jz(r)){return e.a_jx(t)}}else{return e.a_jw(t)}};t.a_jd.a_V={a_jv:['The value "',"foundValue",'" is not a correctly formatted number.'],a_ju:["This value has too many decimals. The maximum allowed is ","maxDecimals",". ","foundDecimals"," was/were found."],a_jt:["The value ","foundValue"," is too small. The minimum value is ","referenceValue"," (inclusive: ","inclusiveYesOrNo",")."],a_js:["The value ","foundValue"," is too large. The maximum value is ","referenceValue"," (inclusive: ","inclusiveYesOrNo",")."],a_jr:"maxDecimals",a_jq:"foundDecimals",a_jp:"referenceValue",a_jo:"foundValue",a_jn:"inclusiveYesOrNo",a_jm:"yes",a_jl:"no"};t.a_jd.a_jc=function(e){var n=null;if(typeof e["min"]!="undefined"&&e.min!=null){n=new t.a_jk(e.min.value,true,e.min.inclusive)}var i=null;if(typeof e["max"]!="undefined"&&e.max!=null){i=new t.a_jk(e.max.value,false,e.max.inclusive)}return new t.a_jd(e.decimals,n,i)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_r=="undefined"){t.a_r=function(){this.a_V=[{a_bQ:this,a_jf:{}}]};t.a_r.prototype.a_by=function(){return this.a_V[0]};t.a_r.prototype.a_j=function(t,e){this.a_by().a_jf[t]=e};t.a_r.prototype.a_je=function(t,e,n,i,a,r){var s=this.a_by();if(typeof s.a_jf[t]=="undefined"){throw'Unknown field type "'+t+'" in a_r.a_je(...)'}return s.a_jf[t].a_je(t,e,n,i,a,r)};t.a_r.prototype.a_fT=function(t){return this.a_je(t.fieldType,t.fieldArgs,t.propName,t.label,t.valueData,t.dirty)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_q=="undefined"){t.a_q=function(){this.a_V=[{a_bQ:this}]};t.a_q.prototype.a_by=function(){return this.a_V[0]};t.a_q.prototype.a_je=function(e,n,i,a,r,s){return new t.a_p(e,n,i,a,r,s)};t.a_q.prototype.a_fT=function(t){return this.a_je(t.fieldType,t.fieldArgs,t.propName,t.label,t.valueData,t.dirty)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_n=="undefined"){t.a_n=function(){this.a_V=[{a_bQ:this}]};t.a_n.prototype.a_by=function(){return this.a_V[0]};t.a_n.prototype.a_je=function(e,n,i,a,r,s){return new t.a_m(e,n,i,a,r,s)};t.a_n.prototype.a_fT=function(t){return this.a_je(t.fieldType,t.fieldArgs,t.propName,t.label,t.valueData,t.dirty)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_k=="undefined"){t.a_k=function(t){this.a_V=[{a_bQ:this,a_3:t}]
};t.a_k.prototype.a_by=function(){return this.a_V[0]};t.a_k.prototype.a_je=function(e,n,i,a,r,s){var o=this.a_by();return new t.a_i(o.a_3,e,n,i,a,r,s)};t.a_k.prototype.a_fT=function(t){return this.a_je(t.fieldType,t.fieldArgs,t.propName,t.label,t.valueData,t.dirty)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_p=="undefined"){t.a_p=function(e,n,i,a,r,s){this.a_V=[{a_bQ:this,a_h1:e,a_hP:n,a_fJ:i,a_hQ:a,a_iJ:r,a_iD:r,a_hZ:s,a_iY:null,a_iC:null,a_iX:null,a_ja:null,a_jb:function(){var e=this;if(e.a_hP.numberConfig==null)return null;if(e.a_ja==null){e.a_ja=t.a_jd.a_jc(e.a_hP.numberConfig)}return e.a_ja},a_iU:function(t){var e=this;var n=e.a_jb();return n==null?null:n.a_fz(t)},a_i5:function(e){return t.a_p.a_V.a_iL+e+t.a_p.a_V.a_iK},a_i0:function(e){var n=this;e.removeClass(n.a_i5(t.a_p.a_V.a_i8)).removeClass(n.a_i5(t.a_p.a_V.a_i7)).removeClass(n.a_i5(t.a_p.a_V.a_i6))},a_i1:function(t,e){var n=this;if(n.a_iY!=null){n.a_i0(n.a_iY);n.a_iY.addClass(n.a_i5(e));if(n.a_iX==null){n.a_iX=jQuery('<span class="help-block"></span>');n.a_iY.append(n.a_iX)}n.a_iX.text(t)}},a_iT:function(e){this.a_i1(e,t.a_p.a_V.a_iO)},a_i3:function(e){this.a_i1(e,t.a_p.a_V.a_iN)},a_i2:function(e){this.a_i1(e,t.a_p.a_V.a_iM)},a_iV:function(){var t=this;if(t.a_iY!=null){t.a_i0(t.a_iY);if(t.a_iX!=null){t.a_iX.remove();t.a_iX=null}}}}]};t.a_p.prototype.a_by=function(){return this.a_V[0]};t.a_p.prototype.a_fu=function(e){var n=this.a_by();var i=t.a_dp.a_do().a_dn();var a=jQuery('<div class="form-group"></div>');var r=jQuery('<label class="control-label"></label>').attr("for",i).text(n.a_hQ);var s=n.a_hP.displayAsTextArea?s=jQuery('<textarea class="form-control"></textarea>'):s=jQuery('<input type="text" class="form-control" />');s.attr("id",i).val(n.a_iD);a.append(r);a.append(s);e.append(a);n.a_iY=a;n.a_iC=s};t.a_p.prototype.a_hF=function(){var t=this.a_by();t.a_iY=null;t.a_iC=null;t.a_iX=null};t.a_p.prototype.a_fA=function(){var t=this.a_by();t.a_iD=t.a_iC.val()};t.a_p.prototype.a_fG=function(){var t=this.a_by();var e={fieldType:t.a_h1,fieldArgs:t.a_hP,propName:t.a_fJ,label:t.a_hQ,valueData:t.a_iD,dirty:this.a_hE()};return e};t.a_p.prototype.a_hE=function(){var t=this.a_by();return t.a_hZ||t.a_iD!=t.a_iJ};t.a_p.prototype.a_gq=function(t){var e=this.a_by();e.a_hZ=false;e.a_iJ=e.a_iD};t.a_p.prototype.a_fz=function(){var e=this.a_by();e.a_iV();if(e.a_hP.notEmpty&&e.a_iD.length==0){var n=t.a_p.a_V.a_iR;e.a_iT(n);return n}if(e.a_hP.maxLength!=-1&&e.a_iD.length>e.a_hP.maxLength){var n=t.a_p.a_V.a_iQ+e.a_hP.maxLength+t.a_p.a_V.a_iP;e.a_iT(n);return n}var i=e.a_iU(e.a_iD);if(i!=null){e.a_iT(i);return i}return null};t.a_p.a_V={a_iR:"This field can not be empty",a_iQ:"This field can contain no more than ",a_iP:" characters.",a_iO:"error",a_iN:"warning",a_iM:"success",a_iL:"has-",a_iK:""};t.a_p.a_h="TEXT"}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_m=="undefined"){t.a_m=function(t,e,n,i,a,r){this.a_V=[{a_bQ:this,a_h1:t,a_hP:e,a_fJ:n,a_hQ:i,a_iJ:a,a_iD:a,a_hZ:r,a_iC:null,a_iE:function(t,e){t.prop("checked",e)},a_iH:function(t){return t.is(":checked")}}]};t.a_m.prototype.a_by=function(){return this.a_V[0]};t.a_m.prototype.a_fu=function(t){var e=this.a_by();var n=jQuery('<div class="checkbox"></div>');t.append(n);var i=jQuery("<label></label>").text(e.a_hQ);n.append(i);e.a_iC=jQuery('<input type="checkbox" />');n.prepend(e.a_iC);e.a_iE(e.a_iC,e.a_iD)};t.a_m.prototype.a_hF=function(){var t=this.a_by();t.a_iC=null};t.a_m.prototype.a_fA=function(){var t=this.a_by()};t.a_m.prototype.a_fG=function(){var t=this.a_by()};t.a_m.prototype.a_hE=function(){var t=this.a_by()};t.a_m.prototype.a_gq=function(t){var e=this.a_by()};t.a_m.prototype.a_fz=function(){var t=this.a_by();return null};t.a_m.a_h="CHECK"}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_hw=="undefined"){t.a_hw=function(e,n,i,a){this.a_V=[{a_bQ:this,a_gS:e,a_c4:n,a_hQ:i,a_fw:a,a_hS:null,a_ib:null,a_Y:null,a_ia:null,a_h9:null,a_if:function(){return jQuery('<div class="panel panel-default"></div>').addClass(t.a_hw.a_V.a_go)},a_id:function(){var e=this;var n=this.a_bQ;var i=jQuery('<div class="panel-heading"></div>').addClass(t.a_hw.a_V.a_gm).text(e.a_hQ);e.a_Y.append(i);var a=jQuery('<div class="panel-body"></div>').addClass(t.a_hw.a_V.a_hC);e.a_Y.append(a);var r=jQuery('<div class="btn-group"></div>').addClass(t.a_hw.a_V.a_h8);a.append(r);var s=jQuery('<button class="btn btn-default"></button>').addClass(t.a_hw.a_V.a_iB).text(t.a_hw.a_V.a_h3);r.append(s);e.a_ia=s;s.click(function(){e.a_ip()});var o=jQuery('<button class="btn btn-default"></button>').addClass(t.a_hw.a_V.a_iz).text(t.a_hw.a_V.a_h2);r.append(o);e.a_h9=o;o.click(function(){e.a_io()});n.a_hU();var l=jQuery("<div></div>").addClass(t.a_hw.a_V.a_h4);a.append(l);for(var u=0;u<e.a_fw.length;++u){e.a_fw[u].a_fu(l)}},a_in:function(t){var e=this;var n=this;if(t){if(e.a_hS!=null){var i=e.a_hS;var a=i.a_ik();var r=e.a_ib;e.a_Y.insertBefore(i.a_dL());n.a_hT(a);n.a_hV(i);i.a_hT(n);i.a_hV(r);n.a_hU();i.a_hU();if(a!=null){a.a_hV(n);a.a_hU()}if(r!=null){r.a_hT(i);r.a_hU()}}}else{if(e.a_ib!=null){var i=e.a_ib;var a=e.a_hS;var r=i.a_ij();e.a_Y.insertAfter(i.a_dL());n.a_hT(i);n.a_hV(r);i.a_hT(a);i.a_hV(n);n.a_hU();i.a_hU();if(a!=null){a.a_hV(i);a.a_hU()}if(r!=null){r.a_hT(n);r.a_hU()}}}},a_ic:function(t,e){if(e){t.removeClass("disabled")}else{t.addClass("disabled")}},a_ip:function(){this.a_in(true)},a_io:function(){this.a_in(false)}}]};t.a_hw.prototype.a_by=function(){return this.a_V[0]};t.a_hw.prototype.a_g7=function(t){this.a_by().a_gS=t};t.a_hw.prototype.a_bJ=function(){return this.a_by().a_gS};t.a_hw.prototype.a_g6=function(t){this.a_by().a_c4=t};t.a_hw.prototype.a_bF=function(){return this.a_by().a_c4};t.a_hw.prototype.a_im=function(){return this.a_by().a_hQ};t.a_hw.prototype.a_il=function(){return this.a_by().a_fw};t.a_hw.prototype.a_hT=function(t){this.a_by().a_hS=t};t.a_hw.prototype.a_ik=function(){return this.a_by().a_hS};t.a_hw.prototype.a_hV=function(t){this.a_by().a_ib=t};t.a_hw.prototype.a_ij=function(){return this.a_by().a_ib};t.a_hw.prototype.a_dL=function(){return this.a_by().a_Y};t.a_hw.prototype.a_hI=function(t){var e=this.a_by();e.a_Y=e.a_if();t.append(e.a_Y);e.a_id()};t.a_hw.prototype.a_ii=function(t){var e=this.a_by();e.a_Y=e.a_if();e.a_Y.insertBefore(t);e.a_id()};t.a_hw.prototype.a_ig=function(t){var e=this.a_by();e.a_Y=e.a_if();e.a_Y.insertAfter(t);e.a_id()};t.a_hw.prototype.a_hU=function(){var t=this.a_by();t.a_ic(t.a_ia,t.a_hS!=null);t.a_ic(t.a_h9,t.a_ib!=null)};t.a_hw.prototype.a_hF=function(){var t=this.a_by();t.a_Y=null;t.a_ia=null;t.a_h9=null};t.a_hw.prototype.a_fG=function(){};t.a_hw.a_V={a_go:"rgm-modes-subform-container",a_gm:"rgm-modes-subform-title",a_hC:"rgm-modes-subform-content",a_h8:"rgm-modes-subform-move-btns",a_h7:"rgm-modes-subform-move-btn",a_h6:"rgm-modes-subform-up-btn",a_h5:"rgm-modes-subform-down-btn",a_h4:"rgm-modes-subform-fields",a_h3:"",a_h2:"",a_e5:"temp_subform",a_e4:"_"};t.a_hw.a_c9=function(){return[t.a_hw.a_V.a_e5,(new Date).getTime(),t.a_dp.a_do().a_dn()].join(t.a_hw.a_V.a_e4)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_i=="undefined"){t.a_i=function(e,n,i,a,r,s,o){this.a_V=[{a_bQ:this,a_3:e,a_h1:n,a_hP:i,a_fJ:a,a_hQ:r,a_hX:s,a_hZ:o,a_hH:null,a_hJ:[],a_hR:{},a_fn:function(){var e=this;var n=null;for(var i=0;i<e.a_hX.length;++i){var a=e.a_hX[i];var r=[];for(var s=0;s<a.fields.length;++s){var o=a.fields[s];var l=e.a_3.a_fT(o);r.push(l)}var u=new t.a_hw(a.id,a.tempId,a.label,r);if(i>0){u.a_hT(n);n.a_hV(u)}e.a_hJ.push(u);n=u}},a_hO:function(e){var n=this;var i=t.a_hw.a_c9();var a=[];for(var r=0;r<e.fields.length;++r){var s=e.fields[r];var o=n.a_3.a_fT(s);a.push(o)}var l=new t.a_hw(e.id,i,e.label,a);if(n.a_hJ.length>0){var u=n.a_hJ[n.a_hJ.length-1];u.a_hV(l);u.a_hU();l.a_hT(u)}l.a_hI(n.a_hH);n.a_hJ.push(l);n.a_hR[i]=l}}];this.a_V[0].a_fn()};t.a_i.prototype.a_by=function(){return this.a_V[0]};t.a_i.prototype.a_fu=function(e){var n=this.a_by();var i=0;var a=jQuery('<div class="panel panel-default"></div>').addClass(t.a_i.a_V.a_go);e.append(a);var r=jQuery('<div class="panel-heading"></div>').addClass(t.a_i.a_V.a_gm);r.text(n.a_hQ);a.append(r);var s=jQuery('<div class="panel-body"></div>').addClass(t.a_i.a_V.a_hC);a.append(s);var o=jQuery('<div class="btn-group-vertical"></div>').addClass(t.a_i.a_V.a_hB);s.append(o);for(i=0;i<n.a_hP.forms.length;++i){(function(e){var i=n.a_hP.forms[e];var a=jQuery('<button class="btn btn-default"></button>').addClass(t.a_i.a_V.a_hA).text(t.a_i.a_V.a_hy+i.label+t.a_i.a_V.a_hx);a.click(function(){n.a_hO(i)});o.append(a)})(i)}var l=jQuery("<div></div>").addClass(t.a_i.a_V.a_hz);s.append(l);for(i=0;i<n.a_hJ.length;++i){var u=n.a_hJ[i];u.a_hI(l)}n.a_hH=l};t.a_i.prototype.a_hF=function(){var t=this.a_by();t.a_hH=null;for(a_cB=0;a_cB<t.a_hJ.length;++a_cB){var e=t.a_hJ[a_cB];e.a_hI(a_hH);e.a_hF()}};t.a_i.prototype.a_fA=function(){var t=this.a_by()};t.a_i.prototype.a_fG=function(){var t=this.a_by()};t.a_i.prototype.a_hE=function(){var t=this.a_by()};t.a_i.prototype.a_gq=function(t){var e=this.a_by()};t.a_i.prototype.a_fz=function(){var t=this.a_by()};t.a_i.a_V={a_go:"rgm-modes-forms-field-container",a_hD:"rgm-modes-forms-field-title",a_hC:"rgm-modes-forms-field-content",a_hB:"rgm-modes-forms-field-add-buttons",a_hA:"rgm-modes-forms-field-add-button",a_hz:"rgm-modes-forms-field-forms",a_hy:"Add new ",a_hx:""};t.a_i.a_h="FORMS"}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_c6=="undefined"){t.a_c6=function(e,n,i,a,r){this.a_V=[{a_bQ:this,a_dN:e,a_bz:n,a_3:i,a_Z:a,a_hv:r,a_hu:null,a_gV:[],a_gT:{},a_gR:[],a_Y:null,a_gy:null,a_fw:[],a_fI:{},a_ch:null,a_fR:null,a_hn:null,a_hg:null,a_ht:null,a_hs:null,a_hr:null,a_hq:null,a_hc:null,a_dw:0,a_gx:function(t){var e=this;if(e.a_hu==null){e.a_hu={};for(var n=0;n<e.a_hv.length;++n){var i=e.a_hv[n];e.a_hu[i.typeName]=i}}return e.a_hu[t]},a_fy:function(e,n){var i=this;if(i.a_fR==null){i.a_fR=new t.a_fQ(t.a_c6.a_V.a_fi)}var a={};a[t.a_c6.a_V.a_ff]=e;a[t.a_c6.a_V.a_f4]=n;return i.a_fR.a_fM(a)},a_hh:function(e,n){var i=this;if(i.a_ht==null){i.a_ht=new t.a_fQ(t.a_c6.a_V.a_gd)}var a={};a[t.a_c6.a_V.a_ff]=e;a[t.a_c6.a_V.a_f4]=n;return i.a_ht.a_fM(a)},a_hf:function(e,n,i){var a=this;if(a.a_hs==null){a.a_hs=new t.a_fQ(t.a_c6.a_V.a_gb)}var r={};r[t.a_c6.a_V.a_ff]=e;r[t.a_c6.a_V.a_f4]=n;r[t.a_c6.a_V.a_fg]=i;return a.a_hs.a_fM(r)},a_g9:function(e,n,i){var a=this;if(a.a_hr==null){a.a_hr=new t.a_fQ(t.a_c6.a_V.a_ga)}var r={};r[t.a_c6.a_V.a_ff]=e;r[t.a_c6.a_V.a_f4]=n;r[t.a_c6.a_V.a_fg]=i;return a.a_hr.a_fM(r)},a_g8:function(e,n,i){var a=this;if(a.a_hq==null){a.a_hq=new t.a_fQ(t.a_c6.a_V.a_f9)}var r={};r[t.a_c6.a_V.a_ff]=e;r[t.a_c6.a_V.a_f4]=n;r[t.a_c6.a_V.a_fg]=i;return a.a_hq.a_fM(r)},a_g5:function(e,n,i,a,r){var s=this;if(s.a_hn==null){s.a_hn=new t.a_fQ(t.a_c6.a_V.a_gf)}var o={};o[t.a_c6.a_V.a_ff]=e;o[t.a_c6.a_V.a_f8]=n;o[t.a_c6.a_V.a_f7]=i;o[t.a_c6.a_V.a_f6]=a;o[t.a_c6.a_V.a_f5]=r;return s.a_hn.a_fM(o)},a_g4:function(){var e=this;return e.a_dN.id!=null?t.a_c6.a_V.a_f1:t.a_c6.a_V.a_f0},a_g3:function(){var t=this;return t.a_dN.id!=null?t.a_dN.id:t.a_dN.tempId},a_fB:function(t,e){var n=this;if(t==null)return e;var i=n.a_fH(t[0],null);if(i==null)return e;var a=i.a_fG();for(var r=1;r<t.length;++r){var s=t[r];if(typeof a[s]=="undefined"){return e}a=a[s]}return a},a_fj:function(){var t=this;var e=this.a_bQ;t.a_gy.text(e.a_fo())},a_gK:function(t,e,n){t.css({top:n+"px",left:e+"px"})},a_hk:function(t){},a_gJ:function(t,e){for(var n=0;n<e.length;++n){t.addClass(e[n])}},a_fK:function(t,e){var n=this;n.a_fI["pn"+t]=e},a_fH:function(t,e){var n=this;var i="pn"+t;if(typeof n.a_fI[i]=="undefined")return e;return n.a_fI[i]},a_gF:function(){var e=this;var n=this.a_bQ;e.a_Z.a_cZ(function(i,a,r,s,o){for(var l=0;l<e.a_fw.length;++l){var u=e.a_fw[l];u.a_fu(r)}a.text(e.a_fy(n.a_fo(),n.a_g0()));o.text(t.a_c6.a_V.a_gi)},function(){return e.a_de()})},a_gB:function(){var t=this;var e=this.a_bQ;if(confirm(t.a_hh(e.a_fo(),e.a_g0()))){t.a_Z.a_bW(e,true);t.a_Y.remove()}},a_de:function(){var t=this;for(var e=0;e<t.a_fw.length;++e){var n=t.a_fw[e];n.a_fA();if(n.a_fz()!=null){return false}}t.a_fj();return true},a_gr:function(){var e=this;var n=this.a_bQ;if(e.a_hg==null){e.a_hg=new t.a_fQ(t.a_c6.a_V.a_ge)}var i={};i[t.a_c6.a_V.a_f4]=n.a_g0();i[t.a_c6.a_V.a_f3]=e.a_dN.maxOutgoing;alert(e.a_hg.a_fM(i))},a_gH:function(t){var e=this;var n=this.a_bQ;e.a_Z.a_cO(e.a_hf(n.a_fo(),n.a_cA(),e.a_dN.typeLabel))},a_gG:function(t){var e=this;e.a_Z.a_cM()},a_gw:function(t,e,n){var i=this;t.mouseover(function(t){i.a_he(t,e,n)})},a_gv:function(t){var e=this;t.mouseout(function(t){e.a_ha(t)})},a_he:function(e,n,i){var a=this;e.stopPropagation();if(a.a_hc==null){a.a_hc=new t.a_fQ(t.a_c6.a_V.a_gc)}var r={};r[t.a_c6.a_V.a_f2]=i;var s=a.a_hc.a_fM(r);a.a_Z.a_cO(s)},a_ha:function(t){var e=this;e.a_Z.a_cM()},a_gE:function(t){var e=this;var n=this.a_bQ;t.stopPropagation();e.a_Z.a_cO(e.a_g9(n.a_fo(),n.a_g0(),e.a_dN.typeLabel))},a_gD:function(t){var e=this;e.a_Z.a_cM()},a_gA:function(t){var e=this;var n=this.a_bQ;t.stopPropagation();e.a_Z.a_cO(e.a_g8(n.a_fo(),n.a_g0(),e.a_dN.typeLabel))},a_gz:function(t){var e=this;e.a_Z.a_cM()}}]};t.a_c6.prototype.a_by=function(){return this.a_V[0]};t.a_c6.prototype.a_g7=function(t){this.a_by().a_dN.id=t};t.a_c6.prototype.a_bJ=function(){return this.a_by().a_dN.id};t.a_c6.prototype.a_g6=function(t){this.a_by().a_dN.tempId=t};t.a_c6.prototype.a_bF=function(){return this.a_by().a_dN.tempId};t.a_c6.prototype.a_bL=function(){return this.a_by().a_bz};t.a_c6.prototype.a_dL=function(){return this.a_by().a_Y};t.a_c6.prototype.a_dv=function(){return this.a_by().a_dw};t.a_c6.prototype.a_dq=function(t){this.a_by().a_dw=t};t.a_c6.prototype.a_fo=function(){var t=this.a_by();return t.a_fB(t.a_dN.titleLabelPath,t.a_dN.title)};t.a_c6.prototype.a_gZ=function(t,e){var n=this.a_by();var i=this;return n.a_g5(i.a_fo(),n.a_g4(),n.a_g3(),t,e)};t.a_c6.prototype.a_g0=function(){var e=this;return e.a_gZ(t.a_c6.a_V.a_fZ,t.a_c6.a_V.a_fY)};t.a_c6.prototype.a_cA=function(){var t=this;return t.a_gZ("","")};t.a_c6.prototype.a_bT=function(t){var e=this.a_by();for(var n=0;n<e.a_gV.length;++n){var i=e.a_gV[n];if(t.apply(i,[i])===false){break}}};t.a_c6.prototype.a_ct=function(t){var e=this;return e.a_gY(t)>0};t.a_c6.prototype.a_gY=function(t){var e=this.a_by();var n=t.a_bL();if(typeof e.a_gT[n]=="undefined"){return 0}return e.a_gT[n].length};t.a_c6.prototype.a_gN=function(){var t=this.a_by();return t.a_gV.length};t.a_c6.prototype.a_ca=function(t){var e=this.a_by();var n=this;n.a_b0(t);e.a_gV.push(t);var i=t.a_bZ().a_bL();if(typeof e.a_gT[i]=="undefined"){e.a_gT[i]=[]}e.a_gT[i].push(t)};t.a_c6.prototype.a_b0=function(t){var e=this.a_by();var n=t.a_bZ().a_bL();if(typeof e.a_gT[n]!="undefined"){var i=e.a_gT[n];for(var a=0;a<i.length;++a){var r=i[a];if(r.a_cp()==t.a_cp()){i.splice(a,1);for(var s=0;s<e.a_gV.length;++s){var o=e.a_gV[s];if(o.a_bZ().a_co(t.a_bZ())&&o.a_cp()==t.a_cp()){e.a_gV.splice(s,1);break}}break}}if(e.a_gT[n].length==0){delete e.a_gT[n]}}};t.a_c6.prototype.a_gO=function(){return this.a_by().a_gR.length};t.a_c6.prototype.a_bY=function(t){var e=this.a_by();for(var n=0;n<e.a_gR.length;++n){var i=e.a_gR[n];if(i.a_cp()==t.a_cp()&&i.a_b1().a_co(t.a_b1())){e.a_gR.splice(n,1);break}}};t.a_c6.prototype.a_bV=function(t){var e=this.a_by();for(var n=0;n<e.a_gR.length;++n){var i=e.a_gR[n];if(t.apply(i,[i])===false){break}}};t.a_c6.prototype.a_b8=function(t){var e=this.a_by();var n=this;n.a_bY(t);e.a_gR.push(t)};t.a_c6.prototype.a_co=function(t){var e=this.a_by();return t.a_bL()==e.a_bz};t.a_c6.prototype.a_eb=function(t){var e=this.a_by();return e.a_bz.localeCompare(t.a_bL())};t.a_c6.prototype.a_cn=function(){var t=this.a_by();var e=this;return t.a_dN.maxIncoming==-1||e.a_gO()<t.a_dN.maxIncoming};t.a_c6.prototype.a_cq=function(t){var e=this.a_by();var n=this;if(e.a_dN.outConnectionTypes.indexOf(t)==-1){return false}return e.a_dN.maxOutgoing==-1||n.a_gN()<e.a_dN.maxOutgoing};t.a_c6.prototype.a_gM=function(t){var e=this.a_by();return t.a_b1().a_bL()==e.a_bz};t.a_c6.prototype.a_gL=function(t){var e=this.a_by();return t.a_bZ().a_bL()==e.a_bz};t.a_c6.prototype.a_1=function(e,n){var i=this.a_by();var a=this;var r=0;i.a_ch=n;i.a_Y=jQuery("<div></div>").addClass(t.a_c6.a_V.a_go).attr("id",t.a_c6.a_fX(i.a_bz));i.a_gK(i.a_Y,i.a_dN.position.x,i.a_dN.position.y);i.a_gJ(i.a_Y,i.a_dN.classes);e.append(i.a_Y);i.a_Y.mouseover(function(t){i.a_gH(t)});i.a_Y.mouseout(function(t){i.a_gG(t)});var s=jQuery("<span></span>").addClass(t.a_c6.a_V.a_gl);s.click(function(){i.a_gF()});s.mouseover(function(t){i.a_gE(t)});s.mouseout(function(t){i.a_gD(t)});i.a_Y.append(s);var o=jQuery("<span></span>").addClass(t.a_c6.a_V.a_gk);o.click(function(){i.a_gB()});o.mouseover(function(t){i.a_gA(t)});o.mouseout(function(t){i.a_gz(t)});i.a_Y.append(o);for(r=0;r<i.a_dN.fields.length;++r){var l=i.a_dN.fields[r];var u=i.a_3.a_fT(l);var c=l.propName;i.a_fw.push(u);i.a_fK(c,u)}var h=jQuery("<span></span>").addClass(t.a_c6.a_V.a_gn);i.a_Y.append(h);var f=a.a_fo();i.a_gy=jQuery("<div></div>").addClass(t.a_c6.a_V.a_gm).text(f);i.a_Y.append(i.a_gy);i.a_ch.draggable(i.a_Y);if(i.a_dN.maxOutgoing!=0){for(var r=0;r<i.a_dN.outConnectionTypes.length;++r){var d=i.a_dN.outConnectionTypes[r];var p=i.a_gx(d);var _=t.a_c6.a_V.a_gj+p.typeName;var v=jQuery("<div></div>").addClass(_);i.a_Y.append(v);i.a_gw(v,d,p.typeLabel);i.a_gv(v);var g=i.a_ch.makeSource(i.a_Y,{filter:"."+_,anchor:"Continuous",connectorStyle:{stroke:"#7c786a",strokeWidth:2,outlineStroke:"transparent",outlineWidth:4},connectionType:p.typeName,maxConnections:i.a_dN.maxOutgoing,onMaxConnections:function(){i.a_gr()}})}}if(i.a_dN.maxIncoming!=0){i.a_ch.makeTarget(i.a_Y,{anchor:"Continuous",allowLoopback:false})}};t.a_c6.prototype.a_fA=function(){};t.a_c6.prototype.a_gq=function(t){var e=this.a_by()};t.a_c6.a_V={a_go:"rgm-modes-node-container",a_gn:"rgm-modes-node-node-icon",a_gm:"rgm-modes-node-title",a_gl:"rgm-modes-node-configure-button",a_gk:"rgm-modes-node-delete-button",a_gj:"rgm-modes-node-source-endpoint-",a_gi:"OK",a_fi:["Configure ","extendedTitle"],a_gf:["","beforeTitleLabel","","titleLabel","","afterTitleLabel"," (","idTypeLabel",": ","idOrTempId",")"],a_ge:["The source ","extendedTitle"," allows no more than ","maxOutgoing"," outgoing connections."],a_gd:["Do your really want to delete the node ","extendedTitle"," and all incoming and outgoing connections?"],a_gc:["Start Dragging for New ","connectionTypeLabel"],a_gb:["","titleLabel"," (","typeLabel",")"],a_ga:["Configure ","typeLabel"," ","extendedTitle"],a_f9:["Delete ","typeLabel"," ","extendedTitle"],a_ff:"titleLabel",a_f8:"idTypeLabel",a_f7:"idOrTempId",a_f6:"beforeTitleLabel",a_f5:"afterTitleLabel",a_f4:"extendedTitle",a_f3:"maxOutgoing",a_f2:"connectionTypeLabel",a_fg:"typeLabel",a_f1:"id",a_f0:"temp. id",a_fZ:'"',a_fY:'"',a_fU:"node_",a_fV:"rgm-modes-node-",a_e5:"temp_node",a_e4:"_"};t.a_c6.a_fX=function(e){return t.a_c6.a_V.a_fV+e};t.a_c6.a_d4=function(e){return e.substring(t.a_c6.a_V.a_fV.length)};t.a_c6.a_c9=function(){return[t.a_c6.a_V.a_e5,(new Date).getTime(),t.a_dp.a_do().a_dn()].join(t.a_c6.a_V.a_e4)};t.a_c6.a_da=function(){return t.a_c6.a_V.a_fU+t.a_dp.a_do().a_dn()}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_dJ=="undefined"){t.a_dJ=function(e,n,i,a,r,s){this.a_V=[{a_bQ:this,a_cu:e,a_cs:n,a_dI:i,a_c1:a,a_3:r,a_Z:s,a_fw:[],a_fI:{},a_fR:null,a_fN:null,a_fn:function(){var t=this;for(var e=0;e<t.a_dI.fields.length;++e){var n=t.a_dI.fields[e];var i=t.a_3.a_fT(n);t.a_fw.push(i);t.a_fK(n.propName,i)}},a_fy:function(e,n){var i=this;if(i.a_fR==null){i.a_fR=new t.a_fQ(t.a_dJ.a_V.a_fi)}var a={};a[t.a_dJ.a_V.a_fg]=e;a[t.a_dJ.a_V.a_ff]=n;return i.a_fR.a_fM(a)},a_fp:function(e,n){var i=this;if(i.a_fN==null){i.a_fN=new t.a_fQ(t.a_dJ.a_V.a_fh)}var a={};a[t.a_dJ.a_V.a_fg]=e;a[t.a_dJ.a_V.a_ff]=n;return i.a_fN.a_fM(a)},a_fK:function(t,e){var n=this;n.a_fI["pn"+t]=e},a_fH:function(t,e){var n=this;var i="pn"+t;if(typeof n.a_fI[i]=="undefined")return e;return n.a_fI[i]},a_fB:function(t,e){var n=this;if(t==null)return e;var i=n.a_fH(t[0],null);if(i==null)return e;var a=i.a_fG();for(var r=1;r<t.length;++r){var s=t[r];if(typeof a[s]=="undefined"){return e}a=a[s]}return a},a_fj:function(){var t=this;t.a_c1.setLabel(t.a_fo())},a_fo:function(){var t=this;return t.a_fB(t.a_dI.titleLabelPath,t.a_dI.title)},a_de:function(){var t=this;var e=this.a_bQ;for(var n=0;n<t.a_fw.length;++n){var i=t.a_fw[n];i.a_fA();if(i.a_fz()!=null){return false}}t.a_fj();return true},a_fr:function(){var t=this;var e=this.a_bQ;t.a_Z.a_bP(e);t.a_Z.a_bM(t.a_c1);t.a_Z.a_cR()},a_fq:function(e,n,i,a,r){var s=this;var o=this.a_bQ;var l=0;n.text(s.a_fy(s.a_dI.typeLabel,s.a_fo()));if(s.a_fw.length>0){var u=jQuery("<h2></h2>").text(t.a_dJ.a_V.a_fe);i.append(u);for(l=0;l<s.a_fw.length;++l){var c=s.a_fw[l];c.a_fu(i)}}else{var h=jQuery('<div class="alert alert-info"></div>').text(t.a_dJ.a_V.a_fb);i.append(h)}var f=jQuery('<button type="button" class="btn btn-default"></button>').text(t.a_dJ.a_V.a_fd);a.prepend(f);f.click(function(){s.a_fr()});r.text(t.a_dJ.a_V.a_fc)},a_fm:function(t,e){var n=this;n.a_Z.a_cZ(function(t,e,i,a,r){n.a_fq(t,e,i,a,r)},function(){return n.a_de()})},a_fl:function(t,e){var n=this;n.a_Z.a_cO(n.a_fp(n.a_dI.typeLabel,n.a_fo()))},a_fk:function(t,e){var n=this;n.a_Z.a_cM()}}];this.a_V[0].a_fn()};t.a_dJ.prototype.a_by=function(){return this.a_V[0]};t.a_dJ.prototype.a_cp=function(){return this.a_by().a_dI.typeName};t.a_dJ.prototype.a_b1=function(){return this.a_by().a_cu};t.a_dJ.prototype.a_ce=function(t){this.a_by().a_cu=t};t.a_dJ.prototype.a_bZ=function(){return this.a_by().a_cs};t.a_dJ.prototype.a_cd=function(t){this.a_by().a_cs=t};t.a_dJ.prototype.a_cc=function(){var e=this.a_by();e.a_c1.setParameter(t.a_dJ.a_V.a_e9,e.a_cu.a_bL());e.a_c1.setParameter(t.a_dJ.a_V.a_e8,e.a_cs.a_bL());e.a_c1.setParameter(t.a_dJ.a_V.a_e6,e.a_dI.typeName)};t.a_dJ.prototype.a_bM=function(){var t=this.a_by();t.a_Z.a_bM(t.a_c1)};t.a_dJ.prototype.a_dH=function(){var t=this.a_by();var e=this;t.a_c1.bind("click",function(e,n){t.a_fm(e,n)});t.a_c1.bind("mouseover",function(e,n){t.a_fl(e,n)});t.a_c1.bind("mouseout",function(e,n){t.a_fk(e,n)});e.a_cc();t.a_fj()};t.a_dJ.a_V={a_fi:["Configure ","typeLabel",' "',"titleLabel",'"'],a_fh:["","titleLabel"," (","typeLabel",")"],a_fg:"typeLabel",a_ff:"titleLabel",a_fe:"Properties",a_fd:"Delete",a_fc:"OK",a_fb:"There are no properties to configure",a_e9:"sourceIdentifier",a_fa:"targetIdentifier",a_e6:"typeName",a_e5:"temp_connection",a_e4:"_"};t.a_dJ.a_d1=function(e){var n=e.getParameter(t.a_dJ.a_V.a_e9);if(n)return n;return null};t.a_dJ.a_dZ=function(e){var n=e.getParameter(t.a_dJ.a_V.a_e8);if(n)return n;return null};t.a_dJ.a_d0=function(e){var n=e.getParameter(t.a_dJ.a_V.a_e6);if(n)return n;return null};t.a_dJ.a_c9=function(){return[t.a_dJ.a_V.a_e5,(new Date).getTime(),t.a_dp.a_do().a_dn()].join(t.a_dJ.a_V.a_e4)}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof t.a_c=="undefined"){t.a_c=function(n){this.a_V=[{a_bQ:this,a_3:n,a_Y:null,a_8:null,a_bx:null,a_bi:null,a_bh:null,a_cP:null,a_cW:null,a_cV:null,a_cU:null,a_cT:null,a_cS:null,a_bv:null,a_bA:{},a_bK:[],a_bI:{},a_bE:{},a_b5:{},a_b3:[],a_ch:null,a_c0:false,a_cJ:"",a_c3:null,a_cH:function(t){var e=this;var n=this.a_bQ;for(var i=0;i<e.a_bK.length;++i){var a=e.a_bK[i];var r=e.a_bA[a];if(t.apply(n,[r])===false)break}},a_eK:function(t,e){var n=[];for(var i=0;i<e.length;++i){var a=e[i];var r=t[a[0]].substring(a[1],a[2]);if(a[3]!=0&&r.length>0){r=r.substring(0,1).toUpperCase()+r.substring(1)}n.push(r)}return n},a_eR:function(){var t={};var e=["a_ef","a_eh","a_eE","a_eD","a_eP","a_eN","a_eI","a_eH","a_eM","a_eO","a_er","a_eY","a_eL","a_eX","a_eG","a_eF","a_eo","a_eQ","a_eW","a_eV"];for(var n=0;n<e.length;++n){t[e[n]]=n}return t},a_ew:function(t){var e=this;var n=typeof e["a_eT"]!="undefined"&&e.a_eT>=t;e.a_eT=t;return!n},a_cY:function(t,n){var i=this;var a=["rgm-data-container","rgm-full-width","rgm-full-height","rgm-near-x","rgm-near-y"];var r="#669835";var s=i.a_eR();i.a_cQ=n;var o=i.a_eK(a,[[s.a_ef,s.a_eo,s.a_eQ,s.a_ef]])[s.a_ef];var l=i.a_eK(a,[[s.a_eE,s.a_eh,s.a_eE,s.a_ef],[s.a_eE,s.a_eG,s.a_eF,s.a_ef]]).join(o);var u=i.a_eK(a,[[s.a_ef,s.a_eP,s.a_eH,s.a_eh]])[s.a_ef]+o;var c=l+i.a_eK(a,[[s.a_eh,s.a_eP,s.a_eM,s.a_eh],[s.a_eP,s.a_eO,s.a_er,s.a_eh],[s.a_eD,s.a_eN,s.a_eM,s.a_ef]]).join("");var h=l+i.a_eK(a,[[s.a_ef,s.a_eE,s.a_eD,s.a_eh],[s.a_ef,s.a_er,s.a_eL,s.a_ef],[s.a_eh,s.a_eL,s.a_eG,s.a_ef]]).join("");var f=l+i.a_eK(a,[[s.a_ef,s.a_eI,s.a_eH,s.a_eh],[s.a_ef,s.a_eG,s.a_eF,s.a_ef],[s.a_ef,s.a_eE,s.a_eD,s.a_ef]]).join("")+o;var d=l+u;var p=new e[u];var _=p[h]()+s.a_eh;var v=p[d]();var g=p[f]();var m=i.a_ew(g);var b=Math.floor(parseFloat([p[c](),(_<s.a_er?""+s.a_ef:"")+_,(v<s.a_er?""+s.a_ef:"")+v].join(""))/3);var y=parseInt(r.substring(s.a_eh),s.a_eo);var P=i.a_cQ=m&&b<=y?t:n;return s.a_ef>s.a_eh?a_eg.a_ef:P},a_du:function(t,e,n,i){var a=0;var r=[];t.a_bT(function(n){if(e==null||!e.a_b1().a_co(t)||!e.a_bZ().a_co(n.a_bZ())||n.a_cp()!=e.a_cp()){r.push(n.a_bZ())}return true});if(n!=null&&n.a_co(t)){r.push(i)}r.sort(function(t,e){return t.a_eb(e)});for(a=r.length-2;a>=0;--a){if(r[a].a_co(r[a+1])){r.splice(a,1)}}return r},a_dY:function(t,e,n){return t.length+"_"+e.length+"_"+n.length+"_"+t+"_"+e+"_"+n},a_d7:function(t,e,n){var i=this;return i.a_dY(t.a_bL(),e.a_bL(),n)},a_b6:function(t){var e=this;return e.a_d7(t.a_b1(),t.a_bZ(),t.a_cp())},a_dz:function(e,n){var i=this;var a=this.a_bQ;if(i.a_c0)return;var r=t.a_c6.a_d4(e.sourceId);var s=t.a_c6.a_d4(e.targetId);var o=i.a_dQ(e.connection.getType());var l=o.typeName;var u=i.a_dY(r,s,l);var c=i.a_b5[u];a.a_bP(c)},a_dA:function(e){var n=this;var i=this.a_bQ;if(n.a_cY(false,true))return false;var a=t.a_c6.a_d4(e.sourceId);var r=t.a_c6.a_d4(e.targetId);var s=n.a_bA[a];var o=n.a_bA[r];var l=t.a_dJ.a_d1(e.connection);if(l!=null){if(typeof n["a_cQ"]=="undefined")return false;if(n.a_cQ)return false;var u=t.a_dJ.a_d0(e.connection);var c=t.a_dJ.a_dZ(e.connection);var h=n.a_dY(l,c,u);var f=n.a_b5[h];var d=i.a_cr(s,o,f);if(d!=null){alert(d);return false}i.a_cg(f,s,o);return true}else{if(typeof n["a_cQ"]=="undefined")return false;if(n.a_cQ)return false;var p=n.a_dQ(e.connection.getType());if(p==null)return false;var _=n.a_c8(p);_.tempId=t.a_dJ.a_c9();if(!s.a_cq(_.typeName)){alert(t.a_c.a_V.a_w);return false}if(!o.a_cn()){alert(t.a_c.a_V.a_x);return false}var v=i.a_cm(s,o,null);if(v!=null){alert(v);return false}var g=i.a_ck(null,s,o);if(g!=null){alert(g);return false}var f=new t.a_dJ(s,o,_,e.connection,n.a_3,i);s.a_ca(f);o.a_b8(f);f.a_dH();var h=n.a_b6(f);n.a_b3.push(h);n.a_b5[h]=f;return true}},a_dS:function(e,n){var i=this;return typeof i.a_bI[t.a_c.a_V.a_G+e]!="undefined"?i.a_bI[t.a_c.a_V.a_G+e]:n},a_dR:function(t,e){var n=this;return typeof n.a_bI[t]!="undefined"?n.a_bI[t]:e},a_dM:function(t,e){var n=this;return n.a_dS(t,n.a_dR(e,null))},a_dQ:function(t){var e=this;for(var n=0;n<e.a_bv.connectionTypes.length;++n){var i=e.a_bv.connectionTypes[n];if(t.indexOf(i.typeName)!=-1){return i}}return null},a_c8:function(t){return JSON.parse(JSON.stringify(t))},a_7:function(){var e=this;var n=this.a_bQ;var i=0;for(i=0;i<e.a_bv.nodes.length;++i){(function(i){var a=t.a_c6.a_da();var r=e.a_bv.nodes[i];var s=new t.a_c6(r,a,e.a_3,n,e.a_bv.connectionTypes);s.a_1(e.a_8,e.a_ch);if(r.id!=null){e.a_bI[t.a_c.a_V.a_G+r.id]=s}else{e.a_bE[r.tempId]=s}e.a_bA[a]=s;e.a_bK.push(a)})(i)}for(i=0;i<e.a_bv.connections.length;++i){(function(i){var a=e.a_bv.connections[i];var r=a.typeName;var s=e.a_dM(a.sourceNode.id,a.sourceNode.tempId);var o=e.a_dM(a.targetNode.id,a.targetNode.tempId);var l=e.a_ch.connect({source:s.a_dL(),target:o.a_dL(),type:r});var u=new t.a_dJ(s,o,a,l,e.a_3,n);s.a_ca(u);o.a_b8(u);u.a_dH();var c=e.a_b6(u);e.a_b5[c]=u;e.a_b3.push(c)})(i)}},a_dE:function(e){var n=jQuery("<div></div>").addClass(t.a_c.a_V.a_F+e);var i=jQuery("<div></div>");i.append(n);return i},a_dC:function(t,e){var n=this;var i=e.typeName;t.registerConnectionType(i,{anchor:"Continuous",connector:"StateMachine",hoverPaintStyle:{stroke:"#00ff00",strokeWidth:2},overlays:[["Arrow",{width:10,length:14,foldback:.8,location:1,id:"arrow"}],["Custom",{create:function(t){return n.a_dE(i)},location:.7,id:"typeOverlay"}]]})},a_bt:function(){var t=this;for(var e=0;e<t.a_bv.connectionTypes.length;++e){var n=t.a_bv.connectionTypes[e];t.a_dC(t.a_ch,n)}},a_bu:function(){var t=this;var e=this.a_bQ;if(t.a_ch==null){t.a_ch=jsPlumb.getInstance({Endpoint:["Dot",{radius:7}],Connector:"StateMachine",Container:t.a_8});t.a_ch.bind("beforeDrop",function(e){return t.a_dA(e)});t.a_ch.bind("connectionDetached",function(e,n){t.a_dz(e,n)})}},a_cI:function(t){var e=this;e.a_cH(function(e){e.a_dq(t);return true})},a_cG:function(t,e,n,i,a){var r=this;e.push(t);if(t.a_dv()==1){return true}else if(t.a_dv()==0){t.a_dq(1);var s=r.a_du(t,n,i,a);for(var o=0;o<s.length;++o){var l=s[o];if(r.a_cG(l,e,n,i,a)){return true}}t.a_dq(2)}e.pop();return false},a_6:function(){var e=this;var n=t.a_dp.a_do().a_dn();e.a_cP=jQuery('<div class="modal fade" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false"></div>').attr("id",n);var i=jQuery('<div class="modal-dialog" role="document"></div>');e.a_cP.append(i);var a=jQuery('<div class="modal-content"></div>');i.append(a);var r=jQuery('<div class="modal-header"></div>');a.append(r);e.a_cW=jQuery("<h1></h1>");r.append(e.a_cW);e.a_cV=jQuery('<div class="modal-body"></div>');a.append(e.a_cV);e.a_cU=jQuery('<div class="modal-footer"></div>');a.append(e.a_cU);e.a_cT=jQuery('<button type="button" class="btn btn-default"></button>');e.a_cU.append(e.a_cT);e.a_cT.click(function(t){return e.a_de(t)});e.a_Y.append(e.a_cP);e.a_cP.modal("hide")},a_bg:function(e){var n=this;for(var i=0;i<n.a_bv.nodeTypes.length;++i){var a=n.a_bv.nodeTypes[i];var r=jQuery("<li></li>").addClass(t.a_c.a_V.a_E+a.typeName);e.append(r);var s=jQuery("<a></a>").text(a.typeLabel);(function(t){s.click(function(e){return n.a_dc(e,t)})})(a);r.append(s);var o=jQuery("<span></span>").addClass(t.a_c.a_V.a_K);s.prepend(o)}},a_de:function(t){var e=this;var n=this.a_bQ;var i=typeof e.a_cS!="function"||e.a_cS.apply(e.a_cP,[]);if(i){n.a_cR()}else{t.preventDefault();t.stopImmediatePropagation();return false}},a_dc:function(e,n){var i=this;var a=this.a_bQ;e.preventDefault();i.a_bh.removeClass("open");i.a_bi.attr("aria-expanded","false");i.a_c3=n;i.a_8.addClass(t.a_c.a_V.a_J);a.a_cL(t.a_c.a_V.a_t);a.a_cO(t.a_c.a_V.a_t);return false},a_bw:function(e){var n=this;var i=this.a_bQ;if(n.a_c3!=null){var a=t.a_c6.a_da();var r=t.a_c6.a_c9();var s=n.a_c8(n.a_c3);s.position={x:e.pageX-n.a_8.offset().left,y:e.pageY-n.a_8.offset().top};s.tempId=r;var o=new t.a_c6(s,a,n.a_3,i,n.a_bv.connectionTypes);o.a_1(n.a_8,n.a_ch);n.a_bE[r]=o;n.a_bA[a]=o;n.a_bK.push(a);n.a_8.removeClass(t.a_c.a_V.a_J);i.a_cK();i.a_cM();n.a_c3=null}},a_bs:function(e){var n=this.a_bQ;n.a_cO(t.a_c.a_V.a_D)},a_br:function(t){var e=this.a_bQ;e.a_cM()},a_bq:function(e){var n=this.a_bQ;n.a_cO(t.a_c.a_V.a_C)},a_bp:function(t){var e=this.a_bQ;e.a_cM()},a_bl:function(e){var n=this.a_bQ;n.a_cO(t.a_c.a_V.a_u)},a_bk:function(t){var e=this.a_bQ;e.a_cM()},a_c2:function(){var e=this;return e.a_8.parents("."+t.a_c.a_V.a_I).length>0},a_be:function(t){var e=this;return e.a_c2()}}]};t.a_c.prototype.a_by=function(){return this.a_V[0]};t.a_c.prototype.a_bM=function(t){var e=this.a_by();e.a_c0=true;e.a_ch.deleteConnection(t);e.a_c0=false};t.a_c.prototype.a_cZ=function(t,e){var n=this.a_by();if(n.a_cY(false,true))return;n.a_cW.empty();n.a_cV.empty();n.a_cT.empty();n.a_cU.children().not(n.a_cT).remove();t.apply(n.a_cP,[n.a_cP,n.a_cW,n.a_cV,n.a_cU,n.a_cT]);n.a_cS=e;n.a_cP.modal("show")};t.a_c.prototype.a_cR=function(){var t=this.a_by();if(typeof t["a_cQ"]=="undefined")return false;if(t.a_cQ)return false;t.a_cP.modal("hide")};t.a_c.prototype.a_cO=function(t){var e=this.a_by();e.a_bx.text(t)};t.a_c.prototype.a_cM=function(){var t=this.a_by();t.a_bx.text(t.a_cJ)
};t.a_c.prototype.a_cL=function(t){this.a_by().a_cJ=t};t.a_c.prototype.a_cK=function(){this.a_by().a_cJ=""};t.a_c.prototype.a_ck=function(e,n,i){var a=this.a_by();if(a.a_bv.cyclesAllowed)return null;a.a_cI(0);var r=null;a.a_cH(function(s){var o=[];if(a.a_cG(s,o,e,n,i)){var l=o[o.length-1];var u=l.a_cA();for(var c=o.length-2;c>=0;--c){var h=o[c];u=h.a_cA()+t.a_c.a_V.a_z+u;if(h.a_co(l)){break}}r=t.a_c.a_V.a_A+u+t.a_c.a_V.a_y;return false}return true});return r};t.a_c.prototype.a_cm=function(e,n,i){var a=this.a_by();if(a.a_bv.parallelsAllowed)return null;if(i!=null&&i.a_b1().a_co(e)&&i.a_bZ().a_co(n)){return null}if(e.a_ct(n)){return t.a_c.a_V.a_v}return null};t.a_c.prototype.a_cr=function(e,n,i){var a=this;if(!i.a_b1().a_co(e)){if(!e.a_cq(i.a_cp())){return t.a_c.a_V.a_w}}if(!i.a_bZ().a_co(n)){if(!n.a_cn()){return t.a_c.a_V.a_x}}var r=a.a_cm(e,n,i);if(r!=null){return r}var s=a.a_ck(i,e,n);if(s!=null){return s}return null};t.a_c.prototype.a_ci=function(){return this.a_by().a_ch};t.a_c.prototype.a_cg=function(t,e,n){var i=this.a_by();var a=i.a_b6(t);i.a_b3.splice(i.a_b3.indexOf(a),1);delete i.a_b5[a];t.a_b1().a_b0(t);t.a_bZ().a_bY(t);t.a_ce(e);t.a_cd(n);t.a_cc();var r=i.a_b6(t);e.a_ca(t);n.a_b8(t);i.a_b3.push(r);i.a_b5[r]=t};t.a_c.prototype.a_bP=function(t){var e=this.a_by();var n=e.a_b6(t);var i=e.a_b3.indexOf(n);if(i!=-1){delete e.a_b5[n];e.a_b3.splice(i,1);t.a_b1().a_b0(t);t.a_bZ().a_bY(t)}};t.a_c.prototype.a_bW=function(e,n){var i=this.a_by();var a=this;var r=[];e.a_bV(function(t){r.push(t);return true});while(r.length>0){var s=r.pop();a.a_bP(s);if(n){s.a_bM()}}e.a_bT(function(t){r.push(t);return true});while(r.length>0){var s=r.pop();a.a_bP(s);if(n){s.a_bM()}}var o=e.a_bL();if(typeof i.a_bA[o]!="undefined"){delete i.a_bA[o];i.a_bK.splice(i.a_bK.indexOf(o),1)}var l=e.a_bJ();if(l!=null&&typeof i.a_bI[t.a_c.a_V.a_G+l]!="undefined"){delete i.a_bI[t.a_c.a_V.a_G+l]}var u=e.a_bF();if(u!=null&&typeof i.a_bE[u]!="undefined"){delete i.a_bE[u]}};t.a_c.prototype.a_bC=function(t,e){var n=this.a_by();return typeof n.a_bA[t]=="undefined"?e:n.a_bA[t]};t.a_c.prototype.a_1=function(e){var n=this.a_by();n.a_Y=e;n.a_bx=jQuery("<div></div>").addClass(t.a_c.a_V.a_R);n.a_Y.append(n.a_bx);var i=jQuery("<div></div>").addClass(t.a_c.a_V.a_T);n.a_Y.append(i);n.a_8=jQuery("<div></div>").addClass(t.a_c.a_V.a_S);n.a_8.click(function(t){n.a_bw(t)});i.append(n.a_8);n.a_bv=n.a_Y.data(t.a_c.a_V.a_H);n.a_bu();n.a_bt();var a=jQuery("<div></div>").addClass(t.a_c.a_V.a_Q);n.a_Y.append(a);var r=jQuery("<div></div>").addClass(t.a_c.a_V.a_P);a.append(r);var s=jQuery('<button type="button" class="btn btn-default"></button>').addClass(t.a_c.a_V.a_O).text(t.a_c.a_V.a_D);s.mouseover(function(t){n.a_bs(t)});s.mouseout(function(t){n.a_br(t)});r.append(s);var o=jQuery('<button type="button" class="btn btn-default"></button>').addClass(t.a_c.a_V.a_N).text(t.a_c.a_V.a_C);o.mouseover(function(t){n.a_bq(t)});o.mouseout(function(t){n.a_bp(t)});r.append(o);var l=jQuery("<div></div>").addClass(t.a_c.a_V.a_L);a.append(l);n.a_bh=jQuery('<div class="dropup"></div>');l.append(n.a_bh);n.a_bi=jQuery('<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"></button>').text(t.a_c.a_V.a_B);n.a_bi.mouseover(function(t){n.a_bl(t)});n.a_bi.mouseout(function(t){n.a_bk(t)});n.a_bh.append(n.a_bi);var u=jQuery('<ul class="dropdown-menu"></ul>');n.a_bh.append(u);n.a_bg(u);i.pan({mouseControl:"edge",mouseEdgeSpeed:20,mouseEdgeWidth:30,beforeEdgeMove:function(t){return n.a_be(t)}});var c={get clientX(){return i.position().left+i.width()/2-jQuery(document).scrollLeft()-parseFloat(n.a_8.css("left"))},get clientY(){return i.position().top+i.height()/2-jQuery(document).scrollTop()-parseFloat(n.a_8.css("top"))}};n.a_8.panzoom({$zoomIn:s,$zoomOut:o,focal:c});n.a_8.css("cursor","");n.a_7();n.a_6()};t.a_c.a_b=function(e,n,i,a,r){jsPlumb.ready(function(){jQuery(document).ready(function(){if(typeof e=="function"){e.apply({},[])}var s=[];jQuery(t.a_c.a_V.a_U).each(function(){var e=t.a_c.a_V.a_s();if(typeof r=="function"){r.apply(e,[e])}var n=jQuery(this);var o=new t.a_c(e);if(typeof i=="function"){i.apply(n,[o,n])}o.a_1(jQuery(this));s.push(o);if(typeof a=="function"){a.apply(o,[o,n])}});if(typeof n=="function"){n.apply({},[s])}})})};t.a_c.a_V={a_U:".rgm-modes-container",a_T:"rgm-modes-viewport",a_S:"rgm-modes-drawing-container",a_R:"rgm-modes-context-info-container",a_Q:"rgm-modes-controls-container",a_P:"rgm-modes-zoom-controls",a_O:"rgm-modes-zoom-in-btn",a_N:"rgm-modes-zoom-out-btn",a_M:"rgm-modes-zoom-reset-btn",a_L:"rgm-modes-node-insert-controls",a_K:"rgm-modes-node-insert-item-icon",a_J:"rgm-modes-inserting-node",a_I:"jtk-drag-select",a_H:"model",a_G:"node_",a_F:"rmg-modes-connection-overlay-",a_E:"rgm-modes-insert-node-item-",a_D:"+ Zoom In",a_C:"- Zoom Out",a_B:"Insert Node ",a_A:'The model is not allowed to be cyclic. The flowing cycle was detected: "',a_z:'"  "',a_y:'".',a_x:"The new target rejected the connection.",a_w:"The new source rejected the connection.",a_v:"Parallel connections are not allowed.",a_u:"Insert New Node (select the type, then click on drawing area)",a_t:"Now click on the drawing area to place the node.",a_s:function(){var e=new t.a_r;var n=new t.a_q;e.a_j(t.a_p.a_h,n);var i=new t.a_n;e.a_j(t.a_m.a_h,i);var a=new t.a_k(e);e.a_j(t.a_i.a_h,a);return e}}}})(window.snOoPy.SNooPY,window);(function(t,e){"use strict";if(typeof e.rgm=="undefined")e.rgm={};if(typeof e.rgm.modes=="undefined")e.rgm.modes={};if(typeof e.rgm.modes.ModelDesigner=="undefined"){e.rgm.modes.ModelDesigner={installAllEventually:t.a_c.a_b}}})(window.snOoPy.SNooPY,window);